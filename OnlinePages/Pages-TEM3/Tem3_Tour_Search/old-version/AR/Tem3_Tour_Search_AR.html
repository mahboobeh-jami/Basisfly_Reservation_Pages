<basis core="tracking" name="tracking" source="Monitoring" collectionname="activity" dbname="tracking"
    addcookie="true" />
<basis core="cookie" name="trackingid" value="[##tracking.inserted.id|(0)##]" />

<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <title>جولة</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="robots" content="index, nofollow" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="" />
    <meta property="og:image" content="[##cms.cms.cdn##]/images/icon-logo.png" />
    <meta property="og:image:width" content="" />
    <meta property="og:image:height" content="" />
    <meta property="og:image:secure_url" content="[##cms.cms.cdn##]/images/icon-logo.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:alt" content="" />
    <meta name="author" content="BasisCore" />
    <!----------------CSS FILE---------------->
    <!----CSS MAIN STYLE---->
    <link href="https://cdn.basiscore.net/basisfly.com/css/reservation_tem3_style_res.css" type="text/css"
        rel="stylesheet" />
    <link href="[##cms.cms.cdn##]/css/style_tem_ar.css" type="text/css" rel="stylesheet" />

</head>

<body onload="onloadFunc();">
    <main class="main-content">
        <basis core="call" file="header-ar.inc" />
        <section class="content">
            <section class="loginRegister"></section>
            <div id="bg-popup" class="unvisible"></div>
            <div class="message-box unvisible">
                <i class="icon-message-box">
                    <svg width="50pt" height="50pt" fill="#666" version="1.0" viewBox="0 0 512 512"
                        xmlns="http://www.w3.org/2000/svg">
                        <g transform="translate(0 512) scale(.1 -.1)">
                            <path
                                d="m1958 5059c-518-43-1e3 -273-1362-649-741-772-795-1960-128-2804 30-39 105-121 166-181 338-337 774-546 1256-605 123-15 398-12 519 5 57 8 105 14 106 12 2-1 15-27 30-57 118-235 344-454 600-582 403-202 889-190 1280 32 141 81 174 132 120 185-32 33-60 31-115-6-25-16-83-50-130-73-388-197-846-171-1215 68-119 77-291 251-363 369-303 490-231 1110 175 1512 101 100 186 160 318 225 404 200 875 163 1242-96 87-62 225-200 286-285 222-314 284-722 166-1089-41-126-140-303-219-394-42-47-51-76-35-114 15-34 48-48 89-38 37 9 162 179 229 313 154 304 186 664 92 999-35 120-140 330-219 435-129 171-323 329-509 415l-85 39 5 170c16 517-142 993-465 1403-92 116-135 155-173 155-21 0-38-7-51-22-34-43-24-72 58-167 144-168 276-388 353-588 88-230 124-429 125-693 1-105-2-194-6-198s-44 0-90 9c-46 8-115 18-154 22l-71 6-6 187c-4 135-11 213-27 286-144 676-673 1185-1350 1302-64 11-153 17-270 17s-206-6-270-17c-683-118-1209-630-1352-1315-30-146-33-456-4-607 25-137 63-256 88-277 28-25 70-22 96 5 28 30 28 48-2 151-71 243-75 531-11 782 195 770 974 1261 1749 1103 144-29 233-60 381-134 414-206 703-586 801-1055 13-62 18-132 19-259v-175l-100-17c-410-73-756-315-963-674-90-157-156-367-169-537-3-47-9-91-12-97-3-5-61-15-129-21-334-31-681 63-976 263-127 85-303 264-396 402-71 104-77 110-112 113-27 2-43-3-57-17-36-36-27-71 48-183 342-509 932-786 1547-725l82 8 7-53c3-29 18-100 31-156 14-57 24-105 22-107-11-11-183-25-311-25-167 0-269 10-422 42-354 72-712 266-975 528-704 700-787 1795-197 2587 568 762 1591 1015 2445 603 119-57 248-136 341-206 26-20 55-34 72-34 39 0 69 32 69 74 0 41-31 71-171 163-307 201-630 311-1004 343-134 11-195 11-337-1z" />
                            <path
                                d="m2080 4260c-17-17-20-33-20-105s3-88 20-105c25-25 71-26 99-2 41 33 41 172 0 213-25 25-74 24-99-1z" />
                            <path
                                d="m1186 3889c-44-35-36-73 31-141 47-47 63-58 90-58 42 0 73 30 73 72 0 25-12 43-58 90-65 64-92 72-136 37z" />
                            <path
                                d="m2938 3852c-46-47-58-65-58-90 0-43 31-72 76-72 29 0 44 9 90 54 63 63 72 106 31 144-40 38-73 29-139-36z" />
                            <path
                                d="m2082 3670c-22-20-22-26-22-300 0-154-4-280-8-280s-37 30-72 66c-36 36-76 70-89 75-46 18-101-24-101-78 0-22 275-298 311-314 40-16 84 3 98 43 15 43 15 714 0 757-19 53-77 68-117 31z" />
                            <path
                                d="m810 2990c-30-30-27-83 6-109 22-17 41-21 101-21 65 0 77 3 98 25 30 30 32 64 4 99-19 24-26 26-105 26-71 0-87-3-104-20z" />
                            <path
                                d="m3245 2985c-14-13-25-36-25-50s11-37 25-50c21-22 33-25 94-25 39 0 81 5 95 11 49 23 53 104 7 128-11 6-54 11-96 11-67 0-79-3-100-25z" />
                            <path
                                d="m3653 2359c-48-23-89-67-110-116-10-26-13-136-13-533 0-490 0-501 21-546 35-73 118-124 204-124 81 0 157 47 198 124 22 40 22 48 25 516 2 324 0 491-8 526-13 63-67 129-124 155-56 26-140 25-193-2zm153-150c18-20 19-43 19-501v-480l-24-19c-31-25-69-24-98 3l-23 21v479c0 465 1 479 20 498 27 27 81 26 106-1z" />
                            <path
                                d="m1265 2172c-16-11-47-38-67-60-58-64-50-125 20-147 29-8 80 22 127 78 42 49 46 87 10 122-29 30-50 31-90 7z" />
                            <path
                                d="m2140 1813c-43-16-50-34-50-123 0-78 2-89 23-108 44-41 107-19 123 43 12 48-1 144-22 164-22 22-53 32-74 24z" />
                            <path
                                d="m3653 979c-91-45-123-109-123-249 0-115 20-174 74-215 123-94 281-63 347 68 27 51 36 175 20 245-15 62-69 128-125 153-56 26-140 25-193-2zm153-150c15-17 19-36 19-101 0-72-2-82-24-99-31-25-69-24-98 3-20 19-23 31-23 100 0 65 3 81 20 98 27 27 81 26 106-1z" />
                        </g>
                    </svg>
                </i>
                <div class="line-one font_20 font-weight">
                    لقد انتهت صلاحية بحثك
                </div>
                <div class="line-two">
                    يرجى إعادة تحميل الصفحة للحصول على أحدث الأسعار
                </div>
                <button class="background-color_2 color_white font_16 border-radius cursor-pointer"
                    onClick="window.location='[##cms.Host.AR_redirect|(/)##]'">الصفحة الرئيسية</button>
                <button class="background-color_1 color_white font_16 border-radius cursor-pointer"
                    onclick=" location.reload()">إعادة البحث</button>
            </div>
            <section class="searched-container dir-rtl">
                <div class="bc-main">
                    <div class=" float-right text-right">
                        <div class="flight-summary-info">
                            <div class="item font_16">
                                <span class="departure"><span class="title">جولة :
                                    </span>[##cms.form.tour-search-text##]</span>
                            </div>
                            <div class="item font_15">
                                <span class="dash"><i class="far fa-calendar-check"></i></span>
                                <span class="title">تاريخ المغادرة : </span><span>[##cms.form.fdate##]</span>
                                <span class="dash"></span>
                                <span class="title">تاريخ العودة : </span><span>[##cms.form.tdate##]</span>
                            </div>
                            <div class="item font_13 cursor-pointer color_white background-color_1 border-radius btn"
                                onclick="show_research(this,'4')">
                                <i class="fa fa-search"></i> تعديل البحث
                            </div>
                            <div class="clr"></div>
                        </div>
                    </div>
                    <div class="width_15 float-left font_13 next-prev-container text-left">
                        <span class="before-btn cursor-pointer background-color_white"><i
                                class="fa fa-angle-right color_1"></i>الیوم السابق</span>
                        <span class="after-btn cursor-pointer background-color_white">اليوم التالي<i class="fa fa-angle-left color_1"></i></span>
                        <form method="post" action="/Tem3_Tour_Search_AR.bc" class="form_research_date"><input type="hidden" value="[##cms.form.persiancurrent##]" class="persiancurrent" name="persiancurrent"> <input type="hidden" value="[##cms.form.tourname##]" name="tourname"> <input type="hidden" value="[##cms.form.tour-search-text##]" name="tour-search-text"> <input type="hidden" value="[##cms.form.fdate##]" name="fdate" class="departuredate"> <input type="hidden" value="[##cms.form.tdate##]" name="tdate" class="returndate"> <input type="hidden" value="[##cms.form.mstring_fdate##]" name="mstring_fdate" class="departureMdate"> <input type="hidden" value="[##cms.form.mstring_tdate##]" name="mstring_tdate" class="returnMdate"> <input type="hidden" value='[##cms.json.header|cms.form.roomSearch##]' name="roomSearch"> <input type="hidden" value="[##cms.form.data_type_tour##]" name="data_type_tour"> <input type="hidden" value="[##cms.form.data_type##]" name="data_type"></form>
                    </div>
                    <div class="clr"></div>
                    <div class="searched-items-container unvisible" data-load="0"
                        data-roomSearch='[##cms.json.header | cms.form.roomSearch##]'
                        data-from="[##cms.form.tour-search-text##]" data-tourname="[##cms.form.tourname##]"
                        data-typetour="[##cms.form.data_type_tour##]" data-datatype="[##cms.form.data_type##]"
                        data-fdate="[##cms.form.fdate##]" data-tdate="[##cms.form.tdate##]"
                        data-persiancurrent="[##cms.form.persiancurrent##]">
                        <div class="text-center">
                            <div class="lds-ring">
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="clr"></div>

            </section>
            <section class="result-search-container">
                <div class="bc-main">
                    <div class="waiting-search hotel_stracture dir-rtl">
                        <div class="loading-container">
                            <div class="loading"></div>
                            <div class="loading-img"><img  src="[##cms.Host.loading-logo|(/images/logo.png)##]" width="" height=""
                                    alt="logo" /></div>
                        </div>
                        <p class="loading-text">البحث عن أفضل الجولات ...</p>
                        <div class="waiting-content width_30 float-right">
                            <div class="stract-filters float-right width_95 ">
                                <div class="stract-filter stract-effect">
                                    <div class="stract-filter-head"></div>
                                    <div class="stract-filter-row">
                                        <div class="stract-filter-item"></div>
                                        <div class="stract-filter-item"></div>
                                    </div>
                                    <div class="clr"></div>
                                </div>
                                <div class="stract-filter stract-effect">
                                    <div class="stract-filter-head"></div>
                                    <div class="stract-filter-row">
                                        <div class="stract-filter-item"></div>
                                        <div class="stract-filter-item"></div>
                                    </div>
                                    <div class="clr"></div>
                                </div>
                                <div class="stract-filter stract-effect">
                                    <div class="stract-filter-head"></div>
                                    <div class="stract-filter-row">
                                        <div class="stract-filter-item"></div>
                                        <div class="stract-filter-item"></div>
                                    </div>
                                    <div class="clr"></div>
                                </div>
                            </div>
                        </div>
                        <div class="waiting-content width_70 float-left ">
                            <div class="stract-result-items stract-tour">
                                <div class="stract-result-item stract-effect">
                                    <div class="stract-tour-header"></div>
                                    <div class="stract-hotel-part  d-flex hotel">
                                        <div class="stract-img-item p-relative"></div>
                                        <div class="stract-infoes-item">
                                            <div class="stract-info-title"></div>
                                            <div class="stract-brief-info"></div>
                                            <div class="stract-details-tbl"></div>
                                        </div>
                                    </div>
                                    <div class="stract-flight-part">
                                        <div class="d-flex p-relative">
                                            <div class="stract-img-item float-right"></div>
                                            <div class="stract-infoes-item width_100">
                                                <div class="stract-info-item float-right"></div>
                                                <div class="stract-duration-item width_70 p-relative float-right">
                                                    <div class="stract-duration-line p-relative no-stop"></div>
                                                </div>
                                                <div class="stract-info-item float-left"></div>
                                            </div>
                                        </div>
                                        <div class="d-flex p-relative">
                                            <div class="stract-img-item float-right"></div>
                                            <div class="stract-infoes-item width_100">
                                                <div class="stract-info-item float-right"></div>
                                                <div class="stract-duration-item width_70 p-relative float-right">
                                                    <div class="stract-duration-line p-relative no-stop"></div>
                                                </div>
                                                <div class="stract-info-item float-left"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="stract-row-cost">
                                        <div class="stract-btn-item"></div>
                                        <div class="stract-col-cost"></div>
                                        <div class="clr"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="clr"></div>
                    </div>
                    <div id="app" class="unvisible"></div>
                    <div class="clr"></div>
                </div>
            </section>
        </section>
        <!----------------JS FILE---------------->
        <script src="[##cms.cms.cdn##]/_js/jquery/jquery-3.6.3.min.js" type="text/javascript"></script>
        <basis core="call" file="footer-ar.inc" />
    </main>
    <script
        type="text/javascript">$(document).ready(function () { fetch('/Client_Tour_Json.bc', { method: 'POST', body: 'data_type=[##cms.form.data_type##]&data_type_tour=[##cms.form.data_type_tour##]&tourname=[##cms.form.tourname##]&fdate=[##cms.form.fdate##]&tdate=[##cms.form.tdate##]&rooms=[##cms.json.header|cms.form.roomSearch##]&clid=3' }).then(response => response.text()).then(text => { let Maindata = JSON.parse(text.replace(/\'/g, '"')); $('.waiting-search').hide(); $('#app').show(); load_data(Maindata); }).catch(error => console.error(error)) })</script>
    <script defer src="https://cdn.basiscore.net/basisfly.com/js/reservation_react.production.min.js"></script>
    <script defer src="https://cdn.basiscore.net/basisfly.com/js/reservation_react_dom.production.min.js"></script>
    <script defer src="https://cdn.basiscore.net/basisfly.com/js/reservation_babel.min.js"></script>
    <script defer src="https://cdn.basiscore.net/basisfly.com/js/reservation_react_paging.js"></script>
    <script defer src="https://cdn.basiscore.net/basisfly.com/js/reservation_tem3_commonJs_ar.js"
        type="text/javascript"></script>
    <script defer src="https://cdn.basiscore.net/basisfly.com/js/reservation_owl_carousel_.js"
        type="text/javascript"></script>
    <script type="text/babel">
        function load_data(load_data) {
            class App extends React.Component {
                constructor(props) {
                    super(props);
                    this.state = {
                        data: [],
                        data_currency: [],
                        library: null,
                        perPage: 20,
                        currentPage: 1,
                        currentPage2: 2,
                        currentPage3: 3,
                        maxPage: null,
                        filterName: "",
                        filterFlightNumber: "",
                        visibleAll: {},
                        visibleDetails: {},
                        visibleBar: {},
                        visibleRule: {},
                        barDepTxt: {},
                        ruleDepTxt: {},
                        visibleTourInfo: {},
                        visibleCostTable: {},
                        roomids: {},
                        chkbox: true,
                        jsonbackup: {},
                        cityindex: "",
                        roomindex: "",
                        roomcheck: "",
                        chflag: 0,
                        copy: {},
                        costtableinfo: [],
                        Visible_rooms: {},
                        activeTab_details: {},
                        activeTab_bar: {},
                        activeTab_rule: {},
                        state_airlines: "",
                        state_stops: "",
                        state_classNames: "",
                        state_service: "",
                        state_stars: "",
                        state_availability: "",
                        data_valid_tours: [],
                        state_currency_unit: "",
                        state_currency_cost: 1,
                        state_floatdigit: ""
                    }
                    this.airlines = [];
                    this.stops = [];
                    this.stars = [];
                    this.service = [];
                    this.availability = [];
                    this.classNames = []
                    this.handleClick = this.handleClick.bind(this);
                    this.handleReset = this.handleReset.bind(this);

                }
                componentDidMount() {
                    this.setState(state => ({
                        ...state,
                        data: load_data
                    }), () => {
                        this.reorganiseLibrary()
                    })

                    fetch('/Client_Valid_Tours_Json.bc', {
                        method: 'POST',
                        body: 'tourname=[##cms.form.tourname##]&fdate=[##cms.form.fdate##]&tdate=[##cms.form.tdate##]&rooms=[##cms.json.header|cms.form.roomSearch##]&clid=3'
                    }).then(response => response.text())
                        .then(text => {
                            let Maindata = JSON.parse(text.replace(/\'/g, '"'))
                            this.setState({ data_valid_tours: Maindata })
                        }).catch(error => console.error(error))


                    this.setState(state => ({
                        ...state,
                        data: load_data
                    }), () => {
                        this.reorganiseLibrary()
                    })
                    $(document).on('update_result', (event, service, stars, availability, airlines, stops) => {
                        this.reorganiseLibrary(service, stars, availability, airlines, stops)
                    })
                    let getCurrencyObject = localStorage.getItem('currencyObject');
                    let jsonCurrency = JSON.parse(getCurrencyObject);
                    if (jsonCurrency) {
                        if (jsonCurrency.currency_unit !== "IRR") {
                            if (jsonCurrency.floatdigit < 0) {
                                this.setState({
                                    state_floatdigit: 2,
                                })
                            } else {
                                this.setState({
                                    state_floatdigit: jsonCurrency.floatdigit,
                                })
                            }
                        } else {
                            this.setState({
                                state_floatdigit: jsonCurrency.floatdigit,

                            })
                        }
                        this.setState({
                            state_currency_unit: jsonCurrency.currency_unit,
                            state_currency_cost: jsonCurrency.currency_cost,
                        })
                    }
                }
                componentDidUpdate() {
                    if (document.getElementsByClassName("search-item")[0]) {
                        document.querySelector(".tour-name-details").value = document.getElementsByClassName("search-item")[0].querySelector(".tour-name").innerText;
                        document.querySelector(".fdate-details").value = document.getElementsByClassName("search-item")[0].querySelector(".fdate").value;
                        document.querySelector(".tdate-details").value = document.getElementsByClassName("search-item")[0].querySelector(".tdate").value;
                        var name_airline = "";
                        for (var i = 0; i < document.getElementsByClassName("name_airline").length; i++) {
                            name_airline = name_airline + document.getElementsByClassName("name_airline")[i].innerText + ' '
                        };
                        document.querySelector(".airline-details").value = name_airline;
                    }

                    $(".result-item").each(function () {
                        let basiscoreid = $(this).find(".basiscoreid").val()
                        var check_loaded = $(this).attr("date-load-info");
                        var self = $(this)
                        if ($(this).find(".basiscoreid").val()) {
                            if ($(this).find(".basiscoreid").val() == $(this).closest(".result-item").siblings().find(".basiscoreid").val()) {
                                if (check_loaded == 0) {
                                    $.get("/Tem1_Tour_Info_AR.bc?id=" + basiscoreid + "", function (data, status) {
                                        self.find(".load_info_tour").empty().append(data)
                                        self.closest(".result-item").siblings().find(".load_info_tour").empty().append(data)

                                    });
                                    $(this).attr("date-load-info", "1")
                                    $(this).siblings().attr("date-load-info", "1")
                                }
                            } else {
                                $.get("/Tem1_Tour_Info_AR.bc?id=" + basiscoreid + "", function (data, status) {
                                    self.find(".load_info_tour").empty().append(data)
                                });

                            }
                        }
                    })
                    $(".valid-tours-container").owlCarousel({ autoPlay: 4000, items: 4, loop: true, itemsDesktop: [1199, 3], itemsDesktopSmall: [979, 2], itemsTablet: [768, 2], itemsTablet: [602, 1], itemsMobile: [479, 1], navigation: true, navigationText: ['<span class="fa fa-angle-left"></span>', '<span class="fa fa-angle-right"></span>'] });
                    if (document.querySelector(".currency-content")) {
                        const fieldTemp = document.querySelector(".currency-content-list");
                        document.querySelector(".currency-content").innerHTML = '';
                        document.querySelector(".currency-content").appendChild(fieldTemp);
                        document.querySelector(".currency-content-list").classList.add('currency-appended');
                        document.querySelector(".currency-appended").classList.remove('unvisible');
                    }
                }
                reorganiseLibrary = (service, stars, availability, airlines, stops) => {
                    const { filterFlightNumber, filterName, perPage, data } = this.state
                    let library = data
                    if (filterName !== "") {
                        library = library.filter(item =>
                            this.renderFilter_search(item, 'hotel_name').toString().toLowerCase().includes(filterName)
                        )
                        let lenLibrary = library.length
                        $('.result-count').text(lenLibrary)
                    }
                    if (stars !== undefined) {
                        if (stars !== "") {
                            stars = stars.split(",");
                            library = library.filter(item => {
                                if (this.renderFilter_search(item.hotelinfo, 'star').some(r => stars.includes(r))) return item;

                            })
                        }
                        let lenLibrary = library.length
                        $('.result-count').text(lenLibrary)
                    }
                    if (service !== undefined) {
                        if (service !== "") {
                            service = service.split(",");
                            library = library.filter(item => {
                                if (this.renderFilter_search(item.hotelinfo, 'sevice').some(r => service.includes(r))) return item;

                            })
                        }
                        let lenLibrary = library.length
                        $('.result-count').text(lenLibrary)
                    }

                    if (availability !== undefined) {
                        if (availability !== "") {
                            availability = availability.split(",");
                            library = library.filter(item => {
                                if (this.renderFilter_search(item.hotelinfo, 'availability').some(r => availability.includes(r))) return item;

                            })
                        }


                        let lenLibrary = library.length
                        $('.result-count').text(lenLibrary)

                    }
                    if (airlines !== undefined) {
                        if (airlines !== "") {
                            airlines = airlines.split(",");
                            library = library.filter(item => {
                                if (this.renderFilter_search(item, 'airlines').some(r => airlines.includes(r))) return item;


                            })
                        }
                        let lenLibrary = library.length
                        $('.result-count').text(lenLibrary)
                    }

                    if (stops !== undefined) {
                        if (stops !== "") {
                            stops = stops.split(",");
                            library = library.filter(item => {
                                if (this.renderFilter_search(item, 'stops').some(r => stops.includes(r))) return item;

                            })
                        }
                        let lenLibrary = library.length
                        $('.result-count').text(lenLibrary)
                    }
                    if (filterFlightNumber !== "") {
                        library = library.filter(item => {
                            if (this.renderFilter_search(item, 'flight_number').some(r => r.toLowerCase().includes(filterFlightNumber))) return item;
                        }
                        )
                        let lenLibrary = library.length
                        $('.result-count').text(lenLibrary)
                    }
                    let lenLibrary = library.length
                    if (lenLibrary == undefined) {
                        $('.result-count').text(0)
                    } else {
                        $('.result-count').text(lenLibrary)
                    }
                    library = _.chunk(library, perPage)
                    this.setState({
                        library,
                        currentPage: 1,
                        maxPage: library.length === 0 ? 1 : library.length
                    })
                }

                renderFilter_search(element, type) {
                    if (type == 'hotel_name') {
                        let lenhotelinfo = element.hotelinfo.length
                        for (let i = 0; i < lenhotelinfo; i++) {
                            for (let i = 0; i < lenhotelinfo; i++) {
                                let lenhotel = element.hotelinfo[i].hotel.length
                                let indents = []
                                for (let j = 0; j < lenhotel; j++) {
                                    if (element.hotelinfo[i].hotel[j].hotelinfo !== undefined) {
                                        indents.push(element.hotelinfo[i].hotel[j].hotelinfo.name)
                                    }
                                }
                                return (
                                    indents
                                )
                            }
                        }
                    } else if (type == 'star') {
                        let elementAdd = []
                        for (let i = 0; i < element.length; i++) {
                            for (let j = 0; j < element[i].hotel.length; j++) {
                                elementAdd.push(element[i].hotel[j].hotelinfo.hotelsearch.star.toString())
                            }

                        }
                        return elementAdd
                    } else if (type == 'sevice') {
                        let elementAdd = []
                        for (let i = 0; i < element.length; i++) {
                            for (let j = 0; j < element[i].hotel.length; j++) {
                                elementAdd.push(element[i].hotel[j].hotelinfo.hotelsearch.services)
                            }

                        }
                        return elementAdd
                    } else if (type == 'availability') {
                        let elementAdd = []
                        for (let i = 0; i < element.length; i++) {
                            for (let j = 0; j < element[i].hotel.length; j++) {
                                for (let y = 0; y < element[i].hotel[j].families.length; y++) {
                                    for (let z = 0; z < element[i].hotel[j].families[y].availablerooms.length; z++) {
                                        elementAdd.push(element[i].hotel[j].families[y].availablerooms[z].info.availability)
                                    }
                                }

                            }

                        }
                        return elementAdd
                    }
                    else if (type == 'classNames') {
                        let elementAdd = []
                        for (let i = 0; i < element.backtobackinfo.mainflights.length; i++) {
                            elementAdd.push(element.backtobackinfo.mainflights[i].classname)
                        }
                        for (let i = 0; i < element.onewayflights.length; i++) {
                            elementAdd.push(element.onewayflights[i].classname)
                        }
                        return elementAdd
                    }
                    else if (type == 'stops') {
                        let elementAdd = []
                        for (let i = 0; i < element.backtobackinfo.mainflights.length; i++) {
                            elementAdd.push(element.backtobackinfo.mainflights[i].ticketinfooo.stoppinfoo.showstopinfo)
                        }
                        for (let i = 0; i < element.onewayflights.length; i++) {
                            elementAdd.push(element.onewayflights[i].ticketinfooo.stoppinfoo.showstopinfo)
                        }
                        return elementAdd
                    }
                    else if (type == 'flight_number') {
                        let elementAdd = []
                        for (let i = 0; i < element.backtobackinfo.mainflights.length; i++) {
                            for (let j = 0; j < element.backtobackinfo.mainflights[i].routeshow.routesinfoo.length; j++) {
                                elementAdd.push(element.backtobackinfo.mainflights[i].routeshow.routesinfoo[j].routesinfoodetails.otherdetails.detailsroutecode.toLowerCase())
                            }
                        }
                        for (let i = 0; i < element.onewayflights.length; i++) {
                            for (let j = 0; j < element.onewayflights[i].routeshow.routesinfoo.length; j++) {
                                elementAdd.push(element.onewayflights[i].routeshow.routesinfoo[j].routesinfoodetails.otherdetails.detailsroutecode.toLowerCase())
                            }

                        }

                        return elementAdd
                    }

                    else if (type == 'airlines') {
                        let elementAdd = []
                        for (let i = 0; i < element.backtobackinfo.mainflights.length; i++) {

                            for (let j = 0; j < element.backtobackinfo.mainflights[i].routeshow.routesinfoo.length; j++) {
                                elementAdd.push(element.backtobackinfo.mainflights[i].routeshow.routesinfoo[j].routesinfoodetails.otherdetails.detailsairline)
                            }

                        }
                        for (let i = 0; i < element.onewayflights.length; i++) {
                            for (let j = 0; j < element.onewayflights[i].routeshow.routesinfoo.length; j++) {
                                elementAdd.push(element.onewayflights[i].routeshow.routesinfoo[j].routesinfoodetails.otherdetails.detailsairline)
                            }

                        }
                        return elementAdd

                    }
                }

                // Previous Page
                previousPage = event => {
                    this.handleReset(event);
                    this.handleClick(event);
                    this.setState({
                        currentPage: this.state.currentPage - 1,
                        currentPage2: this.state.currentPage2 - 1,
                        currentPage3: this.state.currentPage3 - 1
                    })
                }
                // Next Page 
                nextPage = event => {
                    this.handleReset(event);
                    this.handleClick(event);
                    this.setState({
                        currentPage: this.state.currentPage + 1,
                        currentPage2: this.state.currentPage2 + 1,
                        currentPage3: this.state.currentPage3 + 1
                    })
                }

                // Next Page3
                nextPage3 = event => {
                    this.handleReset(event);
                    this.handleClick(event);
                    this.setState({
                        currentPage: this.state.currentPage3,
                        currentPage2: this.state.currentPage3 + 1,
                        currentPage3: this.state.currentPage3 + 2
                    })
                }

                // handle filter
                handleFilterName = event => {
                    this.handleReset(event);
                    const { state_service, state_stars, state_availability, state_airlines, state_classNames, state_stops } = this.state;
                    this.setState(
                        {
                            filterName: event.target.value.toLowerCase()
                        },
                        () => {
                            this.reorganiseLibrary(state_service, state_stars, state_availability, state_airlines, state_classNames, state_stops);
                        }
                    )
                }
                // handle filter flight number
                handleFilterFlightNumber = (event) => {
                    this.handleReset(event);
                    const { state_service, state_stars, state_availability, state_airlines, state_classNames, state_stops } = this.state;
                    this.setState(
                        {
                            filterFlightNumber: event.target.value.toLowerCase()
                        },
                        () => {
                            this.reorganiseLibrary(state_service, state_stars, state_availability, state_airlines, state_classNames, state_stops);
                        }
                    )


                }
                // handle per page
                handlePerPage = (evt) =>
                    this.setState({
                        perPage: evt.target.value
                    }, () => this.reorganiseLibrary())

                // handle render of library
                renderLibrary = () => {
                    const { library, currentPage } = this.state
                    if (!library || (library && library.length === 0)) {
                        return <div className="message-box-nodata dir-ltr">
                            <i className="icon-message-box">
                                <svg width="50pt" height="50pt" fill="#666" version="1.0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                                    <g transform="translate(0 512) scale(.1 -.1)">
                                        <path d="m593 5102c-100-35-171-115-193-216-8-36-10-508-8-1626l3-1575 21-46c28-60 87-119 150-150 47-23 59-24 306-29l257-5-459-430c-252-236-470-448-485-470-62-96-71-231-22-338 92-201 346-279 521-159 33 23 269 267 611 632 306 327 562 599 569 604 9 6 23 2 43-12 96-68 313-155 464-186 454-93 972 35 1285 317l51 46 1058 6 57 28c69 34 121 91 148 164 20 53 20 76 20 1633s0 1580-20 1633c-27 73-79 130-148 164l-57 28-2060 2c-1957 2-2063 2-2112-15zm4142-194c48-22 55-52 55-228v-160h-835c-908 0-877 2-903-55-15-33-15-57 0-90 26-57-5-55 903-55h835v-1296-1296l-68-68h-416-415l56 83c102 149 181 339 220 533 27 134 24 423-5 560-64 299-201 559-406 772-214 222-458 359-759 424-87 19-133 22-307 22s-220-3-307-22c-294-64-523-190-738-406-223-224-359-476-427-790-18-84-22-133-22-291 0-206 14-299 70-462 28-82 110-256 144-303 11-16 20-32 20-37s-20-25-44-46l-45-37h-341-342l-68 68v1296 1296h835c625 0 841 3 860 12 29 13 55 55 55 88s-26 75-55 88c-19 9-235 12-860 12h-835v166 166l68 68h2026c1549 0 2031-3 2051-12zm-1788-1077c282-58 509-182 693-378 454-486 454-1300-1-1787-211-226-500-362-845-396-645-65-1252 396-1381 1047-21 109-24 355-4 463 88 493 456 901 931 1032 190 53 410 59 607 19zm-1304-2478-66-74-168 166 146 134 154-152-66-74zm-293-138 84-85-50-52c-28-29-220-234-428-455-403-431-407-434-488-419-106 20-169 137-123 226 13 26 901 870 915 870 3 0 43-38 90-85z" />
                                        <path d="m2644 4509c-25-13-54-60-54-89 0-51 49-100 100-100s100 49 100 99c0 73-80 122-146 90z" />
                                        <path d="m2305 3320c-11-4-101-90-200-189-236-237-234-207-27-414l152-152-140-140c-146-146-176-188-165-233 8-34 338-369 381-388 17-7 42-10 55-7s93 73 177 157l152 151 153-151c83-84 163-154 176-157s35-1 50 4c40 15 379 358 386 391 10 46-19 87-165 233l-140 140 152 152c207 208 210 176-32 418-115 115-194 186-210 190-47 10-83-14-228-158l-142-141-143 141c-169 168-185 178-242 153zm185-384c147-147 174-165 228-151 16 4 85 64 175 153l147 146 87-87 88-87-153-153c-133-135-152-157-152-186 0-18 5-42 11-54s75-86 152-165l142-142-175-175-153 153c-151 149-154 152-197 152s-46-3-197-152l-153-153-174 174 152 155c149 150 152 155 152 197s-3 46-152 196l-152 153 84 85c47 47 87 85 89 85 3 0 71-65 151-144z" />
                                    </g>
                                </svg> </i>
                            <div className="line-one font_20 font-weight text-right">
                                لا يوجد نتائج لبحثك
                            </div>
                            <div className="line-two text-right">
                                للحصول علي النتيجة, يرجي تغيير التاريخ أو الوجه
                            </div>
                            <a href="[##cms.Host.AR_redirect|(/)##]" className="background-color_1 color_white font_16 border-radius cursor-pointer">الصفحة الرئيسية</a>
                        </div>

                    }
                    return library[currentPage - 1].map((item) => (
                        <div className="search-item result-item dir-rtl" date-load-info="0" key={item.index}>
                            <form action="/Client_Show_Tour_Ar_ver.2.bc" method="post">
                                <input type="hidden" value={this.state.state_currency_unit} name="rate-unit" className="rate-unit" />
                                <input type="hidden" value={this.state.state_currency_cost} name="rate-cost" className="rate-cost" />
                                <input type="hidden" value={this.state.state_floatdigit} name="rate-floatdigit" className="rate-floatdigit" />
                                <input type="hidden" value="[##cms.form.tourname##]" name="tourname" />
                                <input type="hidden" value="[##cms.form.tour-search-text##]" name="tour-search-text" />
                                <input type="hidden" value='[##cms.json.header|cms.form.roomSearch##]' name="roomSearch" />
                                <input type="hidden" value="[##cms.form.data_type_tour##]" name="data_type_tour" />
                                <input type="hidden" value="[##cms.form.data_type##]" name="data_type" />
                                <input type="hidden" value="Tem3" name="checkpreurl" />
                                <input type="hidden" value={item.id} name="id" />
                                <input type="hidden" value={item.supplier} name="supplier" />
                                <input type="hidden" value={item.dateinfo.begindate.sstring} name="fdate" className="fdate" />
                                <input type="hidden" value={item.dateinfo.enddate.sstring} name="tdate" className="tdate" />
                                <input type="hidden" value={this.renderTotal(item)} name="amount" />
                                {this.renderproviderId(item.id)}
                                {this.renderprovider(item)}
                                {this.renderNeardate(item)}
                                {this.renderhotelgroupid(item)}
                                <div className="tour-header background-color_1 color_white border-radius font_13">
                                    <span>جولة:</span>
                                    <span className="tour-name">{item.name}</span>
                                    <span>تاریخ :</span>
                                    <span className="font_12 EnNum">{item.dateinfo.begindate.mstring}</span>
                                    <span>الی</span>
                                    <span className="font_12 EnNum">{item.dateinfo.enddate.mstring}</span>
                                    {this.renderTime(item)}
                                </div>
                                {this.renderhotelinfo_wrapper(item)}
                                {this.renderbacktobackinfo(item.backtobackinfo, item.index)}
                                {this.renderonewayflights(item, item.index)}


                                <div className="row-cost">
                                    <div className="links-content width_50 float-right text-right">

                                        <span className="details-btn font_12 color_2 text-center cursor-pointer" onClick={(e) => this.showCostTable(item.index)}> جدول الأسعار
                                            </span>
                                        <span className="details-btn font_12 color_2 text-center cursor-pointer" onClick={(e) => this.showTourInfo(item.index)}>خدمات الجولة
                                        </span></div>
                                    <div className="width_50 float-left  text-left">
                                        <div className="col-cost">
                                            <span className="color_gray font_11">السعر :</span><span
                                                className="item-cost color_5 font_20 font-weight">{this.renderTotal_first(item)}</span><span
                                                    className="color_gray font_11 unit">{this.renderUnit(item.unit, this.state.state_currency_unit)}</span></div>

                                        <div className="btn-item">
                                            <button type="submit"
                                                className="color_white border-radius font_15 cursor-pointer">شراء جولة</button>
                                        </div>
                                    </div>

                                    <div className="clr"></div>
                                    <div className="d-row bottom-content">
                                        {this.renderCommission(item)}
                                    </div>
                                    <div className="clr"></div>
                                </div>
                                <div className={`details-row-content p-relative ${!this.state.visibleCostTable[item.index] ? "unvisible" : "visible"}`}>
                                    <div className="close-btn border-radius float-left text-center cursor-pointer color_white font_20" onClick={(e) => this.closeCosttable(item.index)}><i className="fa fa-times"></i></div>
                                    <div className="clr"></div>
                                    {this.rendercosttable(item)}
                                </div>
                                <div className={`details-row-content p-relative ${!this.state.visibleTourInfo[item.index] ? "unvisible" : "visible"}`}>
                                    <div className="close-btn border-radius float-left text-center cursor-pointer color_white font_20" onClick={(e) => this.closeServices(item.index)}><i className="fa fa-times"></i></div>
                                    <div className="clr"></div>
                                    {this.renderserviceTour(item.services)}
                                </div>
                                <div className="insurance-visa-container">
                                    {this.renderInsurance(item)}
                                    {this.rendervisa(item)}
                                    <div className="clr"></div>
                                </div>
                                <div className="clr"></div>
                            </form>
                        </div>
                    ))
                }
                render() {
                    const { library, currentPage, perPage, maxPage } = this.state
                    return (<div className="list-container">
                        <div className="currency-content-list unvisible">
                            <div className="currency-selected cursor-pointer" data-active="0" onClick={() => this.currency_selected_list()}><span>{this.localStorage_getCurrency()}{this.localStorage_expire()}</span></div>
                            {this.renderCurrencyRate()}
                        </div>
                        {this.ShowValidTours()}
                        <aside className="sidebar-content width_30 float-right dir-rtl">
                            <div className="filters-container float-right width_95 ">
                                <form method="post" action="/Client_Tour_Cost_Details_ar.bc" target="_blank" className="cost-details-form unvisible">
                                    <input type="hidden" value="[##cms.form.tourname##]" name="tourname" />
                                    <input type="hidden" value="[##cms.form.tour-search-text##]" name="tour-search-text" />
                                    <input type="hidden" value="" name="tour-name-details" className="tour-name-details" />
                                    <input type="hidden" value="" name="fdate-details" className="fdate-details" />
                                    <input type="hidden" value="" name="tdate-details" className="tdate-details" />
                                    <input type="hidden" value="" name="airline-details" className="airline-details" />
                                    <input type="hidden" value='[##cms.json.header|cms.form.roomSearch##]' name="roomSearch" />
                                    <input type="hidden" value="[##cms.form.fdate##]" name="fdate" />
                                    <input type="hidden" value="[##cms.form.tdate##]" name="tdate" />
                                    <button className="background-color_1 color_white border-radius cursor-pointer" type="submit">مشاهدة الحزمة</button>
                                </form>
                                <p>
                                    تم العثور  <span className="font-weight result-count">{this.renderCount()}</span> من الجولات
                                </p>
                                <p className="section-timer ">الوقت المتبقي : <span id="timer" className="font-weight EnNum font_20">00:00:00</span></p>

                                <div className="filter-container">
                                    <p className="filter-head"><span className="font_14 float-right">اسم الفندق</span>
                                        <div className="clr"></div>
                                    </p>
                                    <div className="filter-row">
                                        <ul className="filter-body  text-center font_13">
                                            <li className="width_100">
                                                <input value={this.state.filterName} onChange={((e) => this.handleFilterName(e))} placeholder="أدخل اسم الفندق المطلوب" className="inner  filter-name-hotel"
                                                />
                                            </li>
                                            <div className="clr"></div>
                                        </ul>
                                    </div>
                                </div>
                                <div className="filter-container filter-star">
                                    <p className="filter-head"><span className="font_14 float-right">درجة الفندق</span>
                                        <div className="clr"></div>
                                    </p>
                                    <div className="filter-row">
                                        <ul className="filter-body text-center font_13">
                                            <li className="width_50 float-right">
                                                <div className="inner p-relative">
                                                    <input type="checkbox" value="0,1,2" className="checkbox-click" data-filter="stars" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} />
                                                    <label>
                                                        <div className="icon"><i className="fa fa-star"></i><i className="fa fa-star"></i></div>
                                                        <div className="text">
                                                            <p>أقل من 3 درجات</p>
                                                        </div>
                                                    </label>
                                                </div>
                                            </li>
                                            <li className="width_50 float-right">
                                                <div className="inner p-relative">
                                                    <input type="checkbox" value="3" className="checkbox-click" data-filter="stars" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} />
                                                    <label>
                                                        <div className="icon"><i className="fa fa-star"></i><i className="fa fa-star"></i><i className="fa fa-star"></i></div>
                                                        <div className="text">
                                                            <p>  3 درجة</p>
                                                        </div>
                                                    </label>
                                                </div>
                                            </li>
                                            <li className="width_50 float-right">
                                                <div className="inner p-relative">
                                                    <input type="checkbox" value="4" className="checkbox-click" data-filter="stars" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} />
                                                    <label>
                                                        <div className="icon"><i className="fa fa-star"></i><i className="fa fa-star"></i><i className="fa fa-star"></i><i className="fa fa-star"></i></div>
                                                        <div className="text">
                                                            <p>  4 درجة</p>
                                                        </div>
                                                    </label>
                                                </div>
                                            </li>
                                            <li className="width_50 float-right">
                                                <div className="inner p-relative">
                                                    <input type="checkbox" value="5" className="checkbox-click" data-filter="stars" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} />
                                                    <label>
                                                        <div className="icon"><i className="fa fa-star"></i><i className="fa fa-star"></i><i className="fa fa-star"></i><i className="fa fa-star"></i><i className="fa fa-star"></i></div>
                                                        <div className="text">
                                                            <p>  5 درجة</p>
                                                        </div>
                                                    </label>
                                                </div>
                                            </li>
                                            <div className="clr"></div>
                                        </ul>
                                    </div>
                                </div>
                                {this.ShowFilterTour()}
                                <div className="filter-container">
                                    <p className="filter-head"><span className="font_14 float-right">توقف</span>
                                        <div className="clr"></div>
                                    </p>
                                    <div className="filter-row">
                                        <ul className="filter-body text-center font_13">
                                            <li className="width_50 float-right">
                                                <div className="inner p-relative">
                                                    <input type="checkbox" value="0" className="checkbox-click" data-filter="stops" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} />
                                                    <label>
                                                        <div className="text">
                                                            <p>بدون توقف</p>

                                                        </div>
                                                    </label>

                                                </div>

                                            </li>
                                            <li className="width_50 float-right">
                                                <div className="inner p-relative">
                                                    <input type="checkbox" value="1" className="checkbox-click" data-filter="stops" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} />
                                                    <label>
                                                        <div className="text">
                                                            <p>توقف واحد </p>

                                                        </div>
                                                    </label>
                                                </div>

                                            </li>
                                            <li className="width_50 float-right">
                                                <div className="inner p-relative">
                                                    <input type="checkbox" value="2,3,4,5" className="checkbox-click" data-filter="stops" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} />
                                                    <label>
                                                        <div className="text">
                                                            <p>2 توقف و أكثر</p>

                                                        </div>
                                                    </label>
                                                </div>

                                            </li>

                                            <div className="clr"></div>

                                        </ul>
                                    </div>
                                </div>


                            </div>
                        </aside>
                        <div className="result-content width_70 float-left dir-rtl">
                            <div className="neardate unvisible font_12 text-center"><span>في التاريخ المذکور الجولة غير متوفرة ! سوف يتم عرض أقرب تاريخ متاح.</span></div>
                            <div className="result-items tour">
                                {this.renderLibrary()}
                                <ul id="page-numbers">
                                    <li className="nexprev">
                                        {currentPage !== 1 && (
                                            <button onClick={this.previousPage}><i className="fa fa-backward"></i></button>
                                        )}
                                    </li>
                                    <li className="controls background-color_2 font-weight">{this.state.currentPage}</li>
                                    {(this.state.currentPage2 < maxPage) && (<li className="controls" onClick={this.nextPage}>{this.state.currentPage2}</li>
                                    )}
                                    {(this.state.currentPage3 < maxPage) && (<li className="controls" onClick={this.nextPage3}>{this.state.currentPage3}</li>
                                    )}
                                    <li className="restControls">...</li>
                                    <li className="controls">{this.state.maxPage}</li>
                                    <li className="nexprev">
                                        {(this.state.currentPage < maxPage) && (<button onClick={this.nextPage}><i className="fa fa-forward"></i></button>
                                        )}
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div className="clr"></div>
                    </div>
                    )
                }
                ShowValidTours() {
                    let element = this.state.data_valid_tours;
                    if (!element) return null;
                    if (element.length > 0) return <div className="valid-tours-container owl-carousel">{this.renderValidTours(element)}</div>
                }
                renderValidTours(element) {
                    return element.map((item, i) => (
                        <section className="item-tour">
                            <form method="post" action="/Tem3_Tour_Search_AR.bc">
                                <p className="name-tour">{item.name}</p>
                                <p className="dateinfo-tour"><span>من </span><span className="dateinfo">{item.dateinfo.begindate.mstring}</span><span>ل </span><span className="dateinfo">{item.dateinfo.enddate.mstring}</span></p>
                                <input type="hidden" value='[##cms.json.header|cms.form.roomSearch##]' name="roomSearch" />
                                <input type="hidden" value='[##cms.form.tourname##]' name="tourname" />
                                <input type="hidden" value="[##cms.form.data_type_tour##]" name="data_type_tour" />
                                <input type="hidden" value="[##cms.form.data_type##]" name="data_type" />
                                <input type="hidden" value="[##cms.form.tour-search-text##]" name="tour-search-text" />
                                <input type="hidden" value={item.dateinfo.begindate.sstring} name="fdate" />
                                <input type="hidden" value={item.dateinfo.enddate.sstring} name="tdate" />
                                <input type="hidden" value="[##cms.form.persiancurrent##]" class="persiancurrent" name="persiancurrent" />
                                <button type="submit" className=""></button>
                            </form>
                        </section>
                    ))
                }
                ShowFilterTour() {
                    let element = this.state.data;
                    if (!element) return null;
                    return <div> <div className="filter-container">
                        <p className="filter-head"><span className="font_14 float-right">خدمة الفندق</span>
                            <div className="clr"></div>
                        </p>
                        <div className="filter-row">
                            <ul className="filter-body stop-items text-center font_13">
                                {this.renderservice(element)}
                                <div className="clr"></div>
                            </ul>
                        </div>
                    </div>
                        <div className="filter-container">
                            <p className="filter-head"><span className="font_14 float-right">حالة الفندق</span>
                                <div className="clr"></div>
                            </p>
                            <div className="filter-row">
                                <ul className="filter-body stop-items text-center font_13">
                                    {this.renderallavailability(element)}
                                    <div className="clr"></div>
                                </ul>
                            </div>
                        </div>
                        <div className="filter-container">
                            <p className="filter-head"><span className="font_14 float-right">الخطوط الجوية</span>
                                <div className="clr"></div>
                            </p>
                            <div className="filter-row airline_results">
                                {this.renderairlines(element)}
                                <div className="clr"></div>
                            </div>
                        </div>
                        <div className="filter-container">
                            <p className="filter-head"><span className="font_14 float-right">رقم التذکره(الرحله) </span>
                                <div className="clr"></div>
                            </p>
                            <div className="filter-row">
                                <ul className="filter-body text-center font_13">
                                    <li className="width_100">
                                        <input value={this.state.filterFlightNumber} onChange={((e) => this.handleFilterFlightNumber(e))} placeholder="رقم التذکره(الرحله)" className="inner filter-flight-number"
                                        />
                                    </li>
                                    <div className="clr"></div>
                                </ul>
                            </div>
                        </div>

                    </div>
                }
                renderairlines(element) {
                    let indents = [];
                    if (element.length !== undefined) {
                        let sentencesBack = [...(new Set(element
                            .map((d) => {
                                if (d['backtobackinfo']) {
                                    return d['backtobackinfo']['mainflights']
                                }
                            }).flat().map((elem) => {
                                if (elem) {
                                    return elem['routeshow']['routesinfoo']
                                }
                            }
                            ).flat().map((info) => {
                                if (info) {
                                    return info['routesinfoodetails']['otherdetails']['detailsairline']
                                }
                            }
                            )))]
                        let sentencesOne = [...(new Set(element
                            .map((d) => {
                                if (d['onewayflights']) {
                                    return d['onewayflights']
                                }
                            }).flat().map((elem) => {
                                if (elem) {
                                    return elem['routeshow']['routesinfoo']
                                }
                            }
                            ).flat().map((info) => {
                                if (info) {
                                    return info['routesinfoodetails']['otherdetails']['detailsairline']
                                }
                            }
                            )))]
                        let sentences = sentencesBack.concat(sentencesOne.filter((item) => sentencesBack.indexOf(item) < 0))

                        let imgDep = [...(new Set(element
                            .map((d) => {
                                if (d['backtobackinfo']) {
                                    return d['backtobackinfo']['mainflights']
                                }
                            }).flat().map((elem) => {
                                if (elem) {
                                    return elem['routeshow']['routesinfoo']
                                }
                            }
                            ).flat().map((info) => {
                                if (info) {
                                    return info['routesinfoodetails']['otherdetails']['detailsairlineimage']
                                }
                            }
                            )))]
                        let imgDes = [...(new Set(element
                            .map((d) => {
                                if (d['onewayflights']) {
                                    return d['onewayflights']
                                }
                            }).flat().map((elem) => {
                                if (elem) {
                                    return elem['routeshow']['routesinfoo']
                                }
                            }
                            ).flat().map((info) => {
                                if (info) {
                                    return info['routesinfoodetails']['otherdetails']['detailsairlineimage']
                                }
                            }
                            )))]
                        let sentencesimg = imgDep.concat(imgDes.filter((item) => imgDep.indexOf(item) < 0))

                        for (let i = 0; i < sentences.length; i++) {
                            let singleSentence = <div className="filter-body airline_filter"><div className="section-input_list p-relative" data-index="1"><input type="checkbox" value={sentences[i]} className="p-absolute" data-filter="startairline" onChange={((e) => this.handleChange(e))} defaultChecked={this.props.defaultChecked} /><label><img src={sentencesimg[i]} alt={sentences[i]} width="50" height="20" className="img_airline" /><span className="checkbox "><div className="name_airline text-checkbox float_right">{sentences[i]}</div></span><span className="total_content font_11 float-left ">من <span className="min_total">{new Intl.NumberFormat().format(this.min_totalByAirline(element, sentences[i]))}</span><span className="unit_content">{[...(new Set(element.map(x => this.renderUnit(x.unit, this.state.state_currency_unit))))]}</span></span></label></div><div className="clr"></div></div>
                            indents.push(singleSentence)
                        }

                        return (
                            indents
                        )

                    }
                }

                min_totalByAirline = (data, name) => {
                    const { state_currency_cost, state_floatdigit } = this.state;
                    const totalsBack = data.filter((x) => {
                        if (x.backtobackinfo) {
                            return x.backtobackinfo.mainflights
                                .flatMap(z => z.routeshow.routesinfoo)
                                .find(y => y.routesinfoodetails.otherdetails.detailsairline === name)
                        }
                    })
                        .map(x => x.totalcostmin);

                    const totalsOne = data.filter((x) => {
                        if (x.onewayflights) {
                            return x.onewayflights.flatMap(z => z.routeshow.routesinfoo).find(y => y.routesinfoodetails.otherdetails.detailsairline === name)
                        }
                    })
                        .map(x => x.totalcostmin);



                    let new_totalsBack = new Array();
                    for (const element of totalsBack) {
                        if (state_floatdigit == '') {
                            new_totalsBack.push(element * state_currency_cost);
                        } else {
                            let toString_element = (element * state_currency_cost).toString();
                            if (toString_element.indexOf('.') > -1) {
                                let parseFloat_element = parseFloat(toString_element).toFixed(state_floatdigit).toString();
                                let parseFloat_element_split = parseFloat_element.split('.');
                                if (parseFloat_element_split[1].indexOf('0') > -1) {
                                    new_totalsBack.push(parseFloat(element * state_currency_cost).toFixed(1).toString())
                                } else {
                                    new_totalsBack.push(parseFloat(element * state_currency_cost).toFixed(state_floatdigit).toString())
                                }
                            } else {
                                new_totalsBack.push(parseFloat(element * state_currency_cost).toFixed(state_floatdigit).toString())
                            }
                        }

                    }
                    let new_totalsOne = new Array();
                    for (const element of totalsOne) {
                        if (state_floatdigit == '') {
                            new_totalsOne.push(element * state_currency_cost);
                        } else {
                            let toString_element = (element * state_currency_cost).toString();
                            if (toString_element.indexOf('.') > -1) {
                                let parseFloat_element = parseFloat(toString_element).toFixed(state_floatdigit).toString();
                                let parseFloat_element_split = parseFloat_element.split('.');
                                if (parseFloat_element_split[1].indexOf('0') > -1) {
                                    new_totalsOne.push(parseFloat(element * state_currency_cost).toFixed(1).toString())
                                } else {
                                    new_totalsOne.push(parseFloat(element * state_currency_cost).toFixed(state_floatdigit).toString())
                                }
                            } else {
                                new_totalsOne.push(parseFloat(element * state_currency_cost).toFixed(state_floatdigit).toString())
                            }
                        }

                    }
                    return Math.min(...new_totalsBack, ...new_totalsOne);
                }

                min_totalByGrade = (data, name) => {
                    const totals = data.filter(x =>
                        x.hotelinfo.flatMap(z => z.hotel).find(
                            (y) => {
                                if (y.hotelinfo) {
                                    return y.hotelinfo.hotelsearch.star === name
                                }
                            })).map(x => x.totalcostmin);
                    return Math.min(...totals);
                }
                renderservice(element) {
                    if (element.length !== undefined) {
                        let sentences = [...(new Set(element.map(d => d['hotelinfo']).flat().map(a => a['hotel']).flat().map((elem) => { if (elem['hotelinfo']) { return elem['hotelinfo']['hotelsearch']['services'] } }).flat()))]
                        let singleSentence = sentences.map(s => <React.Fragment>
                            <li className="width_50 float-right">
                                <div className="inner p-relative">
                                    <input type="checkbox" value={s} className="checkbox-click" data-filter="services" onChange={(e) => this.handleChange(e)} defaultChecked={this.props.defaultChecked} />
                                    <label><div className="text"> {this.renderserviceNameFilter(s)}</div> </label> </div> </li></React.Fragment>);
                        let output = singleSentence
                        return (
                            output
                        )
                    }
                }
                renderserviceNameFilter(element) {
                    if (element == 'R.O' || element == 'RO') {
                        return <p className="has-not"><div className="icon"><i className="fa fa-coffee"></i><i className="far fa-spoon"></i></div>غرفة فقط</p>
                    } else if (element == 'B.B' || element == 'BB') {
                        return <p><div className="icon"><i className="fa fa-coffee"></i></div>مع الإفطار</p>
                    } else if (element == 'H.B' || element == 'HB') {
                        return <p><div className="icon"><i className="fa fa-coffee"></i><i className="far fa-spoon"></i></div>مع الإفطار والغداء </p>
                    } else {
                        return <p><div className="icon"><i className="fa fa-hotel"></i></div>{element}</p>


                    }

                }
                renderallavailability(element) {
                    if (element.length !== undefined) {
                        let sentences = [...(new Set(element.map(d => d['hotelinfo']).flat().map(a => a['hotel']).flat()
                            .map((d) => {
                                if (d['hotelinfo']) {
                                    return d['families']
                                }
                            }).flat()
                            .map((info) => {
                                if (info) {
                                    return info['availablerooms']
                                }
                            })
                            .flat()
                            .map((info) => {
                                if (info) {
                                    return info['info']['availability']
                                }
                            })
                        ))]
                        let singleSentence = sentences.map((s) => {
                            if (s == 'onrequest') {
                                return <React.Fragment><li className="width_50 float-right">
                                    <div className="inner p-relative">
                                        <input type="checkbox" value={s} className="checkbox-click" data-filter="all_availability" onChange={(e) => this.handleChange(e)} defaultChecked={this.props.defaultChecked} />
                                        <label><div className="text"><p>On Request</p></div> </label> </div> </li> </React.Fragment>
                            } else {
                                return <React.Fragment><li className="width_50 float-right">
                                    <div className="inner p-relative">
                                        <input type="checkbox" value={s} className="checkbox-click" data-filter="all_availability" onChange={(e) => this.handleChange(e)} defaultChecked={this.props.defaultChecked} />
                                        <label><div className="text"><p>Available</p></div> </label> </div> </li> </React.Fragment>
                            }
                        });
                        let output = singleSentence
                        return (
                            output
                        )
                    }
                }

                handleChange = (event) => {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                    this.handleReset(event);
                    let isChecked = event.target.checked
                    let value = event.target.value
                    let data_attribute = event.target.getAttribute("data-filter");
                    switch (data_attribute) {
                        case 'stars':
                            if (isChecked) {
                                event.target.closest("div").setAttribute("class", "inner p-relative active");
                                this.stars.push(value + ',')
                            } else {
                                event.target.closest("div").setAttribute("class", "inner p-relative");
                                this.stars.splice(this.stars.indexOf(value + ','), 1)
                            }
                            break;
                        case 'services':
                            if (isChecked) {
                                event.target.closest("div").setAttribute("class", "inner p-relative active");
                                this.service.push(value + ',')
                            } else {
                                event.target.closest("div").setAttribute("class", "inner p-relative");
                                this.service.splice(this.service.indexOf(value + ','), 1)
                            }
                            break;

                        case 'all_availability':
                            if (isChecked) {
                                event.target.closest("div").setAttribute("class", "inner p-relative active");
                                this.availability.push(value + ',')
                            } else {
                                event.target.closest("div").setAttribute("class", "inner p-relative");
                                this.availability.splice(this.availability.indexOf(value + ','), 1)
                            }
                            break;
                        case 'startairline':
                            if (isChecked) {
                                this.airlines.push(value + ',')
                            } else {
                                this.airlines.splice(this.airlines.indexOf(value + ','), 1)
                            }
                            break;
                        case 'stops':
                            if (isChecked) {
                                event.target.closest("div").setAttribute("class", "inner p-relative active");
                                this.stops.push(value + ',')
                            } else {
                                event.target.closest("div").setAttribute("class", "inner p-relative");
                                this.stops.splice(this.stops.indexOf(value + ','), 1)
                            }
                            break;
                    }
                    $(document).trigger('update_result', [this.service.join(), this.stars.join(), this.availability.join(), this.airlines.join(), this.stops.join()])
                    this.setState({
                        state_service: this.service.join(),
                        state_stars: this.stars.join(),
                        state_availability: this.availability.join(),
                        state_airlines: this.airlines.join(),
                        state_stops: this.stops.join(),
                    })
                }

                renderCount(element) {
                    let maxPage = this.state.maxPage
                    let len = this.renderLibrary().length
                    let sum = len * maxPage
                    sum = sum || 0
                    if (sum == '0') {
                        $("#page-numbers").hide();
                        $(".message-box-nodata").show();
                        $(".cost-details-form").addClass("unvisible");

                    } else {
                        $("#page-numbers").show();
                        $(".message-box-nodata").hide();
                        $(".cost-details-form").removeClass("unvisible");
                    }

                }
                renderResearch = event => {
                    return location.reload()
                }
                renderNeardate(element) {
                    let neardate = element.neardate
                    if (neardate == '1') {
                        $(".neardate").show()
                    }
                }
                renderTime(element) {
                    if (element.time !== undefined) {
                        return <span className="font_12">{element.time.wenttime} - {element.time.backtime}</span>
                    }
                }
                renderprovider(element) {
                    let provider = element.id.provider
                    if (provider == undefined) {
                        return ''
                    } else {
                        return <input type="hidden" value={JSON.stringify(provider)} name="mainprovider" />
                    }
                }
                renderhotelgroupid(element) {
                    if (element.hotelinfo[0].hotel.length == 0) {
                        return <input type="hidden" value="" name="hotelgroupid" />
                    } else {
                        return <input type="hidden" value={element.hotelinfo[0].hotel[0].hotelgroupid} name="hotelgroupid" />
                    }
                }

                renderproviderId(element) {
                    let provider = element.provider
                    if (provider == undefined) {
                        return <input type="hidden" value="0" name="provider" />
                    } else {
                        let providerId = element.provider.provider_id
                        return <input type="hidden" value={providerId} name="provider" />
                    }
                }
                renderbacktobackinfo(element, i) {
                    if (element !== undefined) {
                        return <div className="flight-part">{this.rendermainflights(element, i)}<div className="clr"></div></div>
                    }

                }
                rendermainflights(element, i) {
                    let lenmainflights = element.mainflights.length
                    let indents = []
                    let index = 0
                    for (let len = 0; len < lenmainflights; len++) {
                        let numlen = len
                        let numCounter = i
                        let stinglen = numlen.toString()
                        let stingCounter = numCounter.toString()
                        index = stinglen + stingCounter
                        indents.push(<div className="flight-part-item">
                            <div className="d-flex p-relative flex-justify">
                                <div className="img-item float-right text-center">
                                    <img src={element.mainflights[len].ticketinfooo.showstartairline} alt={element.mainflights[len].routeshow.routesinfoo[0].routesinfoodetails.otherdetails.detailsairline} width="80"
                                        height="32" />
                                    <div className="class-item font_10">
                                        رقم التذکره(الرحله): {element.mainflights[len].routeshow.routesinfoo[0].routesinfoodetails.otherdetails.detailsroutecode}
                                    </div>
                                    {this.renderAllDetails(index, lenmainflights)}
                                </div>
                                <div className="infoes-item width_100">
                                    <div className="info-item float-right text-center">

                                        <div className="airport-item font_19 font-weight color_font">{element.mainflights[len].infoo.showstartcity}</div>
                                        <p className="city-name font_13">{element.mainflights[len].ticketinfooo.exitinfo.shortstartairport}</p>
                                        <div className="time-item font-weight font_20 color_font">{element.mainflights[len].ticketinfooo.exitinfo.showexittime}</div>
                                    </div>
                                    <div
                                        className="duration-item text-center width_70 p-relative float-right">
                                        {this.renderStopinfo(element.mainflights[len])}

                                        <div className="item-hour font_11 p-absolute">
                                            <span>مدة السفر: </span>
                                            <span className="hour">{element.mainflights[len].ticketinfooo.stoppinfoo.showtiming}</span>
                                        </div>
                                    </div>
                                    <div className="info-item text-center float-left">
                                        <div className="airport-item font_19 font-weight color_font">{element.mainflights[len].infoo.showendcity}</div>
                                        <p className="city-name font_13">{element.mainflights[len].ticketinfooo.arrivalinfo.shortendairport}</p>
                                        <div className="time-item font-weight font_20 color_font">{element.mainflights[len].ticketinfooo.arrivalinfo.showarrivaltime}</div>
                                    </div>
                                    <div className="clr"></div>
                                </div>

                            </div>

                            {this.renderDetails(element.mainflights[len], index, lenmainflights)}
                        </div>
                        )

                    }
                    return (
                        indents
                    )


                }
                renderStopinfo(element) {
                    if (element.ticketinfooo.stoppinfoo.showstopinfo == 0) {
                        return <div className="duration-line p-relative no-stop">
                            <svg className="svg-icon p-absolute" width="25" height="25"
                                viewBox="0 0 28.284 28.284">
                                <g>
                                    <path
                                        d="M19.435.565a1.929 1.929 0 0 0-2.756.028l-4.1 4.269-10-3.309-2.1 2.1 8.339 5.131L4.6 13.179l-2.7-.444L0 14.632l3.976 1.393L5.368 20l1.9-1.9-.444-2.7 4.394-4.217 5.131 8.334 2.1-2.1-3.309-10 4.269-4.1a1.929 1.929 0 0 0 .026-2.752z"
                                        transform="rotate(-135 12.929 11.213)"
                                    >
                                    </path>
                                </g>
                            </svg>
                            <i
                                className="flaticon-map-marker p-absolute font_17"></i>
                        </div>
                    } else {
                        return <div className="duration-line p-relative has-stop">
                            {this.renderCountStop(element)}
                            <svg className="svg-icon p-absolute" width="25" height="25"
                                viewBox="0 0 28.284 28.284">
                                <g>
                                    <path
                                        d="M19.435.565a1.929 1.929 0 0 0-2.756.028l-4.1 4.269-10-3.309-2.1 2.1 8.339 5.131L4.6 13.179l-2.7-.444L0 14.632l3.976 1.393L5.368 20l1.9-1.9-.444-2.7 4.394-4.217 5.131 8.334 2.1-2.1-3.309-10 4.269-4.1a1.929 1.929 0 0 0 .026-2.752z"
                                        transform="rotate(-135 12.929 11.213)"
                                    >
                                    </path>
                                </g>
                            </svg>
                            <i
                                className="flaticon-map-marker p-absolute font_17"></i>
                        </div>
                    }
                }
                renderCountStop(element) {
                    let indents = [];
                    for (let i = 0; i < element.ticketinfooo.stoppinfoo.showstopinfo; i++) {
                        indents.push(<div className="flight-duration-stop p-relative"><span className="stop-item p-absolute font_10">{this.renderAbbreviationAirport(element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsarrivaltimeinfo.detailsarrivalairport)}</span><span className="stop-tooltip p-absolute transition">{element.routeshow.routesinfoo[i].routesinfoodetails.detailscityinfo.detailsendcity}</span>
                        </div>)
                    }
                    return (indents)
                }
                renderAbbreviationAirport(element) {
                    let element_splited = element.split("/")
                    return element_splited[1]
                }
                renderAllDetails(i, len) {
                    let numlen = len
                    let numCounter = i
                    let stinglen = numlen.toString()
                    let stingCounter = numCounter.toString()
                    let index = stinglen + stingCounter
                    return <div onClick={((e) => this.showAllDetails(e, index))}
                        className="details-btn font_12 color_2 text-center cursor-pointer">
                        تفاصيل
                    </div>


                }
                renderDetails(element, i, len) {
                    let numlen = len
                    let numCounter = i
                    let stinglen = numlen.toString()
                    let stingCounter = numCounter.toString()
                    let index = stinglen + stingCounter
                    return <div key={index} className={`details-container text-right ${!this.state.visibleAll[index] ? "unvisible" : "visible"}`}>
                        <div className="wrapper-tab-details d-row font_13 ">
                            <div className="tab-details tour" onClick={((e) => this.showDetails(e, index))}>
                                <span className={`with-tab p-relative ${!this.state.activeTab_details[index] ? "" : "active-tab"}`}>تفاصيل الرحلة</span>

                            </div>
                            <div className="tab-details tour" onClick={(e) => this.showBar(e, index)}>
                                <span className={`with-tab p-relative ${!this.state.activeTab_bar[index] ? "" : "active-tab"}`}>قوانین الحقائب</span>

                            </div>
                            <div className="tab-details tour p-relative" onClick={((e) => this.showRule(e, index))}>
                                <span className={`with-tab p-relative ${!this.state.activeTab_rule[index] ? "" : "active-tab"}`}>قوانين الرحلة</span>

                            </div>
                            <div className="clr"></div>
                        </div>
                        <div key={index} className={`details-content  ${!this.state.visibleDetails[index] ? "unvisible" : "visible"}`}>
                            {this.renderFlightDetails(element)}
                            <div className="clr"></div>
                        </div>
                        <div key={index} className={`details-content  ${!this.state.visibleRule[index] ? "unvisible" : "visible"}`}>
                            {this.renderRule(element, i, len)}
                        </div>
                        <div key={index} className={`details-content  ${!this.state.visibleBar[index] ? "unvisible" : "visible"}`}>
                            {this.renderBar(element, i, len)}
                        </div>
                    </div>
                }
                renderRule(element, i, len) {
                        if (typeof element.routeshow.description === 'string') {
                            return <div className="details-item">
                                <input type="hidden" value="string" name="type-description" />
                                <div className="title font_14" onClick={e => this.ruleDep(e, element, i, len, 'string')}>لمعرفة قوانين رحلة <span className="clicked font-weight cursor-pointer">اضغط هنا</span></div>
                                <div dir="auto" className={`text-justify max-height font_13 info-loaded ruleDepTxt-${i}-${len}`}>{this.state.ruleDepTxt[i]}</div>
                            </div>
                        }
                }
                renderBar(element, i, len) {
                        if (typeof element.routeshow.description === 'string') {
                            return <div className="details-item">
                                <div className="title font_14" onClick={e => this.bardep(e, element, i, len, 'string')}>لمعرفة قوانین الحقائب <span className="clicked font-weight cursor-pointer">اضغط هنا</span></div>
                                <div dir="auto" className={`text-justify max-height font_13 info-loaded barDepTxt-${i}-${len}`}>{this.state.barDepTxt[i]}</div>
                            </div>

                        }
                    }
                    ruleDep = (e, element, i, len, type) => {
                        if (type == 'string') {
                            document.querySelector(`.ruleDepTxt-${i}-${len}`).innerHTML = element.routeshow.description
                        }
                    }
                    bardep = (e, element, i, len, type) => {
                       
                        if (type == 'string') {
                            document.querySelector(`.barDepTxt-${i}-${len}`).innerHTML = `<div><span className="text-color">حمولة المقصورة: </span><span>${element.barinfo.bar}</span></div>
                                    <div><span className="text-color">الحمل المسموح به: </span><span>${element.barinfo.bar1}</span></div>`
                        }
                    };
                renderFlightDetails(element, deps) {
                    let len = element.routeshow.routesinfoo.length
                    let indents = [];
                    for (let i = 0; i < len; i++) {
                        indents.push(<div className="details-item">
                            <p className="font_14 details-head font-weight"> ({element.routeshow.routesinfoo[i].routesinfoodetails.detailscityinfo.detailsstartcity} - {element.routeshow.routesinfoo[i].routesinfoodetails.detailscityinfo.detailsendcity})</p>
                            <div className="content d-row font_13 text-center">
                                <div className="details-col d-flex">
                                    <div className="img"> <img src={element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsairlineimage} alt={element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsairline} width="60" height="24" /></div>
                                    <div>
                                        <div className="city_name"><span>{element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsexittimeinfo.detailsexitairport}</span></div>
                                        <div><span className="city_hour font_14">{element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsexittimeinfo.detailsexittime}</span></div>
                                    </div>
                                </div>
                                <div className="details-col details-circle p-relative">
                                    <div className="details-row-first"></div>
                                    <div className="duration-time_text">Flight Duration: {element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailstiming}</div>
                                    <div style={{ marginTop: "0.5em" }}>
                                        <span
                                            className="code-item font_10">Flight Number: {element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsroutecode}</span>

                                    </div>
                                </div>
                                <div className="details-col">
                                    <div className="city_name"><span>{element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsarrivaltimeinfo.detailsarrivalairport}</span></div>
                                    <div><span className="city_hour font_14">{element.routeshow.routesinfoo[i].routesinfoodetails.otherdetails.detailsarrivaltimeinfo.detailsarrivaltime}</span></div>
                                </div>
                            </div>
                        </div>);
                    }
                    return (
                        indents
                    )
                }



                renderonewayflights(element, i) {
                    if (element.onewayflights !== undefined) {
                        let lenonewayflights = element.onewayflights.length
                        let indents = []
                        if (lenonewayflights == 0) {
                        } else {
                            let index = 0
                            for (let len = 0; len < lenonewayflights; len++) {
                                let numlen = len
                                let numCounter = i
                                let stinglen = numlen.toString()
                                let stingCounter = numCounter.toString()
                                index = stinglen + stingCounter
                                indents.push(<div className="flight-part"><p className="font_13 title-items"> رحلة داخلية</p>
                                    <div className="width_100  p-relative">
                                        <div className="d-row top-row p-relative"><div className="item-img"><img src={element.onewayflights[len].ticketinfooo.showstartairline} alt={element.onewayflights[len].routeshow.routesinfoo[0].routesinfoodetails.otherdetails.detailsairline} width="60" height="24" /><span className="code-item font_10"> رقم التذکره(الرحله): {element.onewayflights[len].routeshow.routesinfoo[0].routesinfoodetails.otherdetails.detailsroutecode}</span></div><div className="item-info float-right text-center"><div className="item-time font_18 font-weight text-left">{element.onewayflights[len].ticketinfooo.exitinfo.showexittime}</div><div className="item-airport font_12 text-left">{element.onewayflights[len].infoo.showstartcity} ({element.onewayflights[len].ticketinfooo.exitinfo.shortstartairport})</div></div><div className="item-duration float-right text-center width_50"><div className="item-hour font_12"><span>مدة السفر: </span><span className="hour font_11">{element.onewayflights[len].ticketinfooo.stoppinfoo.showtiming}</span></div><div className="trip-flight-duration-line d-flex p-relative color_1">{this.renderStopinfo_shape(element.onewayflights[len].ticketinfooo.stoppinfoo.showstopinfo)}<svg height="15" viewBox="0 0 16 15" width="16" xmlns="http://www.w3.org/2000/svg"><path d="m13.8508482 10.0932087c.0944518-.0734069.1491518-.18223445.1491518-.29712002v-.70693105c0-.12647612-.0662419-.24491613-.1773617-.31717936l-5.16402687-3.35662434.11379855-3.04003223c.00033071-.00883973.00033071-.01764855 0-.02648828-.03700685-1.028623-.45149022-1.59900187-.79268745-1.89633821-.41071323-.35791629-.85052926-.45249521-1.02574133-.45249521-.19908959 0-.63513548.13197777-1.02041684.49555026-.32777026.30929779-.71635875.8847765-.70620584 1.87003538.00003307.00327626.00009921.00652162.0002315.00979788l.11383162 3.04003223-5.16405993 3.35665524c-.1110867.07220142-.17736171.19070324-.17736171.31717936v.70690014c0 .11482376.05466696.22368221.14915184.29708911.09448488.0734068.21903162.1037277.33980823.0827411l4.99814092-.86861158.11459226 3.06043158-1.812509 1.1781257c-.11111978.0722014-.17736171.1907033-.17736171.3171794v.3192811c0 .213328.18506733.3863518.41339201.3863518h1.9615947c.24261151.2609574.58923244.4182181.96604753.4304886.01597346.0005563.03194693.0007727.04778811.0007727.3905397 0 .76054209-.1609387 1.01363721-.4313231h1.96043721c.22829159 0 .41339199-.1730238.41339199-.3863518v-.3192811c0-.1264762-.0662419-.244978-.1773617-.3171794l-1.812509-1.1781257.11459227-3.06040069 4.99814093.86864249c.1208097.0209248.2453564-.0093652.3398744-.082772zm-.6776653-.76191668-4.98110916-.86567527c-.11829626-.02052301-.24036265.00809793-.3341861.07847578-.09392267.07034693-.15030934.17549643-.1545094.28787844l-.13919736 3.71917683c-.00492763.131236.06174423.2557649.17706407.3306862l1.40632655.9141393h-1.34256497c-.14670456 0-.28239635.0726341-.35660848.1908887-.09299667.1483282-.26457089.2404344-.44775316.2404344-.00621741 0-.01250097 0-.01885067-.0003091-.17729557-.0058416-.3376586-.0958152-.42893556-.2406817-.07431134-.1179454-.20980471-.1903323-.35621162-.1903323h-1.34421854l1.40632655-.9141393c.11531984-.0749213.18202477-.199512.17709714-.3306862l-.13923043-3.71917683c-.00420006-.11241292-.0606198-.21753151-.15447633-.28787844-.09388959-.07037785-.21592291-.09899879-.33421917-.07847578l-4.98114224.86567527v-.04021149l5.17169942-3.36160055c.11531984-.07495225.1819917-.19951206.17709714-.33068622l-.12150418-3.24544775c-.01091355-1.25057437.76487443-1.53523837.90800728-1.57662437.15044163.03300989.93115724.2687463.98350921 1.58515502l-.12117347 3.23694801c-.00489456.13120506.06174423.25573397.17706407.33068622l5.17169941 3.36163145z" transform="matrix(0 -1 1 0 .5 14.5)" /></svg><span className="item-stop p-absolute font_10">{this.renderStopinfo(element.onewayflights[len].ticketinfooo.stoppinfoo.showstopinfo)}</span><div className="provider_name_F p-absolute font_11 color_1"></div><span className="duration-line-city-r p-absolute font_11">(1399-11-21)<br /><span className="EnNum">2021-02-09</span> </span><span className="duration-line-city-l p-absolute font_11">(1399-11-21)<br /><span className="EnNum">2021-02-09</span></span></div></div><div className="item-info text-center float-left"><div className="item-time font_18 font-weight text-right">{element.onewayflights[len].ticketinfooo.arrivalinfo.showarrivaltime}</div><div className="item-airport font_12 text-right">{element.onewayflights[len].infoo.showendcity} ({element.onewayflights[len].ticketinfooo.arrivalinfo.shortendairport})</div></div></div>
                                        <div className="clr"></div>
                                        {this.renderAllDetails(index, lenonewayflights)}
                                        <div className="clr"></div>
                                        {this.renderDetails(element.onewayflights[len], index, lenmainflights)}
                                    </div>
                                    <div className="clr"></div>
                                </div>)
                            }
                            return (
                                indents
                            )
                        }
                    }

                }


                renderhotelinfo_wrapper(element) {
                    if (element.basiscoreid == undefined) {
                        return this.renderhotelinfo(element, element.index)
                    } else {
                        return <div className="hotel-part type_10"><input type="hidden" value={element.basiscoreid} className="basiscoreid" /><div className="load_info_tour"></div>{this.renderhotelinfo(element, element.index)}<div className="clr"></div></div>
                    }
                }

                renderhotelinfo(element, index) {
                    if (element.basiscoreid == undefined) {
                        for (let i = 0; i < element.hotelinfo.length; i++) {
                            let indents = []
                            for (let j = 0; j < element.hotelinfo[i].hotel.length; j++) {
                                let night = j + 1
                                indents.push(<div className="hotel-part  d-flex hotel ">
                                    <div className="img-item text-center p-relative">
                                        <div className="image-container">
                                            <img src={element.hotelinfo[i].hotel[j].hotelinfo.hotelsearch.hotelimage} width="190" height="190" alt={element.hotelinfo[i].hotel[j].hotelinfo.hotelsearch.realname} /><div className="overlay p-absolute"><span className="expand p-absolute">+</span></div>
                                        </div>

                                    </div>
                                    <div className="infoes-item">
                                        <span className="title font_18 color_font font-weight">{element.hotelinfo[i].hotel[j].hotelinfo.name}</span>
                                        <img src={(`https://cdn.basiscore.net/basisfly.com/images/${element.hotelinfo[i].hotel[j].hotelinfo.hotelsearch.star}-rate.png`)} className="hotel-rate" width="80" height="16" alt="rate" />
                                        <ul className="font_12 brief-info">
                                            <li><span className="question-info ">الدخول إلى الفندق:</span><span> <span><span className="EnNum">{element.hotelinfo[i].hotel[j].hotelinfo.validatedate.fdate.mstring}</span></span></span></li>
                                            <li><span className="question-info">الخروج من الفندق :</span><span><span><span className="EnNum">{element.hotelinfo[i].hotel[j].hotelinfo.validatedate.tdate.mstring}</span></span></span></li>
                                            <li><span className="question-info">فترة الإقامة :</span><span>{element.hotelinfo[i].hotel[j].nights} الليل</span></li>
                                            <li><span>{element.hotelinfo[i].hotel[j].hotelinfo.hotelsearch.cityname} / {element.hotelinfo[i].hotel[j].hotelinfo.hotelsearch.countryname}</span></li>
                                        </ul>
                                        <table className="details-tbl font_12">
                                            <tr>
                                                <th>الغرفة</th>
                                                <th>حالة</th>
                                                <th>منظر - خدمة</th>
                                            </tr>
                                            {this.renderInfoFamily(element.hotelinfo[i].hotel[j], j, element, index, element.hotelinfo[i].hotel.length)}
                                        </table>
                                        <div className="clr"></div>
                                    </div>
                                    <div className="clr"></div>
                                </div>)
                            }
                            return (
                                indents
                            )
                        }
                    } else {

                        for (let i = 0; i < element.hotelinfo.length; i++) {
                            let indents = []
                            if (element.hotelinfo[i].hotel.length !== 0) {
                                indents = []
                            }
                            for (let j = 0; j < element.hotelinfo[i].hotel.length; j++) {
                                let night = j + 1
                                indents.push(<div><div className="item_hotel d-flex font_13"><div className="section_tour_img  p-relative">{this.render_img_hotel(element.hotelinfo[i].hotel[j])}</div><div className="section_tour_night"><span> {this.render_nights(element, j)} </span><span className="Qu-info-hotel ">الليل</span></div><div className="section_tour_name"><span className="Qu-info-hotel ">البقاء في الفندق : </span><span className="color_gray">{this.render_name_hotel(element.hotelinfo[i].hotel[j])}</span></div><div className="section_tour_date"><span className="Qu-info-hotel ">تاریخ :</span>{this.render_date_hotel(element, j)}</div>{this.render_room_hotel(element.hotelinfo[i].hotel[j], j + '-' + index)}
                                </div><div key={j + '-' + index} className={` ${!this.state.Visible_rooms[j + '-' + index] ? "unvisible" : "visible"}`}>{this.render_show_rooms(element.hotelinfo[i].hotel[j], j, element, index, element.hotelinfo[i].hotel.length)}<div className="clr"></div></div></div>)
                            }
                            return (
                                indents
                            )
                        }
                    }

                }
                render_room_hotel(element, index) {
                    if (element.hotelinfo == undefined) {
                        return <div class="btn-item"><button type="button" class="color_white border-radius font_15 cursor-pointer not_active_room"> الغرف </button></div>

                    } else {
                        return <div class="btn-item"><button type="button" onClick={() => this.onclick_render_rooms(index)} class="color_white border-radius font_15 cursor-pointer"> الغرف </button></div>

                    }
                }


                render_show_rooms(element, j, ItemElement, index, len) {
                    if (element.hotelinfo == undefined) {
                        return ''
                    } else {
                        return <div className="item-info-module width_100">
                            <table className="details-tbl font_12">
                                <tr>
                                    <th>الغرفة</th>
                                    <th>حالة</th>
                                    <th>منظر - خدمة</th>
                                </tr>
                                {this.renderInfoFamily(element, j, ItemElement, index, len)}
                            </table>
                        </div>

                    }
                }
                render_name_hotel(element) {
                    if (element.hotelinfo == undefined) {
                        return 'ليس لديه'
                    } else {
                        return element.hotelinfo.name
                    }
                }
                render_date_hotel(element, index) {
                    return <span className="date_hotel font_11 color_gray"><span> <span className="EnNum">{element.nights[index].fdate.mstring}</span></span>  / <span> <span className="EnNum">{element.nights[index].tdate.mstring}</span></span> </span>

                }
                render_nights(element, index) {
                    return element.nights[index].stay
                }
                render_img_hotel(element) {
                    if (element.hotelinfo !== undefined) {
                        return <div className="img-item text-center p-relative"><div className="image-container"><img src={element.hotelinfo.hotelsearch.hotelimage} width="145" height="145" alt={element.hotelinfo.hotelsearch.realname} /><div className="overlay p-absolute"><span className="expand p-absolute">+</span></div></div></div>

                    }
                }
                onclick_render_rooms = (i) => {
                    this.setState(prevState => ({
                        Visible_rooms: { ...prevState.Visible_rooms, [i]: !prevState.Visible_rooms[i] }
                    }))
                }


                renderHotelid(element) {
                    let hotelId = element.hotelid
                    return '/hotel_ar.bc?id=' + hotelId
                }

                renderInfoFamily(element, j, ItemElement, index, len) {
                    if (element.hotelinfo == undefined) {
                        return ''
                    } else {
                        let indents = []
                        let lenfamilies = element.families.length
                        for (let x = 0; x < lenfamilies; x++) {
                            let idjx = j + x
                            indents.push(<tbody>
                                <tr>
                                    <td colspan="3">{this.rendercountpassenger(element.families[x], x)}</td>
                                </tr>
                                {this.renderavailablerooms(element.families[x], element, idjx, x, ItemElement, index, j, ItemElement.nights[j].stay, len)}
                            </tbody>)
                        }
                        return (
                            indents
                        )
                    }

                }
                rendercountpassenger(element, x) {
                    let info = [##cms.json.header | cms.form.roomSearch##]
                    if (x == 0) {
                        let ad = info.rooms[0].adultcount
                        let ch = info.rooms[0].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""

                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                age = age + sp[i] + " سنة "
                                ages2 = ages2 + sp[i] + ','
                            }
                            return <span>الغرفة الأولى({ad} بالغ / {sp[0]} طفل / {age})</span>
                        }
                        else {
                            return <span>الغرفة الأولى({ad} بالغ )</span>

                        }
                    }
                    else if (x == 1) {
                        let ad = info.rooms[1].adultcount
                        let ch = info.rooms[1].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""

                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                age = age + sp[i] + " سنة "
                                ages2 = ages2 + sp[i] + ','
                            }
                            return <span>الغرفة ثانية ({ad} بالغ / {sp[0]} طفل {age})</span>

                        }
                        else {
                            return <span>الغرفة ثانية ({ad} بالغ )</span>

                        }
                    }
                    else if (x == 2) {
                        let ad = info.rooms[2].adultcount
                        let ch = info.rooms[2].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""

                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                age = age + sp[i] + " سنة "
                                ages2 = ages2 + sp[i] + ','
                            }
                            return <span>الغرفة ثالث ({ad} بالغ / {sp[0]} طفل {age})</span>
                        }
                        else {
                            return <span>الغرفة ثالث ({ad} بالغ )</span>

                        }
                    }
                    else if (x == 3) {
                        let ad = info.rooms[3].adultcount
                        let ch = info.rooms[3].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""

                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                age = age + sp[i] + " سنة "
                                ages2 = ages2 + sp[i] + ','
                            }
                            return <span>الغرفة الرابع ({ad} بالغ / {sp[0]} طفل {age})</span>
                        }
                        else {
                            return <span>الغرفة الرابع ({ad} بالغ )</span>

                        }
                    }
                }

                renderavailablerooms(element, item, idjx, x, ItemElement, index, j, nights, len) {
                    let lenavailablerooms = element.availablerooms.length
                    let indents = []
                    for (let i = 0; i < lenavailablerooms; i++) {
                        let idx = i + x
                        let idj = idjx + x
                        indents.push(<tr>
                            {this.renderInputRadio(element.availablerooms[i], i, idx, idj, x, lenavailablerooms, ItemElement, index, j, nights, len)}
                            <td>{this.renderavailability(element.availablerooms[i].info.availability)}</td>
                            <td>{this.renderviewname(item.hotelinfo.information.viewname)} {this.renderservices(item.hotelinfo.hotelsearch.services)}</td>
                        </tr>)
                    }
                    return (
                        indents
                    )
                }
                renderavailability(element) {
                    if (element == 'onrequest') {
                        return <span className="text-capitalize">on request</span>
                    } else {
                        return <span className="text-capitalize">{element}</span>
                    }

                }
                renderviewname(element) {
                    if (element == '' || element == '-') {
                        return ''
                    } else {
                        return <span>{element}<span>-</span></span>
                    }


                }
                renderservices(element) {
                    return this.renderserviceName(element)

                }
                renderserviceName(element) {
                    if (element == 'R.O' || element == 'RO') {
                        return 'غرفة فقط'
                    } else if (element == 'B.B' || element == 'BB') {
                        return 'مع الإفطار'
                    } else if (element == 'H.B' || element == 'HB') {
                        return 'مع الإفطار والغداء'
                    } else {
                        return element
                    }

                }
                renderInputRadio(element, i, idx, idj, x, lenavailablerooms, ItemElement, index, j, nights, len) {
                    if (ItemElement.basiscoreid == undefined) {
                        if (i == 0) {
                            return <td className="section-input p-relative">
                                <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.roomid`} key={idj} defaultValue={this.state.roomids[idj] || element.info.roomid} />
                                <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.adultcount`} value={element.info.adults} />
                                <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.childwithbed`} value={element.info.withbed} />
                                <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.childwithoutbed`} value={element.info.withoutbed} />
                                <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.infant`} value={element.info.infants} />
                                <input type="hidden" name={`_root.rooms__${idx}.adultcount`} value={this.rendervalueAdult(element, i, idx, idj, x)} />
                                <input type="hidden" name={`_root.rooms__${idx}.childcountandage`} value={this.rendervalueChild(element, i, idx, idj, x)} />
                                <input type="radio" value={element.info.roomid} onChange={((e) => this.handleCheck(e, i, idj, x, ItemElement, j, element.info.adults, element.info.withbed, element.info.withoutbed, element.info.infants))} name={`element${idj + '-' + j + '-' + index}`} defaultChecked={this.state.chkbox} className="radioButton p-absolute" />
                                <label><span>{element.info.room}</span></label>
                            </td>
                        } else {
                            return <td className="section-input p-relative">
                                <input type="radio" value={element.info.roomid} onChange={((e) => this.handleCheck(e, i, idj, x, ItemElement, j, element.info.adults, element.info.withbed, element.info.withoutbed, element.info.infants))} name={`element${idj + '-' + j + '-' + index}`} className="radioButton p-absolute" />
                                <label><span>{element.info.room}</span></label>
                            </td>
                        }
                    } else {

                        if (i == 0) {
                            if (nights == 1) {
                                return <td className="section-input p-relative">
                                    <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.roomid`} key={idj} defaultValue={this.state.roomids[idj] || element.info.roomid} />
                                    <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.adultcount`} value={element.info.adults} />
                                    <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.childwithbed`} value={element.info.withbed} />
                                    <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.childwithoutbed`} value={element.info.withoutbed} />
                                    <input type="hidden" name={`_root.rooms__${idx}.roomids__${idj}.infant`} value={element.info.infants} />
                                    <input type="hidden" name={`_root.rooms__${idx}.adultcount`} value={this.rendervalueAdult(element, i, idx, idj, x)} />
                                    <input type="hidden" name={`_root.rooms__${idx}.childcountandage`} value={this.rendervalueChild(element, i, idx, idj, x)} />
                                    <input type="radio" value={element.info.roomid} onChange={((e) => this.handleCheck(e, i, idj, x, ItemElement, j, element.info.adults, element.info.withbed, element.info.withoutbed, element.info.infants))} name={`element${idj + '-' + j + '-' + index}`} defaultChecked={this.state.chkbox} className="radioButton p-absolute" />
                                    <label><span>{element.info.room}</span></label>
                                </td>
                            } else {
                                return <td className="section-input p-relative">
                                    {this.render_inputs(nights, idx, idj, element, len, j)}
                                    <input type="hidden" name={`_root.rooms__${idx}.adultcount`} value={this.rendervalueAdult(element, i, idx, idj, x)} />
                                    <input type="hidden" name={`_root.rooms__${idx}.childcountandage`} value={this.rendervalueChild(element, i, idx, idj, x)} />
                                    <input type="radio" value={element.info.roomid} onChange={((e) => this.handleCheck(e, i, idj, x, ItemElement, j, element.info.adults, element.info.withbed, element.info.withoutbed, element.info.infants))} name={`element${idj + '-' + j + '-' + index}`} defaultChecked={this.state.chkbox} className="radioButton p-absolute" />
                                    <label><span>{element.info.room}</span></label>
                                </td>



                            }

                        } else {
                            return <td className="section-input p-relative">
                                <input type="radio" value={element.info.roomid} onChange={((e) => this.handleCheck(e, i, idj, x, ItemElement, j, element.info.adults, element.info.withbed, element.info.withoutbed, element.info.infants))} name={`element${idj + '-' + j + '-' + index}`} className="radioButton p-absolute" />
                                <label><span>{element.info.room}</span></label>
                            </td>
                        }
                    }
                }
                render_inputs(nights, idx, idj, element, len, j) {
                    let indents = []
                    for (let m = 0; m < nights; m++) {
                        indents.push(<div><input type="hidden" name={`_root.rooms__${idx}.roomids__${j}${len}${m}.roomid`} key={idj} defaultValue={this.state.roomids[idj] || element.info.roomid} />
                            <input type="hidden" name={`_root.rooms__${idx}.roomids__${j}${len}${m}.adultcount`} value={element.info.adults} />
                            <input type="hidden" name={`_root.rooms__${idx}.roomids__${j}${len}${m}.childwithbed`} value={element.info.withbed} />
                            <input type="hidden" name={`_root.rooms__${idx}.roomids__${j}${len}${m}.childwithoutbed`} value={element.info.withoutbed} />
                            <input type="hidden" name={`_root.rooms__${idx}.roomids__${j}${len}${m}.infant`} value={element.info.infants} />
                        </div>)
                    }
                    return indents
                }
                handleCheck = (e, i, idj, x, ItemElement, j, ad, ch1, ch2, inf) => {

                    let value = e.target.value
                    let gid = ItemElement.id
                    let city_index = ItemElement.hotelinfo[0].hotel[j].cityindex
                    let room_index = ItemElement.hotelinfo[0].hotel[j].families[x].roomindex
                    let adcount = ad
                    let chcount1 = ch1
                    let chcount2 = ch2
                    let passsum = parseInt(ch1 + ch2 + ad + inf)
                    // let chcount = parseInt(ch1 + ch2)
                    let infcount = inf
                    let last_adult = 0
                    let last_child1 = 0
                    let last_child2 = 0
                    let last_infant = 0

                    this.setState({
                        chflag: 1,
                        cityindex: city_index,
                        roomindex: room_index,
                        hgid: gid,
                        roomcheck: x

                    });

                    if (!this.state.copy[gid]) {

                        this.state.copy[gid] = {}
                        this.state.copy[gid]["costtable"] = ItemElement.costtable

                    }

                    let familylen = ItemElement.costOptions[j].families[x].roomsOption[i].family.length
                    let extra_count = 0;
                    for (let Flen = 0; Flen < familylen; Flen++) {
                        if (ItemElement.costOptions[j].families[x].roomsOption[i].family[Flen].type == 4)
                            extra_count++
                    }
                    if (this.state.jsonbackup[gid]) {
                        if (this.state.jsonbackup[gid][city_index + "-" + room_index]) {
                            this.state.jsonbackup[gid][city_index + "-" + room_index]["roomname"] = ItemElement.costOptions[j].families[x].roomsOption[i].roomname
                            if (adcount > 0) {
                                last_adult = this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"]
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[extra_count].cost
                            } else if (adcount == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"] = 0
                            }
                            if (chcount1 > 0) {
                                last_child1 = this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"]
                                for (let ctype = adcount; ctype < passsum; ctype++) {
                                    if (this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 1) {
                                        this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                    }
                                }
                            } else if (chcount1 == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = 0
                            }
                            if (chcount2 > 0) {
                                last_child2 = this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"]
                                for (let ctype = adcount; ctype < passsum; ctype++) {
                                    if (this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 3) {
                                        this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                    }
                                }
                            } else if (chcount2 == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = 0
                            }
                            if (infcount > 0) {
                                last_infant = this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"]
                                for (let ctype = adcount; ctype < passsum; ctype++) {
                                    if (this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 0) {
                                        this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                    }
                                }
                            } else if (infcount == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = 0
                            }

                            this.state.jsonbackup[gid][city_index + "-" + room_index]["total_diff"] = ItemElement.costOptions[j].families[x].roomsOption[i].total_diff_cost

                        } else {
                            this.state.jsonbackup[gid][city_index + "-" + room_index] = {}
                            this.state.jsonbackup[gid][city_index + "-" + room_index]["roomname"] = ItemElement.costOptions[j].families[x].roomsOption[i].roomname
                            if (adcount > 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[extra_count].cost
                            } else if (adcount == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"] = 0
                            }
                            if (chcount1 > 0) {
                                for (let ctype = adcount; ctype < passsum; ctype++) {
                                    if (this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 1) {
                                        this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                    }
                                }
                            } else if (chcount1 == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = 0
                            }
                            if (chcount2 > 0) {
                                for (let ctype = adcount; ctype < passsum; ctype++) {
                                    if (this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 3) {
                                        this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                    }
                                }
                            } else if (chcount2 == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = 0
                            }

                            if (infcount > 0) {
                                for (let ctype = adcount; ctype < passsum; ctype++) {
                                    if (this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 0) {
                                        this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                    }
                                }
                            } else if (infcount == 0) {
                                this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = 0
                            }

                            this.state.jsonbackup[gid][city_index + "-" + room_index]["total_diff"] = ItemElement.costOptions[j].families[x].roomsOption[i].total_diff_cost

                        }

                        let copylen = this.state.copy[gid].costtable[room_index].family.length
                        this.state.copy[gid].costtable[room_index].roomname = this.state.jsonbackup[gid][city_index + "-" + room_index]["roomname"]
                        for (let k = 0; k < copylen; k++) {
                            if (this.state.copy[gid].costtable[room_index].family[k].type == 4) {
                                this.state.copy[gid].costtable[room_index].family[k].cost = parseInt(this.state.copy[gid].costtable[room_index].family[k].cost - last_adult + this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"])
                                this.state.copy[gid].costtable[room_index].family[k].title = ItemElement.costOptions[j].families[x].roomsOption[i].family[k].title
                            }
                            if (this.state.copy[gid].costtable[room_index].family[k].type == 2) {
                                this.state.copy[gid].costtable[room_index].family[k].cost = parseInt(this.state.copy[gid].costtable[room_index].family[k].cost - last_adult + this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"])
                                this.state.copy[gid].costtable[room_index].family[k].title = ItemElement.costOptions[j].families[x].roomsOption[i].family[k].title
                            }
                            else if (this.state.copy[gid].costtable[room_index].family[k].type == 1) {
                                this.state.copy[gid].costtable[room_index].family[k].cost = parseInt(this.state.copy[gid].costtable[room_index].family[k].cost - last_child1 + this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"]) || 0
                            }
                            else if (this.state.copy[gid].costtable[room_index].family[k].type == 3) {
                                this.state.copy[gid].costtable[room_index].family[k].cost = parseInt(this.state.copy[gid].costtable[room_index].family[k].cost - last_child2 + this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"]) || 0
                            }
                            else if (this.state.copy[gid].costtable[room_index].family[k].type == 0) {
                                this.state.copy[gid].costtable[room_index].family[k].cost = parseInt(this.state.copy[gid].costtable[room_index].family[k].cost - last_infant + this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"]) || 0
                            }
                        }






                    } else {
                        this.state.jsonbackup[gid] = {}
                        this.state.jsonbackup[gid][city_index + "-" + room_index] = {}
                        this.state.jsonbackup[gid][city_index + "-" + room_index]["roomname"] = ItemElement.costOptions[j].families[x].roomsOption[i].roomname
                        if (adcount > 0) {
                            this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[extra_count].cost
                        } else if (adcount == 0) {
                            this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"] = 0
                        }
                        if (chcount1 > 0) {
                            for (let ctype = adcount; ctype < passsum; ctype++) {
                                if (this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 1) {
                                    this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                }
                            }
                        } else if (chcount1 == 0) {
                            this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] = 0
                        }
                        if (chcount2 > 0) {
                            for (let ctype = adcount; ctype < passsum; ctype++) {
                                if (this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 3) {
                                    this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                }
                            }
                        } else if (chcount2 == 0) {
                            this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] = 0
                        }
                        if (infcount > 0) {
                            for (let ctype = adcount; ctype < passsum; ctype++) {
                                if (this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].type == 0) {
                                    this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = ItemElement.costOptions[j].families[x].roomsOption[i].family[ctype].cost
                                }
                            }
                        } else if (infcount == 0) {
                            this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] = 0
                        }

                        this.state.jsonbackup[gid][city_index + "-" + room_index]["total_diff"] = ItemElement.costOptions[j].families[x].roomsOption[i].total_diff_cost

                        let copylen = this.state.copy[gid].costtable[room_index].family.length
                        this.state.copy[gid].costtable[room_index].roomname = this.state.jsonbackup[gid][city_index + "-" + room_index]["roomname"]
                        for (let k = 0; k < copylen; k++) {
                            if (this.state.copy[gid].costtable[room_index].family[k].type == 4) {
                                this.state.copy[gid].costtable[room_index].family[k].cost += this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"]
                                this.state.copy[gid].costtable[room_index].family[k].title = ItemElement.costOptions[j].families[x].roomsOption[i].family[k].title
                            }
                            else if (this.state.copy[gid].costtable[room_index].family[k].type == 2) {
                                this.state.copy[gid].costtable[room_index].family[k].cost += this.state.jsonbackup[gid][city_index + "-" + room_index]["adult"]
                                this.state.copy[gid].costtable[room_index].family[k].title = ItemElement.costOptions[j].families[x].roomsOption[i].family[k].title
                            }
                            else if (this.state.copy[gid].costtable[room_index].family[k].type == 1) {
                                this.state.copy[gid].costtable[room_index].family[k].cost += this.state.jsonbackup[gid][city_index + "-" + room_index]["child1"] || 0
                            }
                            else if (this.state.copy[gid].costtable[room_index].family[k].type == 3) {
                                this.state.copy[gid].costtable[room_index].family[k].cost += this.state.jsonbackup[gid][city_index + "-" + room_index]["child2"] || 0
                            }
                            else if (this.state.copy[gid].costtable[room_index].family[k].type == 0) {
                                this.state.copy[gid].costtable[room_index].family[k].cost += this.state.jsonbackup[gid][city_index + "-" + room_index]["infant"] || 0
                            }
                        }

                    }
                    this.setState({
                        copy: this.state.copy
                    });


                    this.setState({
                        jsonbackup: this.state.jsonbackup
                    });


                    return this.setState(prevState => ({
                        roomids: { ...prevState.roomids, [idj]: value }
                    }))
                }
                rendervalueAdult(element, i, idx, idj, x) {
                    let info = [##cms.json.header | cms.form.roomSearch##]
                    if (x == 0) {
                        let ad = info.rooms[0].adultcount
                        return ad

                    }
                    else if (x == 1) {
                        let ad = info.rooms[1].adultcount
                        return ad

                    }
                    else if (x == 2) {
                        let ad = info.rooms[2].adultcount
                        return ad

                    }
                    else if (x == 3) {
                        let ad = info.rooms[3].adultcount
                        return ad

                    }
                }
                rendervalueChild(element, i, idx, idj, x) {
                    let info = [##cms.json.header | cms.form.roomSearch##]
                    if (x == 0) {
                        let ch = info.rooms[x].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""
                            let val = ""
                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                ages2 = ages2 + sp[i] + ','
                            }
                            val = val + '' + sp[0] + ',' + ages2
                            val = val.slice(0, -1)
                            return val
                        }
                        else {
                            return sp[0]
                        }

                    }
                    else if (x == 1) {
                        let ch = info.rooms[x].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""
                            let val = ""
                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                ages2 = ages2 + sp[i] + ','
                            }
                            val = val + '' + sp[0] + ',' + ages2
                            val = val.slice(0, -1)
                            return val
                        }
                        else {
                            return sp[0]
                        }

                    }
                    else if (x == 2) {
                        let ch = info.rooms[x].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""
                            let val = ""
                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                ages2 = ages2 + sp[i] + ','
                            }
                            val = val + '' + sp[0] + ',' + ages2
                            val = val.slice(0, -1)
                            return val
                        }
                        else {
                            return sp[0]
                        }

                    }
                    else if (x == 3) {
                        let ch = info.rooms[x].childcountandage
                        let sp = ch.split(",")
                        if (sp[0] > 0) {
                            let age = ""
                            let val = ""
                            let ages2 = ""
                            for (let i = 1; i < sp.length; i++) {
                                ages2 = ages2 + sp[i] + ','
                            }
                            val = val + '' + sp[0] + ',' + ages2
                            val = val.slice(0, -1)
                            return val
                        }
                        else {
                            return sp[0]
                        }

                    }
                }

                rendercosttable(element) {
                    let indents = [];
                    if (this.state.chflag == 0) {
                        let lencost = element.costtable.length
                        for (let i = 0; i < lencost; i++) {
                            indents.push(<div className="details-item">

                                <table className="details-tbl font_13">
                                    <tr>
                                        <th>الغرفة</th>
                                        <th>الركاب - السعر الکلي</th>

                                    </tr>
                                    <tr>
                                        <td>{element.costtable[i].roomname}</td>
                                        <td>{this.renderFamilycost(element.costtable[i], element, i)}</td>
                                    </tr>
                                </table>
                            </div>
                            )
                        }
                        return (
                            indents
                        )
                    } else {
                        let lencost = element.costtable.length
                        for (let i = 0; i < lencost; i++) {
                            indents.push(<div className="details-item">
                                <table className="details-tbl font_13">
                                    <tr>
                                        <th>الغرفة</th>
                                        <th>الركاب - السعر الکلي</th>
                                    </tr>
                                    <tr>
                                        <td>{this.renderroomname(element, i)}</td>
                                        <td>{this.renderFamilycost(this.state.copy[this.state.hgid].costtable[i], element, i)}</td>
                                    </tr>
                                </table>
                            </div>
                            )
                        }
                        return (
                            indents
                        )
                    }
                }
                renderFamilycost(element, item, lenc) {
                    let lenFamilycost = element.family.length
                    let indents = [];
                    for (let i = 0; i < lenFamilycost; i++) {
                        indents.push(<div>
                            <span className="index_row">{element.family[i].title} - </span>
                            {this.rendertablecost2(element.family[i].cost, i, item, lenc)} <span className="font_11 margin-left">{this.renderUnit(item.unit, this.state.state_currency_unit)}</span>
                        </div>)
                    }
                    return (
                        indents
                    )
                }

                renderInsurance(element) {
                    if (element.insuranceinfo !== undefined) {
                        if (element.insuranceinfo == 0) {
                            return ''
                        } else {
                            return <div className="with-50 float-right"><input type="hidden" value={JSON.stringify(element.insuranceinfo)} name="insuranceinfo" /><span className="font_13 question-info">التأمين :</span><span className="font_12">{element.insuranceinfo.insurancename}</span></div>
                        }
                    }

                }
                rendervisa(element) {
                    if (element.visa !== undefined) {
                        let lenvisa = element.visa.length
                        if (lenvisa == 0) {
                            return ''
                        } else {
                            return <div className="with-50 float-left"><span className="font_13 question-info">فيزا :</span><span className="font_12">{element.visa[0].name}</span></div>
                        }
                    }

                }
                renderserviceTour(element) {
                    if (element !== undefined) {
                        return <div className="details-item font-font_13">{this.renderserviceType(element)}{this.renderserviceappropriate(element)}{this.renderservicediff(element)}{this.renderservicejourney(element)}{this.renderservicedesc(element)}</div>
                    }
                }
                renderserviceType(element) {
                    if (element.type == undefined || element.type == '') {
                        return ''
                    } else {
                        let lenserviceType = element.type.length
                        let indents = [<div className="font_13 question-info"><span>نوع الجولة:</span></div>]
                        for (let i = 0; i < lenserviceType; i++) {
                            if (element.type[i].servicename == '' || element.type[i].servicename == undefined) {
                                indents.push('')
                            } else {
                                indents.push(<div className="font_12"> <span>{element.type[i].servicename}</span></div>)
                            }

                        }
                        return (
                            indents
                        )
                    }
                }
                renderserviceappropriate(element) {
                    if (element.appropriate == undefined || element.appropriate == '') {
                        return ''
                    } else {
                        let lenserviceappropriate = element.appropriate.length
                        let indents = [<div className="font_13 question-info"><span>مناسبة ل :</span></div>]
                        for (let i = 0; i < lenserviceappropriate; i++) {
                            if (element.appropriate[i].servicename == '' || element.appropriate[i].servicename == undefined) {
                                indents.push('')
                            } else {
                                indents.push(<div className="font_12"> <span>{element.appropriate[i].servicename}</span></div>)
                            }

                        }
                        return (
                            indents
                        )
                    }
                }
                renderservicediff(element) {
                    if (element.diff == undefined) {
                        return ''
                    } else {
                        let lenservicediff = element.diff.length
                        let indents = [<ul><li className="font_13 question-info">مستوى الصعوبة :</li></ul>]
                        for (let i = 0; i < lenservicediff; i++) {
                            if (element.diff[i].servicename == 'الرجاء اختيار أحد العناصر') {
                                indents.push('')
                            } else {
                                indents.push(<li className="font_12"><span>{element.diff[i].servicename}</span></li>)
                            }

                        }
                        return (
                            indents
                        )
                    }
                }
                renderservicedesc(element) {
                    if (element.description == undefined) {
                        return ''
                    } else {
                        let lenservicedesc = element.description.length
                        let indents = [<ul><li className="font_13 question-info">وصف :</li></ul>]
                        for (let i = 0; i < lenservicedesc; i++) {
                            let text = element.description[i].decs
                            if (text == '') {
                                indents.push('')
                            } else {
                                indents.push(<li className="font_12"><span>{element.description[i].decs} </span></li>)
                            }

                        }
                        return (
                            indents
                        )
                    }
                }
                renderservicejourney(element) {
                    if (element.journey == undefined) {
                        return ''
                    } else {
                        let lenservicejourney = element.journey.length
                        let indents = [<ul><li className="font_13 question-info">برنامج السفر :</li></ul>]
                        for (let i = 0; i < lenservicejourney; i++) {
                            if (element.journey[i].journeytitle == '') {
                                indents.push('')
                            } else {
                                indents.push(<li className="font_12"><span>{element.journey[i].journeytitle} </span><span>{element.journey[i].journeydesc}</span></li>)
                            }
                        }
                        return (
                            indents
                        )
                    }
                }

                renderroomname(item, lenc) {
                    let json = this.state.jsonbackup
                    let copy = this.state.copy
                    let tour = item.id
                    let name = item.costtable[lenc].roomname
                    if (json[tour]) {
                        if (item.id == this.state.hgid) {
                            name = this.state.copy[this.state.hgid].costtable[lenc].roomname

                        } else {
                            name = this.state.copy[tour].costtable[lenc].roomname
                        }

                    } else {
                        name = item.costtable[lenc].roomname
                    }
                    return name
                }
                rendertablecost2(element, i, item, lenc) {
                    let total = element
                    let json = this.state.jsonbackup
                    let copy = this.state.copy
                    let tour = item.id
                    if (json[tour]) {
                        if (item.id == this.state.hgid) {
                            total = element
                        } else {
                            total = this.state.copy[tour].costtable[lenc].family[i].cost
                        }
                    } else {
                        total = item.costtable[lenc].family[i].cost
                    }
                    return new Intl.NumberFormat().format(this.renderTotal(total, this.state.state_currency_cost, this.state.state_floatdigit))

                }
                renderTotal_first(element) {
                    let total = element.totalcostmin
                    let total2 = 0
                    let json = this.state.jsonbackup
                    let tour = element.id
                    if (!json[tour]) {
                        total2 = 0
                    }
                    else {
                        let room = 0
                        for (room in json[tour]) {
                            total2 += json[tour][room]["total_diff"]
                        }
                    }
                    return new Intl.NumberFormat().format(this.renderTotal(total2 + total, this.state.state_currency_cost, this.state.state_floatdigit))

                }
                renderTotal(element, currency_cost, floatdigit) {
                    if (floatdigit == '') {
                        return element * currency_cost;
                    } else {
                        let toString_element = (element * currency_cost).toString();
                        if (floatdigit >= 0) {
                            if (toString_element.indexOf('.') > -1) {
                                let parseFloat_element = parseFloat(toString_element).toFixed(floatdigit).toString();
                                let parseFloat_element_split = parseFloat_element.split('.');
                                if (parseFloat_element_split[1].indexOf('0') > -1) {
                                    return parseFloat(element * currency_cost).toFixed(1).toString();
                                } else {
                                    return parseFloat(element * currency_cost).toFixed(floatdigit).toString();
                                }
                            } else {
                                return parseFloat(element * currency_cost).toFixed(floatdigit).toString();
                            }
                        } else {
                            let multiplier = Math.pow(10, Math.abs(floatdigit));
                            let parseFloat_element = Math.round(toString_element * multiplier) / multiplier;
                            return parseFloat_element;
                        }
                    }
                }
                renderUnit(element, currency_unit) {
                    if (currency_unit == '') {
                        return element;
                    } else {
                        return currency_unit;
                    }

                }
                renderCommission(element) {
                    if (element.commissioncost == 0) {
                        return '';
                    } else {
                        let total = element.totalcostmin
                        let commissionlen = parseInt(element.commissionDetails.length - 1)
                        let com = element.commissionDetails[commissionlen].commission
                        let total2 = 0
                        let json = this.state.jsonbackup
                        let tour = element.id

                        if (!json[tour]) {
                            total2 = 0
                        } else {
                            let room = 0
                            for (room in json[tour]) {
                                total2 += json[tour][room]["total_diff"]
                            }
                        }
                        let finalcommission = 0;
                        let commissioncost = 0;
                        if (typeof com === 'object') {
                            finalcommission = element.commissioncost
                            commissioncost = element.commissioncost
                        } else {
                            finalcommission = parseInt(total2 + total) * com
                            commissioncost = parseInt(total2 + total) * com
                        }

                        let finaltotalcom = parseInt((total2 + total) - commissioncost)
                        return <div class="commission-content"><div className="cost-item"><span className="font_10"> السعر الکلي :</span><span className="item-cost font_12 font-weight">{new Intl.NumberFormat().format(this.renderTotal(total, this.state.state_currency_cost, this.state.state_floatdigit))}</span><span
                            className="font_11 unit">{this.renderUnit(element.unit, this.state.state_currency_unit)}</span></div>
                            <div className="cost-item"><span className="font_10">عمولة
                                :</span><span className="item-cost font_12 font-weight"> {new Intl.NumberFormat().format(this.renderTotal(finalcommission, this.state.state_currency_cost, this.state.state_floatdigit))}</span><span
                                    className="font_11 unit">{this.renderUnit(element.unit, this.state.state_currency_unit)}</span></div>
                            <div className="cost-item"><span className="font_10">المبلغ المستحق
                                :</span><span className="item-cost font_12 font-weight">{new Intl.NumberFormat().format(this.renderTotal(finaltotalcom, this.state.state_currency_cost, this.state.state_floatdigit))}</span><span
                                    className="font_11 unit">{this.renderUnit(element.unit, this.state.state_currency_unit)}</span></div>
                        </div>
                    }
                }

                showAllDetails = (e, i) => {
                    this.setState(prevState => ({
                        visibleAll: { ...prevState.visibleAll, [i]: !prevState.visibleAll[i] },
                        visibleDetails: { ...prevState.visibleDetails, [i]: !prevState.visibleDetails[i] },
                        activeTab_details: { ...prevState.activeTab_details, [i]: !prevState.activeTab_details[i] }
                    }))
                }
                showDetails = (e, i) => {
                    this.setState(prevState => ({
                        visibleDetails: { ...prevState.visibleDetails, [i]: !prevState.visibleDetails[i] },
                        activeTab_details: { ...prevState.activeTab_details, [i]: !prevState.activeTab_details[i] }
                    }))
                    if (this.state.visibleBar[i] == true) {
                        this.setState(prevState => ({
                            visibleBar: { ...prevState.visibleBar, [i]: !prevState.visibleBar[i] },
                            activeTab_bar: { ...prevState.activeTab_bar, [i]: !prevState.activeTab_bar[i] }
                        }))
                    }

                    if (this.state.visibleRule[i] == true) {
                        this.setState(prevState => ({
                            visibleRule: { ...prevState.visibleRule, [i]: !prevState.visibleRule[i] },
                            activeTab_rule: { ...prevState.activeTab_rule, [i]: !prevState.activeTab_rule[i] }
                        }))
                    }
                }

                showBar = (e, i) => {
                    this.setState(prevState => ({
                        visibleBar: { ...prevState.visibleBar, [i]: !prevState.visibleBar[i] },
                        activeTab_bar: { ...prevState.activeTab_bar, [i]: !prevState.activeTab_bar[i] }
                    }))
                    if (this.state.visibleDetails[i] == true) {
                        this.setState(prevState => ({
                            visibleDetails: { ...prevState.visibleDetails, [i]: !prevState.visibleDetails[i] },
                            activeTab_details: { ...prevState.activeTab_details, [i]: !prevState.activeTab_details[i] }
                        }))
                    }

                    if (this.state.visibleRule[i] == true) {
                        this.setState(prevState => ({
                            visibleRule: { ...prevState.visibleRule, [i]: !prevState.visibleRule[i] },
                            activeTab_rule: { ...prevState.activeTab_rule, [i]: !prevState.activeTab_rule[i] }
                        }))
                    }
                }

                showRule = (e, i) => {
                    this.setState(prevState => ({
                        visibleRule: { ...prevState.visibleRule, [i]: !prevState.visibleRule[i] },
                        activeTab_rule: { ...prevState.activeTab_rule, [i]: !prevState.activeTab_rule[i] }
                    }))
                    if (this.state.visibleDetails[i] == true) {
                        this.setState(prevState => ({
                            visibleDetails: { ...prevState.visibleDetails, [i]: !prevState.visibleDetails[i] },
                            activeTab_details: { ...prevState.activeTab_details, [i]: !prevState.activeTab_details[i] }
                        }))
                    }
                    if (this.state.visibleBar[i] == true) {
                        this.setState(prevState => ({
                            visibleBar: { ...prevState.visibleBar, [i]: !prevState.visibleBar[i] },
                            activeTab_bar: { ...prevState.activeTab_bar, [i]: !prevState.activeTab_bar[i] }
                        }))
                    }

                }
                showCostTable = (i) => {
                    this.setState(prevState => ({
                        visibleCostTable: { ...prevState.visibleCostTable, [i]: !prevState.visibleCostTable[i] }
                    }))
                }
                closeCosttable = (i) => {
                    this.setState(prevState => ({
                        visibleCostTable: { ...prevState.visibleCostTable, [i]: !prevState.visibleCostTable[i] }
                    }))
                }
                showTourInfo = (i) => {
                    this.setState(prevState => ({
                        visibleTourInfo: { ...prevState.visibleTourInfo, [i]: !prevState.visibleTourInfo[i] }
                    }))
                }
                closeServices = (i) => {
                    this.setState(prevState => ({
                        visibleTourInfo: { ...prevState.visibleTourInfo, [i]: !prevState.visibleTourInfo[i] }
                    }))
                }

                handleClick(event) {
                    window.scrollTo({
                        top: 0,
                        left: 0,
                        behavior: 'smooth'
                    })
                    this.setState({
                        currentPage: Number(event.target.id)
                    })
                }
                handleReset(event) {
                    let maxPage = this.state.maxPage
                    let len = this.renderLibrary().length
                    let sum = len * maxPage
                    for (let i = 0; i <= sum; i++) {
                        this.setState(prevState => ({
                            visibleDetails: { ...prevState.visibleDetails, [i]: "" },
                            visibleRule: { ...prevState.visibleRule, [i]: "" },
                            visibleBar: { ...prevState.visibleBar, [i]: "" },
                            visibleTourInfo: { ...prevState.visibleTourInfo, [i]: "" },
                            Visible_rooms: { ...prevState.Visible_rooms, [i]: "" },
                            visibleAll: { ...prevState.visibleAll, [i]: "" },
                            visibleCostTable: { ...prevState.visibleCostTable, [i]: "" },
                            visibleDetails: { ...prevState.visibleDetails, [i]: "" },
                            activeTab_details: { ...prevState.activeTab_details, [i]: "" }
                        }))
                        if (this.state.visibleBar[i] == true) {
                            this.setState(prevState => ({
                                visibleBar: { ...prevState.visibleBar, [i]: "" },
                                activeTab_bar: { ...prevState.activeTab_bar, [i]: "" }
                            }))
                        }

                        if (this.state.visibleRule[i] == true) {
                            this.setState(prevState => ({
                                visibleRule: { ...prevState.visibleRule, [i]: "" },
                                activeTab_rule: { ...prevState.activeTab_rule, [i]: "" }
                            }))
                        }
                    }
                }
                localStorage_getCurrency = () => {
                    let getCurrencyObject = localStorage.getItem('currencyObject');
                    let jsonCurrency = JSON.parse(getCurrencyObject);
                    if (jsonCurrency) {
                        return jsonCurrency.currency_unit
                    } else {
                        return '--العمله--'
                    }
                }
                localStorage_expire = () => {
                    const { state_currency_unit, state_currency_cost, state_floatdigit } = this.state
                    let getCurrencyObject = localStorage.getItem('currencyObject');
                    let jsonCurrency = JSON.parse(getCurrencyObject);
                    if (jsonCurrency) {
                        var timer = setInterval(() => {
                            if (new Date().getTime() - jsonCurrency.time >= jsonCurrency.expire) {
                                localStorage.removeItem('currencyObject');
                                document.querySelector(".currency-selected").innerText = '--العمله--';
                                document.querySelector(".currency-selected").setAttribute("data-active", 0);
                                clearInterval(timer);
                                this.setState({
                                    state_currency_unit: "",
                                    state_currency_cost: 1,
                                    state_floatdigit: "",
                                });
                                console.log('localStorage has ex pired');
                            }
                        }, 1000)
                    }
                }

                currency_selected_list = () => {
                    if (document.querySelector(".currency-selected").getAttribute("data-active") == 0) {
                        document.querySelector(".currency-loading").classList.toggle("unvisible");
                        fetch('/Client_Currency_Rate.bc')
                            .then(response => response.text())
                            .then(text => {
                                this.setState({ data_currency: JSON.parse(text.replace(/\'/g, '"')) });
                                document.querySelector(".currency-loading").classList.toggle("unvisible");
                                document.querySelector(".currency-selected").setAttribute("data-active", 1);
                                document.querySelector(".currency-list").classList.toggle("unvisible");
                            }).catch(error => console.error(error))

                    } else {
                        document.querySelector(".currency-list").classList.toggle("unvisible");
                    }

                }
                renderCurrencyRate() {
                    let element = this.state.data_currency;
                    if (!element) return null;
                    return <div className="currency-list unvisible float-left font_12 p-absolute"><ul>{this.renderRate(element.rate, element.floatdigit)}</ul></div>
                }
                renderRate(element, floatdigit) {
                    if (element !== undefined) {
                        let indents = [];
                        for (let i = 0; i < element.length; i++) {
                            indents.push(<li onClick={e => this.select_currency_list(e, element[i], floatdigit)}>{element[i].rate_unit}</li>)
                        }
                        return (
                            indents
                        )
                    }
                }
                select_currency_list = (e, element, floatdigit) => {
                    if (element.rate_unit !== "IRR") {
                        if (floatdigit < 0) {
                            this.setState({
                                state_floatdigit: 2,
                            })
                        } else {
                            this.setState({
                                state_floatdigit: floatdigit,
                            })
                        }
                    } else {
                        this.setState({
                            state_floatdigit: floatdigit,

                        })
                    }
                    this.setState({
                        state_currency_unit: element.rate_unit,
                        state_currency_cost: element.rate_cost,
                    });
                    document.querySelector(".currency-list").classList.toggle("unvisible");
                    document.querySelector(".currency-selected").innerText = element.rate_unit;
                    localStorage_setCurrency(element.rate_unit, element.rate_cost, floatdigit) //-----THIS FUNCTION IS WRITTEN IN CORE.MIN.JS

                }
            }
            ReactDOM.render(<App />, document.getElementById('app'))
        }


    </script>
</body>

</html>