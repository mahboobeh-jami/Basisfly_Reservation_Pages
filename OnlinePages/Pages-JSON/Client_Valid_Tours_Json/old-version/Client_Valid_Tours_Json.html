<basis core="group" name="check-lang" if="'[##cms.form.clid|(1)##]' <> '1'">
    <basis core="group" name="hasNot-rkey" if="'[##cms.cookie.rkey##]' = ''">
        <basis core="external.fly.ws" source="cmsDbService2" procedurename="dbsource" name="db">
            <member name="valid_tours" method="tour_final" query='{
                "name": "db",
                "mid": "20",
                "member": [
                    {
                        "type": "list",
                        "name": "q",
                        "request": "valid_tours",
                        "cities": "[##cms.form.tourname##]",
                        "begindate": "[##cms.form.fdate##]",
                        "enddate": "[##cms.form.tdate##]",
                        "trackingNo": "[##cms.cookie.trackingid##]",
                        "rooms": [##cms.form.rooms##],
                         "userid": "0",
                         "lid": "[##cms.form.clid|(1)##]",
                        "dmnid": [##cms.cms.domainid##],
                        "schemaid": "249"
                    }
                ]
            }' preview="" />
        </basis>
        [##db.valid_tours.result##]


    </basis>
    <basis core="group" name="has-rkey" if="'[##cms.cookie.rkey##]' <> ''">
        <basis core="dbsource" source="trust_login8" mid="24" name="db" lid="1" rkey="[##cms.cookie.rkey##]">
            <member name="checkrkey" type="scalar" request="userid" preview="" />
        </basis>
        <basis core="external.fly.ws" source="cmsDbService2" procedurename="dbsource" name="db">
            <member name="valid_tours" method="tour_final" query='{
                "name": "db",
                "mid": "20",
                "member": [
                    {
                        "type": "list",
                        "name": "q",
                        "request": "valid_tours",
                        "cities": "[##cms.form.tourname##]",
                        "begindate": "[##cms.form.fdate##]",
                        "enddate": "[##cms.form.tdate##]",
                        "trackingNo": "[##cms.cookie.trackingid##]",
                        "rooms": [##cms.form.rooms##],
                         "userid": "[##db.checkrkey.userid##]",
                         "lid": "[##cms.form.clid|(1)##]",
                        "dmnid": [##cms.cms.domainid##],
                        "schemaid": "249"
                    }
                ]
            }' preview="" />
        </basis>
        [##db.valid_tours.result##]

    </basis>
</basis>
<basis core="group" name="check-lang" if="'[##cms.form.clid|(1)##]' = '1'">
    <basis core="group" name="hasNot-rkey" if="'[##cms.cookie.rkey##]' = ''">
        <basis core="external.fly.ws" source="cmsDbService2" procedurename="dbsource" name="db">
            <member name="valid_tours" method="tour_final" query='{
                "name": "db",
                "mid": "20",
                "member": [
                    {
                        "type": "list",
                        "name": "q",
                        "request": "valid_tours",
                        "cities": "[##cms.form.tourname##]",
                        "begindate": "[##cms.form.fdate##]",
                        "enddate": "[##cms.form.tdate##]",
                        "trackingNo": "[##cms.cookie.trackingid##]",
                        "rooms": [##cms.form.rooms##],
                         "userid": "0",
                         "lid": "[##cms.form.clid|(1)##]",
                        "dmnid": [##cms.cms.domainid##],
                        "schemaid": "249"
                    }
                ]
            }' preview="" />
        </basis>
        [##db.valid_tours.result##]


    </basis>
    <basis core="group" name="has-rkey" if="'[##cms.cookie.rkey##]' <> ''">
        <basis core="call" file="Client_CheckRkey.inc"></basis>
        <basis core="external.fly.ws" source="cmsDbService2" procedurename="dbsource" name="db">
            <member name="valid_tours" method="tour_final" query='{
                "name": "db",
                "mid": "20",
                "member": [
                    {
                        "type": "list",
                        "name": "q",
                        "request": "valid_tours",
                        "cities": "[##cms.form.tourname##]",
                        "begindate": "[##cms.form.fdate##]",
                        "enddate": "[##cms.form.tdate##]",
                        "trackingNo": "[##cms.cookie.trackingid##]",
                        "rooms": [##cms.form.rooms##],
                         "userid": "[##db.checkrkey.userid##]",
                         "lid": "[##cms.form.clid|(1)##]",
                        "dmnid": [##cms.cms.domainid##],
                        "schemaid": "249"
                    }
                ]
            }' preview="" />
        </basis>
        [##db.valid_tours.result##]

    </basis>
</basis>