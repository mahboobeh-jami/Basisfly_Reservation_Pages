<span class="siteurl" style="visibility:hidden"><p>[##site.address.domain##]</p></span>
<basis core="dbsource" source="hosting" name="site">
    <member name="address" type="list" request="siteaddress" />
</basis>
<basis core="group" name="check-version" if="'[##cms.cms.server_main_version##]' = '4'">
<basis core="call" lid="2" file="Client_CheckRkey.inc"></basis> <!-- updated login -->


<basis core="group" if="[##db.checkrkey.userid##]=0  ">
  <!DOCTYPE html>
  <html>
      <head>
          <meta charset="UTF-8"/>
          <title>Invoice</title>
      </head>
      
      <body>
          <p style="text-align:center">You are not allowed to access this page</p>
          <style type="text/css">
              @font-face{
                  font-family:'IRANSansWeb';
                  src:url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.eot');src:local('?'),
                  url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.woff2') format("woff"),
                  url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.ttf') format("truetype"),
                  url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.otf') format("otf");
                  font-weight:400;font-style:normal
              }
              body{font-family:IRANSansWeb;font-size:16px;color:#3b3838;}
          </style>
      </body>
  </html>
</basis>

<basis core="group" if="[##db.checkrkey.userid##]<>0">
  <basis core="external.fly.ws" source="cmsDbService2" name="db" procedurename="dbsource" > 
      <member method="cms"
      name="InvoiceView" 
      query='
      { 
          "name": "db", 
          "mid": "20", 
          "member":
          [
              { 
                  "name": "q", 
                  "type":"list", 
                  "request":"invoiceview", 
                  "id":"[##cms.query.id##]",
                  "lid":"2"

              }
          ] 
      }'/> 
  </basis>

  <basis core="group" name="Delay_2">
      <basis core='inlinesource' name='db'>
          <member name="InvoiceView_Tree" format="json"preview="">{"root":[##db.InvoiceView.result##]}</member>
          <member 
              name='InvoiceOwnerid'  
              format="json" 
              postsql="select value from [db.InvoiceOwnerid] where Field = 'ownerid'"
              preview=""> 
              {"root":[##db.InvoiceView.result##]}
          </member>

          <member 
              name='InvoiceOpen'  
              format="json" 
              postsql="select value from [db.InvoiceOpen] where Field = 'open'"
              preview=""> 
              {"root":[##db.InvoiceView.result##]}
          </member>       

          <member 
              name='InvoiceType'  
              format="json" 
              postsql="select value from [db.InvoiceType] where Field = 'invoicetype'"
              preview=""> 
              {"root":[##db.InvoiceView.result##]}
          </member>           
      </basis>

      <basis core="dbsource" source="basiscore" mid="5" name="db" lid="2" usedforid="[##db.InvoiceOwnerid.Value##]" > 
      <member type="view" name="AgancyName" postsql="select Answer from [db.AgancyName] where typeid=150"/></basis>

      <html>
          <head>
              <title>Invoice</title>
              <meta charset="utf-8"> 
          </head>

          <body>
              <div class="Panel_pdf">
                  <div class="pdf_title">
                      <basis:00 core="group" if="[##db.InvoiceOpen.Value|(0)##]=0">
                      <basis:02 core="group" if="[##cms.query.status|(0)##]=0">
                      
                      <div>Contract</basis:02>
                      <basis:03 core="group" if="[##cms.query.status|(0)##]=1">
                      
                      <div>Pre-contract</basis:03>
                      </basis:00>
                      <basis:01 core="group" if="[##db.InvoiceOpen.Value|(0)##]=1"><div>Pre-contract</basis:01>
                        Providing travel and tourism services </div>
                  </div>
                  <div class="pdf_description">
                      <div><span>Number : </span>[##cms.query.id##]</div>                  
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null"> 
                          <face filter="Field in ('invoiceDate','account','products','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('invoiceDetails')">@child</face>
                          <face filter="Field in ('counterName')"><div>Counter name : <span> @value</span> </div></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('travelDate','invoiceDetails','products','creditPay')"></face>
                          <face filter="Field in ('invoiceDate')">
                              <div class="invoice_Details">Date of contract registration : @child</div>
                          </face>

                          <face filter="Field in ('mstring')"><span>@value</span></face>
                   
                          <face filter="type in ('Array','object')">@Child</face>    
                      </basis>
                          
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('baggage')"></face>
                          <face filter="Field in ('title')"><div style="direction:ltr;"><span>Type of service : </span> @value</div></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                
                      </basis>
                  </div>

                  <div class="pdf_description">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null"> 
                          <face filter="Field in ('invoiceDetails','invoiceDate','products','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('account','person')">@child</face>

                          <face filter="Field in ('firstname')">This contract is between Ms. / Mr. @value </face>
                          <face filter="Field in ('lastname')">@value </face>
                          <face filter="Field in ('address')">to the address ( @value ) </face>
                          <face filter="Field in ('tel')"> Has a landline phone number <span class="pdf_direct"> ( @value ) </span></face>
                          <face filter="Field in ('mobile')">and mobile number<span class="pdf_direct">( @value ) </span></face>

                          <face filter="Field in ('agencyname')">This contract is between @value</face>
                          <face filter="Field in ('agencymanegername')"> With management @value</face>
                          <face filter="Field in ('agencytell')">To the contact number <span class="pdf_direct"> ( @value ) </span></face>

                          <face filter="type in ('Array','object')">@Child</face>                                                
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null"> 
                          <face filter="Field in ('invoiceDate','account','products','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('invoiceDetails')">@child</face>
                          <face filter="Field in ('persons')"> 
                            Individually or on behalf of the following persons by a total of @value, hereinafter referred to as "tourists", on the one hand and the office <strong>[##db.AgancyName.Answer##]</strong>Hereinafter referred to as "broker", as <strong> online shopping </strong>  Has been concluded.
                          </face>

                          <face filter="type in ('Array','object')">@Child</face>                                                
                      </basis>
                  </div>

            

                  <!-- type == 2 -->
                  <basis:2 core="group" if="[##db.InvoiceType.Value##] in ('2','4','6')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>FLIGHT INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>AIRLINE</span></th>
                                          <th><span>DEPARTURE AIRPORT</span></th>
                                          <th><span>DESTINATION AIRPORT</span></th>
                                          <th><span>FLIGHT NO</span></th>
                                          <th><span>FLIGHT CLASS</span></th>                                                      
                                      </tr>
                                  </thead>

                                  @child
                              </table>
                          </face>

                          <face filter="Field in ('hotel','transfer','insurance')"></face>
                          <face filter="Field in ('departure') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                          Departure Information 
                                      </td>
                                  </tr>
                                  @child  
                              </tbody>                 
                          </face> 

                          <face filter="Field in ('return') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                          Return Information
                                      </td>
                                  </tr>
                                  @child
                              </tbody>
                          </face>  

                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route') and type in ('scalar.String')"><td style="font-family:IRANSansWeb">@value</td></face>
                          <face filter="Field in ('etime','atime','class','routecode') and type in ('scalar.String')"><td>@value</td></face>
                          <face filter="Field in ('airline')"><td>@value</td></face>
                                      
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                         

                          <face filter="Field in ('startairport','endairport')"><td style="font-family:IRANSansWeb">@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>      
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:2>

                  <!-- type == 3 -->
                  <basis:3 core="group" if="[##db.InvoiceType.Value##] in ('3','4','6','10')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>LIST OF ROOMS</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>HOTEL NAME</span></th>
                                          <th><span>HOTEL GRADE</span></th>
                                          <th><span>CITY</span></th>
                                          <th><span>ROOM</span></th>
                                          <th><span>ROOM TYPE</span></th>
                                          <th><span>CHECK IN</span></th>
                                          <th><span>CHECK OUT</span></th>
                                          <th><span>PASSENGERS</span></th>
                                          <th><span>SERVICES</span></th>                                                    
                                      </tr>
                                  </thead>

                                  @child
                              </table>
                          </face>
                          
                          <face filter="Field in ('departure','return','transfer','insurance','transfers','services')"></face>
                          <face filter="Field in ('hotel') and type in ('array')">
                              <tbody>
                                  <tr><td colspan="9" style="background:#FFF4E3;text-align:left;padding:15px 0"></td></tr>
                                  @child 
                              </tbody>                  
                          </face>
                          
                          <face filter="Field in ('room')"><tr>@Child</tr></face>
                          <face filter="Field in ('hotelName','cityName','roomNumber','roomType','service')"><td>@value</td></face>                
                          <face filter="Field in ('hotelStar')"><td>@value</td></face>

                          <face filter="Field in ('fromDate','toDate','passengers')"><td>@child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                      

                          <face filter="Field in ('passengersRoom')"><td>@child</td></face>
                          <face filter="Field in ('adult')"><span class="passengers">@value Adult</span></face>
                          <face filter="Field in ('child Withbed') and value <> '0'"><span class="passengers">@value Chils (WB)</span></face>
                          <face filter="Field in ('child Withoutbed') and value <> '0'"><span class="passengers">@value Child (WOB)</span></face>
                          <face filter="Field in ('infant') and value <> '0'"><span class="passengers">@value Infant</span></face>
                          <face filter="Field in ('extra Adult') and value <> '0'"><span class="passengers">@value Extra Adult</span></face>
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:3>

                    <basis:333 core="group" if="'[##db.InvoiceType.Value##]' in ('3','6')">
                        <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                            <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>             
                            <face filter="Field in ('products')">
                               @child
                            </face>

                            <face filter="Field in ('departure','return','transfer','insurance','hotel','transfers')"></face>
                            <face filter="Field in ('services') and type in ('array') and value <> '[]'">
                                 <table class="invoice_tbl product_tbl">
                                    <caption class="invoice_caption"><p>service Information</p></caption>
                                    <thead>
                                        <tr>            
                                           
                                            <td>passengerName</td>
                                             <td>serviceName</td>
                                              <td>webservice</td>
                                            <td>totalPrice</td>
                                            <td>unit</td>
                                                                                                
                                        </tr>
                                    </thead>

                                    <tbody class="invoice_tbody"> @child</tbody>
                                </table>              
                            </face>
                            
                            <face filter="Field in ('service')"><tr>@Child</tr></face>
                            <face filter="Field in ('service_passengerlist')"><td>@Child</td></face>
                            <face filter="Field in ('servicename')"><td>@value</td></face>
                            <face filter="Field in ('webservices')"><td>@child</td></face>
                            <face filter="Field in ('webservice')">@value</face>
                            <face filter="Field in ('refnumber')">/@value</face>
                            <face filter="Field in ('servicecost')"><td>@value</td></face>
                            <face filter="Field in ('serviceunit')"><td>@value</td></face>
                            <face filter="Field in ('firstname')"><div><span>@value-</span></face>
                            <face filter="Field in ('lastname')"><span>@value</span></div></face>

                                       
                            <face filter="Field in ('cancel') and value ='1'">
                               
                                    <input type="hidden" name="" class="canceli" value="1">
                            </face>
                            <face filter="Field in ('cancel') and value ='0'">
                              
                                    <input type="hidden" name="" class="canceli" value="0">
                            </face>   

                            <face filter="Field in ('error') and value ='1'">
                                  <td class="Webervice_Refnumber">
                                    <div>ناموفق</div>
                                    <div>
                                        <a href="/reservation/invoice/Get_Refnumber.bc?id=[##cms.form.id##]&type=3&clear=[##cms.form.clear##]" class="Webervice_Link" title="صدور هتل">
                                            صدور هتل
                                            <i class="fa fa-external-link-square-alt"></i>
                                        </a>
                                    </div>
                                </td>
                            </face>                
                        

                            <face filter="type in ('Array','object')">@Child</face>                                                     
                        </basis>

                        <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                            <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>             
                            <face filter="Field in ('products')">
                               @child
                            </face>

                            <face filter="Field in ('departure','return','transfer','insurance','hotel','services')"></face>
                            <face filter="Field in ('transfers')">
                                 <table class="invoice_tbl product_tbl">
                                    <caption class="invoice_caption"><p>transfer Information</p></caption>
                                    <thead>
                                        <tr>            
                                           
                                            <td>serviceName</td>
                                             <td>transferName</td>
                                            <td>typeTransfer</td>
                                            <td>airport</td>

                                            <td>departureDate</td>
                                            <td>returnDate</td>
                                            <td>departureRoutecode</td>
                                            <td>returnRoutecode</td>

                                            <td>departureHour</td>
                                            <td>returnHour</td>
                                             <td>webservice</td>
                                             <td>totalPrice</td>
                                              <td>unit</td>
                                                                                                
                                        </tr>
                                    </thead>

                                    <tbody class="invoice_tbody"> <tr>@Child</tr></tbody>
                                </table>              
                            </face>
                            
                            
                            <face filter="Field in ('t_servicename')"><td>@value</td></face>
                            <face filter="Field in ('transfername')"><td>@value</td></face>
                            <face filter="Field in ('routename')"><td>@value</td></face>
                            <face filter="Field in ('airport')"><td>@value</td></face>
                            <face filter="Field in ('departure_Date')"><td>@value</td></face>
                            <face filter="Field in ('return_Date')"><td>@value</td></face>
                            <face filter="Field in ('departure_routecode')"><td>@value</td></face>
                            <face filter="Field in ('return_routecode')"><td>@value</td></face>
                            <face filter="Field in ('departure_hour')"><td>@value</td></face>
                            <face filter="Field in ('return_hour')"><td>@value</td></face>
                            <face filter="Field in ('transfercost')"><td>@value</td></face>
                            <face filter="Field in ('transferunit')"><td>@value</td></face>
                             <face filter="Field in ('webservices')"><td>@child</td></face>
                            <face filter="Field in ('webservice')">@value</face>
                            <face filter="Field in ('refnumber')">/@value</face>


                                       
                            <face filter="Field in ('cancel') and value ='1'">
                               
                                    <input type="hidden" name="" class="canceli" value="1">
                            </face>
                            <face filter="Field in ('cancel') and value ='0'">
                              
                                    <input type="hidden" name="" class="canceli" value="0">
                            </face>   

                            <face filter="Field in ('error') and value ='1'">
                                  <td class="Webervice_Refnumber">
                                    <div>ناموفق</div>
                                    <div>
                                        <a href="/reservation/invoice/Get_Refnumber.bc?id=[##cms.form.id##]&type=3&clear=[##cms.form.clear##]" class="Webervice_Link" title="صدور هتل">
                                            صدور هتل
                                            <i class="fa fa-external-link-square-alt"></i>
                                        </a>
                                    </div>
                                </td>
                            </face> 
                            <face filter="type in ('Array','object')">@Child</face>                                                     
                        </basis>

                    </basis:333>


                  <!-- type == 4 -->
                  <basis:4 core="group" if="[##db.InvoiceType.Value##] in ('4')">
                      <!-- city Transfer in tour -->
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('transfer') and value <> '[]'">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>INTERURBAN TRANSFER INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>AIRLINE</span></th>
                                          <th><span>DEPARTURE AIRPORT</span></th>
                                          <th><span>DESTINATION AIRPORT</span></th>
                                          <th><span>FLIGHT NO</span></th>
                                          <th><span>FLIGHT CLASS</span></th>                                                       
                                      </tr>
                                  </thead>

                                  <tbody>@child</tbody>
                              </table>
                          </face>
                          
                          <face filter="Field in ('departure','return','hotels','insurance')"></face>  
                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route') and type in ('scalar.String')"><td style="font-family:IRANSansWeb">@value</td></face>
                          <face filter="Field in ('etime','atime','class','routecode') and type in ('scalar.String')"><td>@value</td></face>
                          <face filter="Field in ('airline')"><td>@value</td></face>
                          
                                      
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                        

                          <face filter="Field in ('startairport','endairport')"><td>@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>     
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>                                  

                      <!-- insurance in tour -->            
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDetails','invoiceDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face> 
                          <face filter="Field in ('products')">@Child</face>                                     
                          <face filter="Field in ('insurance') and value <> '[]'">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"> <span>INSURANCE INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>COUNTRY</span></th>
                                          <th><span>INSURANCE TYPE</span></th>
                                          <th><span>INSURANCE COMPANY</span></th>                                                  
                                      </tr>
                                  </thead>

                                  <tbody><tr>@child</tr></tbody>
                              </table>
                          </face>

                          <face filter="Field in ('insuranceCountry','insuranceName','insuranceProvider')"><td style="font-family:IRANSansWeb;">@value</td></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>

                      <!-- tourDetails in tour -->
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate')"></face> 
                          <face filter="Field in ('products')">@Child</face>                                     
                          <face filter="Field in ('tourDetails') and value <> '{}'">
                              <table class="invoice_tbl tourDetails">
                                  <colgroup>
                                      <col width="20%"></col>
                                      <col width="80%"></col>
                                  </colgroup>

                                  <caption class="invoice_caption"> <span>TOUR INFORMATION </span></caption>
                                  <tbody>@child</tbody>
                              </table>
                          </face>

                          <face filter="Field in ('type') and type in ('array')">
                              <tr>
                                  <td><span>TOUR TYPE</span></td>
                                  <td>@child</td>
                              </tr>
                          </face> 

                          <face filter="Field in ('appropriate') and type in ('array')">
                              <tr>
                                  <td><span>SUITABLE FOR</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('diff') and type in ('array')">
                              <tr>
                                  <td><span>HARDNESS LEVEL</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('tool') and type in ('array')">
                              <tr>
                                  <td><span>REQUIRED REQUIREMENTS</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('service11') and type in ('array')">
                              <tr>
                                  <td><span>FREE SERVICES</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('journey') and type in ('array')">
                              <tr>
                                  <td><span>ITINERARY</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('description') and type in ('array')">
                              <tr>
                                  <td><span>DESCRIPTION</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('servicename','decs')"><span class="serviceName">@value</span></face>
                          <face filter="Field in ('journeytitle')"><span class="serviceName">@value : </face>
                          <face filter="Field in ('journeydesc')"> @value</span></face>
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:4>

                  <!-- type == 5 -->
                  <basis:5 core="group" if="[##db.InvoiceType.Value##] in ('5','6')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">@Child</face>                                     
                          <face filter="Field in ('insurance')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>INSURANCE INFORMATION</span></caption>
                                  <thead>
                                      <tr> 
                                          <th><span>COUNTRY</span></th>
                                          <th><span>INSURANCE NAME</span></th>
                                          <th><span>PERIOD OF TIME</span></th>
                                          <th><span>INSURANCE COMPANY</span></th>             
                                                 
                                      </tr>
                                  </thead>

                                  <tbody><tr>@child</tr></tbody>
                              </table>
                          </face>

                          <face filter="Field in ('departure','return','hotel')"></face>
                          <face filter="Field in ('country','name','Provider')"><td style="font-family:IRANSansWeb">@value</td></face>    
                          <face filter="Field in ('duration') and type in ('object')"><td style="direction:ltr;font-family:IRANSansWeb">@child</td></face>    
                          <face filter="Field in ('duration') and type in ('Scalar.String')"><span style="margin:0 2px"> @value</span></face>    
                          <face filter="Field in ('durationtype') and type in ('Scalar.String')"><span> @value</span></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:5>

                  <!-- products type == 8 -->
                  <basis:6 core="group" if="[##db.InvoiceType.Value##] in ('8')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>ONE-WAY TRAIN INFORMATION</span></caption>
                                  <thead>
                                      <tr> 
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>COMAPANY</span></th>
                                          <th><span>DEPARTURE STATION</span></th>
                                          <th><span>DESTINATION STATION</span></th>
                                          <th><span>TRAIN NO</span></th>
                                          <th><span>TRAIN CLASS</span></th>              
                                      </tr>
                                  </thead>

                                  <tbody>@child</tbody>
                              </table>
                          </face>
                          
                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route','etime','atime','class','routecode') and type in ('scalar.String')">
                              <td style="direction:ltr">@value</td>
                          </face>

                          <face filter="Field in ('trainid')"><td>@value</td></face>
                                      
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                   

                          <face filter="Field in ('startairport','endairport')"><td>@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>      
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:6>

                  <!-- products type == 9 -->
                  <basis:7 core="group" if="'[##db.InvoiceType.Value##]' in ('9')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"> <span>ROUND-TRIP TRAIN INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>COMAPANY</span></th>
                                          <th><span>DEPARTURE STATION</span></th>
                                          <th><span>DESTINATION STATION</span></th>
                                          <th><span>TRAIN NO</span></th>
                                          <th><span>TRAIN CLASS</span></th>                                                     
                                      </tr>
                                  </thead>

                                  @child
                              </table>
                          </face>

                          <face filter="Field in ('hotel','transfer','insurance')"></face>
                          <face filter="Field in ('departure') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                          Departure Information
                                      </td>
                                  </tr>
                                  @child  
                              </tbody>                 
                          </face> 

                          <face filter="Field in ('return') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                           Return Information 
                                      </td>
                                  </tr>
                                  @child
                              </tbody>
                          </face>   

                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route','etime','atime','class','routecode') and type in ('scalar.String')"><td style="direction:ltr">@value</td></face>
                          <face filter="Field in ('trainid')"><td>@value</td></face>
                                  
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                       

                          <face filter="Field in ('startairport','endairport')"><td>@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>       
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:7>
                        <!-- passengesr ########################################################################################### -->
                        <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">   
                            <face filter="Field in ('invoiceDetails','invoiceDate','products','account','priceDetails','baggages','bill','creditPay','passengersvisa')"></face>
                            <face filter="Field in ('passengers')">
                                <table class="invoice_tbl">
                                    <caption class="invoice_caption"><span>List of passengers</span> / <span>PASSENGERS INFORMATION</span></caption>
                                    <thead>
                                        <tr>
                                            <th><span>NAME</span></th>
                                            <th><span>SURNAME</span></th>
                                            <th><span>DATE OF BIRTH</span></th>
                                            <th><span>NATIONAL CODE</span></th>
                                            <th><span>PASSPORT NO</span></th>
                                            <th><span>EXPIRATION DATE OF PASSPORT</span></th>
                                            <th><span>GENDER</span></th>
                                            <th><span>AGE RANG</span></th>
                                        </tr>
                                    </thead>
                                    <tbody class="invoice_tbody">@Child</tbody>
                                </table>
                            </face>       
      
                            <face filter="Field in ('passengerinfo')"><tr>@child</tr></face> 
                            <face filter="Field in ('firstname','lastname','nationalcode','passportcode','passportexpiration')"><td>@value</td></face>        
      
                            <face filter="Field in ('birthdate') and type in ('object')"><td>@child</td></face>
                            <face filter="Field in ('M_birthdate') and type in ('Scalar.String') and value not in ('-')"><p>@value</p></face>
                         
      
                            <face filter="Field in ('M_birthdate') and type in ('Scalar.String') and value in ('-')"><p></p></face>
                         
      
                            <face filter="Field in ('gender') and value = '0'"><td>Female</td></face>
                            <face filter="Field in ('gender') and value = '1'"><td>Male</td></face>
                            <face filter="Field in ('type') and value = '0'"><td style="direction: ltr;">Infant</td></face>
                            <face filter="Field in ('type') and value = '1'"><td style="direction: ltr;">Child</td></face>
                            <face filter="Field in ('type') and value = '2'"><td style="direction: ltr;">Adult</td></face>
                            <face filter="Field in ('type') and value = '3'"><td style="direction: ltr;">Child</td></face>
                            <face filter="Field in ('type') and value = '4'"><td style="direction: ltr;">Adult|Ext </td></face>
                            <face filter="type in ('Array','object')">@Child</face>                                                
                        </basis>
      
                        <!-- products ############################################################################################# -->     
                        <!-- type == 1 -->
                        <basis:1 core="group" if="[##db.InvoiceType.Value##] in ('1')">
                            <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                                <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                                <face filter="Field in ('products')">
                                    <table class="invoice_tbl">
                                        <caption class="invoice_caption"><span>FLIGHT INFORMATION</span></caption>
                                        <thead>
                                            <tr>            
                                                <th><span>FROM - TO</span></th>
                                                <th><span>DATE</span></th>
                                                <th><span>EXit TIME</span></th>
                                                <th><span>ARRIVAL TIME</span></th>
                                                <th><span>AIRLINE</span></th>
                                                <th><span>DEPARTURE AIRPORT</span></th>
                                                <th><span>DESTINATION AIRPORT</span></th>
                                                <th><span>FLIGHT NO</span></th>
                                                <th><span>FLIGHT CLASS</span></th>                                                    
                                            </tr>
                                        </thead>
      
                                        <tbody>@child</tbody>
                                    </table>
                                </face>
                                                                        
                                <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                                <face filter="Field in ('route') and type in ('scalar.String')"><td style="font-family:IRANSansWeb;">@value</td></face>
                                <face filter="Field in ('etime','atime','class','routecode') and type in ('scalar.String')"><td>@value</td></face>
                                
                                <face filter="Field in ('airline')"><td>@value</td></face>                                      
                                <face filter="Field in ('routeDate')"><td>@Child</td></face>
                                <face filter="Field in ('mstring')"><div>@value</div></face>
                      
      
                                <face filter="Field in ('startairport','endairport')"><td style="font-family:IRANSansWeb;">@Child</td></face>
                                <face filter="Field in ('airport')"><div>@value</div></face>
                                <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                                <face filter="Field in ('shortname')">@value | </face>           
                                <face filter="Field in ('city')">@value</face>      
                                <face filter="type in ('Array','object')">@Child</face>                                                     
                            </basis>
                        </basis:1>

                  <!-- price Details ######################################################################################## -->
                  <!-- type == 1,2,5,8,9 -->
                  <basis:8 core="group" if="[##db.InvoiceType.Value##] in ('1','2','5','8','9')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>     
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p><span>COST TABLE BY PASSENGERS</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                          <face filter="Field in ('adult')  and type in ('Object')">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child')  and type in ('Object')">
                              <tr>
                                  <td>Child</td>
                                  @Child
                              </tr>
                          </face>             

                          <face filter="Field in ('infant') and type in ('Object')">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('perperson','total')"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>
                  </basis:8>

                  <!-- type == 3 -->
                  <basis:9 core="group" if="[##db.InvoiceType.Value##] in ('3')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>        
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl hidden">
                                  <caption class="invoice_caption"><p><span>COST TABLE BY PASSENGERS - ROOM</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>ROOM</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST(FOR EACH PASSENGER)</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  @Child
                              </table>
                          </face>           
                          
                          <face filter="Field in ('room')"><tbody class="invoice_tbody Room_priceDetails">@Child</tbody></face>

                          <face filter="Field in ('adult')">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child Withbed')">
                              <tr>
                                  <td>Child (WB)</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('child Withoutbed')">
                              <tr>
                                  <td>Child (WOB)</td>
                                  @Child
                              </tr>
                          </face>                

                          <face filter="Field in ('infant')">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('extra Adult')">
                              <tr>
                                  <td>Extra Adult</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('rooms')">
                              <tr>
                                  <td>-</td>
                                  @Child
                              </tr>
                          </face>
                  
                          <face filter="Field in ('roomIndex','perperson','total') and value = ''"><td>-</td></face>
                          <face filter="Field in ('roomIndex','perperson','total') and value <> ''"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>           
                      </basis>
                  </basis:9>

                  <!-- type == 4 -->
                  <basis:10 core="group" if="[##db.InvoiceType.Value##] in ('4','10')">
                      <br><br>
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>        
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p> <span>COST TABLE BY PASSENGERS - ROOM</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>ROOM</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  @Child
                              </table>
                          </face>           
                          
                          <face filter="Field in ('room')"><tbody class="invoice_tbody Room_priceDetails">@Child</tbody></face>

                          <face filter="Field in ('adult') and type = 'object'">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child Withbed') and type = 'object'">
                              <tr>
                                  <td>Child (WB)</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('child Withoutbed') and type = 'object'">
                              <tr>
                                  <td>Child (WOB)</td>
                                  @Child
                              </tr>
                          </face>                

                          <face filter="Field in ('infant') and type = 'object'">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('extra Adult') and type = 'object'">
                              <tr>
                                  <td>Extra Adult</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('rooms')">
                              <tr>
                                  <td>-</td>
                                  @Child
                              </tr>
                          </face>
                  
                          <face filter="Field in ('roomIndex','perperson','total') and value = ''"><td>-</td></face>
                          <face filter="Field in ('roomIndex','perperson','total') and value <> ''"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>           
                      </basis>
                  </basis:10>

                  <!-- type == 6 -->
                  <basis:11 core="group" if="[##db.InvoiceType.Value##] in ('6')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDetails','invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>        

                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"> <span>COST TABLE BY PRODUCT</span></caption>
                                  <thead>
                                      <tr>
                                          <th><span>FLIGHT</span></th>
                                          <th><span>HOTEL</span></th>
                                          <th><span>INSURANCE</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody "><tr>@Child</tr></tbody>
                              </table>
                          </face>           
                               
                          <face filter="Field in ('flight','hotel','insurance','total')"><td>@value</td></face> 
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>
                  </basis:11>

                   <basis:12 core="group" if="[##db.InvoiceType.Value##] in ('11')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>Lounge INFORMATION</span></caption>
                                  <thead>
                                      <tr>
                                          <th><span>ProductName</span></th>            
                                          <th><span>AirportName</span></th>
                                          <th><span>City</span></th>
                                          <th><span>Airline</span></th>
                                          <th><span>RouteCode</span></th>
                                          <th><span>Date</span></th>
                                          <th><span>Time</span></th>
                                          <th><span>Travel Type</span></th>
                                          <th><span>Flight Type</span></th>
                                                                                            
                                      </tr>
                                  </thead>

                                  <tbody>@child</tbody>
                              </table>
                          </face>
                                                                  
                          <face filter="Field in ('cip') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('loungename','airportname','route','time','airline','routecode') and type in ('scalar.String')"><td>@value</td></face>
                          <face filter="Field in ('travelType') and value in ('1')"><td>Internal</td></face> 
                          <face filter="Field in ('travelType') and value in ('2')"><td>External</td></face>  
                           <face filter="Field in ('flightType') and value in ('1')"><td>Entrance</face> 
                          <face filter="Field in ('flightType') and value in ('2')"><td>Output</face> 
                         <face filter="Field in ('city_flight')">-@value</td></face> 
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                         
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:12>

                  <basis:13 core="group" if="[##db.InvoiceType.Value##] in ('11')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay','transfers','services','wheelchair','escortinfo')"></face>     
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p> <span>COST TABLE BY PASSENGERS</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                          <face filter="Field in ('adult') and type in ('object')">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child') and type in ('object')">
                              <tr>
                                  <td>Child</td>
                                  @Child
                              </tr>
                          </face>             

                          <face filter="Field in ('infant') and type in ('object')">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('perperson','total')"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','services','wheelchair','escortinfo')"></face>     
                          <face filter="Field in ('transfers') and value not in ('[]')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p> <span>COST TABLE BY transfers</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>TransferName</span></th>
                                          <th><span>Address</span></th>
                                          <th><span>Time</span></th>
                                          <th><span>Phone</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                           <th><span>Description</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                   

                          <face filter="Field in ('car_name','address','time','phone','perperson','total','des_transfer')"><td>@value</td></face>
                         
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','transfers','wheelchair','escortinfo')"></face>     
                          <face filter="Field in ('services') and type in ('Array') and value not in ('[]')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p><span>COST TABLE BY services</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>ServiceName</span></th>
                                          <th><span>Count</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                           <th><span>Description</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                   

                          <face filter="Field in ('service') and type in ('Object')"><tr>@child</tr></face>
                          <face filter="Field in ('perperson','total')"><td class="Seprator">@value</td></face>
                          <face filter="Field in ('count','unit','name','des_service')"><td>@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>                       
                      </basis>
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','transfers','services','escortinfo')"></face>     
                              <face filter="Field in ('wheelchair') and type in ('Object')">
                                  <table class="invoice_tbl">
                                      <caption class="invoice_caption"><p>Wheelchair price table</p></caption>
                                      <thead>
                                          <tr>
                                             
                                              <td>Wheelchairs count</td>
                                              <td>Unit price</td>
                                              <td>Total price</td>
                                              <td>Unit</td>
                                          </tr>
                                      </thead>
                                      
                                      <tbody class="invoice_tbody "><tr>@Child</tr></tbody>
                                  </table>
                              </face> 
                              <face filter="Field in ('perperson','total')"><td class="Seprator">@value</td></face>
                              <face filter="Field in ('count','unit')"><td>@value</td></face>
                              <face filter="type in ('Array','object')">@Child</face>                       
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','transfers','services','wheelchair')"></face>     
                               <face filter="Field in ('escortinfo') and type in ('Array') and value not in ('[]')">
                  <table class="invoice_tbl">
                      <caption class="invoice_caption"><p>Accompanying price table</p></caption>
                      <thead>
                          <tr>
                              <td>Name</td>
                              <td>Last name</td>
                              <td>Gender</td>
                              <td>Unit price</td>
                              <td>Total price</td>
                              <td>Unit</td>
                          </tr>
                      </thead>
                      
                      <tbody class="invoice_tbody ">@Child</tbody>
                  </table>
              </face>
              <face filter="Field in ('escort') and type in ('Object')"><tr>@child</tr></face>
              <face filter="Field in ('perperson','total')"><td class="Seprator">@value</td></face>
              <face filter="Field in ('unit','firsname','lastname')"><td>@value</td></face>
              <face filter="Field in ('gender') and value in ('0')"><td>Female</td></face>
               <face filter="Field in ('gender') and value in ('1')"><td>Male</td></face>
              <face filter="type in ('Array','object')">@Child</face>                           
                      </basis>

                  </basis:13>


                  <!-- bill ################################################################################################# -->
                  <basis:14 core="group" if="[##db.InvoiceType.Value##] in ('10','4')">
                    <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                        <face filter="Field in ('invoiceDetails','invoiceDate','account','passengers','passengersvisa','products','priceDetails','baggages','creditPay')"></face>
                        <face filter="Field in ('bill')">
                            <table class="invoice_tbl">
                                <caption class="invoice_caption"><span>TOTAL COST TABLE</span></caption>
                                <thead>
                                    <tr>
                                        <th><span>TOTAL COST</span></th>
                                        <th><span>COMMISSION</span></th>
                                        <th><span>DISCOUNT</span></th>                            
                                        <th><span>DISCOUNT CODE</span></th>
                                        <th><span>COST BY COMMISSION</span></th>
                                        <th><span>UNIT</span></th>
                                   </tr>
                                </thead>
                                
                                <tbody class="invoice_tbody"><tr>@Child</tr></tbody>
                            </table>
                        </face>           
                
                        <face filter="Field in ('totalprice','commission','couponcost','totalwithcommisions')"><td style="direction:ltr">@value</td></face>
                        <face filter="Field in ('unit','couponcode')"><td style="font-family:IRANSansWeb;">@value</td></face>
                         <face filter="Field in ('pdf_description') and value in ('[]')">
                              <div  class="pdf_description">
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 1 : </span> <br>
                            <span style="color:#CE0E0E">Contract Subject: </span>
                            The subject of this contract is to determine the limits of duties and responsibilities of the parties to the contract, as well as the cost of tourism services to provide as described in the contract.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 2 : </span> <br>
                            <span style="color:#CE0E0E">Terms of the contract : </span>
                            If the tour is not feasible by the broker due to not reaching the quorum, the broker is obliged to inform the tourist before the date of the tour by providing appropriate reasons and to return all the funds received from the tourist.
                        </p>
                
                        <p style="margin:10px 0;color:#CE0E0E">
                            <span style="color:#CE0E0E">Attention </span>
                            In case of non-confirmation, another hotel will be replaced, and in case of price difference according to the package, our rate will be received according to the difference.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 3 : </span> <br>
                            The evacuation time of the hotel rooms is in accordance with the rules and regulations governing the destination, and the tourist is obliged to comply with it. If the room is delivered earlier than scheduled by the tourist, no amount will be refunded to the tourist.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 4 : </span> <br>
                            Individual (single) tourists are subject to the rules and rates of using a single room when registering.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 5  : </span> <br>
                            For scheduled tours with non-charter flights, the cancellation conditions will be applied in accordance with the regulations of the relevant airline and hotel of residence.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 6: </span> <br>
                            If in some cases, at the arrival of the tourist at the airport of the destination country, his passport is obtained and maintained by the relevant authorities to be returned to the tourist upon return to the airport, in such circumstances, the broker will not be responsible.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 7 : </span> <br>
                            If, according to the conditions announced by the embassy regarding the return of the tourist, a guarantee is obtained from the broker, the tourist is obliged to submit the same amount of bank guarantee to the broker.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Note 1 :</span> <br>
                            After returning from the trip, tourists need to refer to the broker with the original passport and the page image related to the entry and exit stamp of the destination country in order to receive the deposited bank guarantee, and the broker is obliged to confirm the authenticity and accuracy of the documents provided. , Immediately take action against the warranty jaw.  
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 8 : </span> <br>
                            If the issued visa provides for a specific period of time for the stay, if any of the tourists refuses to return to the country on the predetermined date and this will cause damages to the broker according to the tourist's commitment, the broker is authorized. By submitting a reasoned document, he / she will receive the equivalent of the cost (damage) incurred through the confiscation of the guarantee in his favor.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 9 : </span> <br>
                            If the visa is not issued by the destination country, the broker is not responsible in this regard, but if the broker has incurred a fee in this regard, in order to obtain the costs incurred is obliged to provide valid documents to the tourist.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 10 : </span> <br>
                            If the tourist disturbs other tourists or the group leader, local guides and all those involved in the patrol or commits acts contrary to customary customs and ethics in the country, the group leader is obliged according to the minutes and other members of the group Depending on the case, make the necessary decision about that tourist and report the steps to the executive agent.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 11 : </span> <br>
                            The organization of cultural heritage, handicrafts and tourism is responsible for resolving any disputes between us between the parties to the contract by providing reasons, and the votes issued by the organization are binding on the parties.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 12 : </span> <br>
                            Regarding group registration in normal conditions (non-force), only a person who has registered and signed a contract on behalf of tourists is allowed to refer to the broker to follow up, cancel or receive payment, and other tourists are allowed in this regard. Do not go to the broker.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 13 : </span> <br>
                            Observance of manners and ethics during the trip by the tourist is mandatory and also the tourist is obliged to comply with all regulations of the destination country. Therefore, the consequences of committing any violation and having the consequences of having drugs that may be illegal in the destination country, are the responsibility of the tourist, and if the broker pays a fine in this regard, he can receive the cost from the tourist by providing documents.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 14: </span> <br>
                            If the trip is for groups and families, if the visa application of any tourist is rejected or received late, the rest of the tourists are required to use the requested services and if not used, they must pay all the costs related to the cancellation.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Note 2 : </span> <br>
                            For first-degree relatives (father, mother, spouse, unmarried children), a visa fee and one night stay at the hotel and a ticket cancellation fee will be charged. 
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 15 : </span> <br>
                            The protection of personal property and documents is the responsibility of the tourist and in case of its loss, the manager or broker will not be responsible.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 16 : </span> <br>
                            If visas and passports are issued by some embassies in the last hours before the start of the trip, the tourist must have prepared her travel arrangements in advance. 
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Note 3 : </span> <br>
                            The principle is that the visa is normal, but if the tourist insists on obtaining a visa immediately, the resulting responsibilities will be borne by the tourist.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 17 : </span> <br>
                            At the request of the relevant embassy for an interview with a tourist or fingerprinting for the issuance of a visa, the tourist must attend the interview at the consulate of the relevant embassy and participate in the interview in due time, and if due to failure to do so, the visa issued by the embassy If not, penalties will be charged.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 18 : </span> <br>
                            The tourist is obliged to participate in the airport tour and transfer programs during the announced hours, and if he is not present on time during the tour, he must personally pay the relevant fees to join the group and continue the tour program, otherwise the relevant agent He will not have any responsibility in this regard.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 19 : </span> <br>
                            In case of cancellation of the tour by the tourist, the broker will be allowed to cancel the visa issued to the tourist by the officials of the embassy issuing the visa.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 20 : </span> <br>
                            In case of any involuntary increase in the price of the tour, whether it is an increase in the ticket price or other services, the tourist is obliged to pay the difference announced by the broker by presenting documentary evidence by the broker with the approval of the organization.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Note4 : </span> <br>
                            Payment of all exit taxes is the responsibility of the tourist.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 21 : </span> <br>
                            If the tourist is not allowed to leave or the local authorities prevent him from entering the country upon arrival, the tourist will be required to pay the fees incurred by the broker by submitting the relevant documents. The patrol supervisor is also obliged to cooperate for the return of the tourist to the country and the broker will not be responsible for this.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 22 : </span> <br>
                            If the tourist abroad independently and outside the proposed tour program to purchase optional services and participate in it, the cost and responsibility for the consequences of accidents will be borne by the tourist.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 23 : </span> <br>
                            The broker is obliged to take the necessary measures regarding the obligatory and optional insurance coverage in accordance with the insurance instructions notified by the organization, and in case of any accident during the trip, in addition to acting in accordance with the covered insurance conditions, to cooperate and Take the necessary assistance in this regard.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 24:</span> <br>
                            The control of tourist documents, including the validity date of the tourist passport and the age conditions of the companions, is the responsibility of the broker. Therefore, in case of negligence in this regard by the broker, all costs and damages will be borne by the broker.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 25:</span> <br>
                            The broker undertakes to carry out the agreed travel and patrol schedule completely and accurately, but in the event of unexpected events such as war, riots, strikes and problems beyond the broker's control and cause the plan to be canceled or changed. The broker will not be responsible, but the broker is obliged to return the received funds to the tourist.
                        </p>
                
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 26:</span> <br> 
                            If the tour plan provided by the broker is not implemented during the trip or is not presented at a higher level than agreed in the contract, the tourist is allowed to announce the items to the broker with good reasons, the broker is obliged to satisfy the tourist. In case of any dispute, the decision of the organization will be accepted as a ruling by the parties. This contract is regulated in 2 copies consisting of 25 articles and 4 notes, each of which has a single sentence and is based on Articles 230 of the Civil Code, which are binding on the parties or their legal representatives.  </p>
                        <p style="margin:10px 0">
                            <span style="font-weight:bold;">Article 27: </span> <br> 
                            In case of written cancellation of the passenger from accompanying the tour, up to one month before the flight equal to 20% of the total tour price and from one month to three weeks before the flight equal to 30% of the total tour price and from three weeks to 72 hours before the flight equal to 50% of the total price Tour and in less than 72 hours before the flight, 70% of the total tour price will be deducted from the total tour amount as a penalty and the rest of the funds will be paid to the passenger.
                        </p>
                    </div>
                          </face>
                          <face filter="Field in ('pdf_description') and value not in ('[]')">
                              <div  class="pdf_description">
                                  @child
                              </div>
                          </face>
                          <face filter="Field in ('note')">
                               <p style="margin:10px 0">
                                  @child
                                  
                                  </p>
                          </face>
                          <face filter="Field in ('title')">
                             
                              <span style="font-weight:bold;">@value : </span> <br>
                                    
                               
                          </face>
                          <face filter="Field in ('text')">
                          @value
                          </face>
                        <face filter="type in ('Array','object')">@Child</face>                   
                    </basis>
                </basis:14>
                <basis:15 core="group" if="[##db.InvoiceType.Value##] in ('3')">
                    <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                        <face filter="Field in ('invoiceDetails','invoiceDate','account','passengers','passengersvisa','products','priceDetails','baggages','creditPay')"></face>
                        <face filter="Field in ('bill')">
                            <table class="invoice_tbl">
                                <caption class="invoice_caption"><span>TOTAL COST TABLE</span></caption>
                                <thead>
                                    <tr>
                                        <th><span>TOTAL COST</span></th>
                                        <th><span>COMMISSION</span></th>
                                        <th><span>DISCOUNT</span></th>                            
                                        <th><span>DISCOUNT CODE</span></th>
                                        <th><span>COST BY COMMISSION</span></th>
                                        <th><span>UNIT</span></th>
                                   </tr>
                                </thead>
                                
                                <tbody class="invoice_tbody"><tr>@Child</tr></tbody>
                            </table>
                        </face>           
                
                        <face filter="Field in ('totalprice','commission','couponcost','totalwithcommisions')"><td style="direction:ltr">@value</td></face>
                        <face filter="Field in ('unit','couponcode')"><td style="font-family:IRANSansWeb;">@value</td></face>
                         <face filter="Field in ('pdf_description') and value in ('[]')">
                              <div  class="pdf_description">
                                <p style="margin:10px 0;color:#CE0E0E">
                                    <span style="color:#CE0E0E">Attention </span>
                                    In case of non-confirmation, another hotel will be replaced, and in case of price difference according to the package, our rate will be received according to the difference.
                                </p>
                            </div>
                          </face>
                          <face filter="Field in ('pdf_description') and value not in ('[]')">
                              <div  class="pdf_description">
                                  @child
                              </div>
                          </face>
                          <face filter="Field in ('note')">
                               <p style="margin:10px 0">
                                  @child
                                  
                                  </p>
                          </face>
                          <face filter="Field in ('title')">
                             
                              <span style="font-weight:bold;">@value : </span> <br>
                                    
                               
                          </face>
                          <face filter="Field in ('text')">
                          @value
                          </face>
                        <face filter="type in ('Array','object')">@Child</face>                   
                    </basis>
                </basis:15>
                <basis:16 core="group" if="[##db.InvoiceType.Value##] not in ('4','10','3')">
                    <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                        <face filter="Field in ('invoiceDetails','invoiceDate','account','passengers','passengersvisa','products','priceDetails','baggages','creditPay')"></face>
                        <face filter="Field in ('bill')">
                            <table class="invoice_tbl">
                                <caption class="invoice_caption"><span>TOTAL COST TABLE</span></caption>
                                <thead>
                                    <tr>
                                        <th><span>TOTAL COST</span></th>
                                        <th><span>COMMISSION</span></th>
                                        <th><span>DISCOUNT</span></th>                            
                                        <th><span>DISCOUNT CODE</span></th>
                                        <th><span>COST BY COMMISSION</span></th>
                                        <th><span>UNIT</span></th>
                                   </tr>
                                </thead>
                                
                                <tbody class="invoice_tbody"><tr>@Child</tr></tbody>
                            </table>
                        </face>           
                
                        <face filter="Field in ('totalprice','commission','couponcost','totalwithcommisions')"><td style="direction:ltr">@value</td></face>
                        <face filter="Field in ('unit','couponcode')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="Field in ('pdf_description') and value not in ('[]')">
                              <div  class="pdf_description">
                                  @child
                              </div>
                          </face>
                          <face filter="Field in ('note')">
                               <p style="margin:10px 0">
                                  @child
                                  
                                  </p>
                          </face>
                          <face filter="Field in ('title')">
                             
                              <span style="font-weight:bold;">@value : </span> <br>
                                    
                               
                          </face>
                          <face filter="Field in ('text')">
                          @value
                          </face>
                        <face filter="type in ('Array','object')">@Child</face>                   
                    </basis>
                </basis:16>

                 
              </div>

              <style type="text/css">
                  @font-face{
                      font-family:'IRANSansWeb';
                      src:url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.eot');src:local('?'),
                      url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.woff2') format("woff"),
                      url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.ttf') format("truetype"),
                      url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.otf') format("otf");
                      font-weight:400;font-style:normal
                  }
                  @font-face{
                      font-family:'FontAwesome';
                      src:local('FontAwesome'),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.eot?#iefix');src:local('?'),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.woff') format("woff"),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.ttf') format("truetype"),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.otf') format("otf");
                      font-weight:400;font-style:normal
                  }
                  *{margin:0; padding:0;}
                  body{font-family:IRANSansWeb;font-size:10px;color:#3b3838;font-weight: bold;}
                  span,i{display:inline-block;}
                  p{text-align:justify;}
                  strong{color:#CE0E0E}
                  .clr{clear: both;}
                  .Panel_pdf{width:100%;margin:0 auto;direction:ltr}
                  .pdf_title{text-align: center;margin-bottom: 15px;font-weight: bold;}
                  .pdf_description {margin:15px 0;text-align:justify;}
                  .pdf_direct{direction:ltr;}
                  .Panel_pdf table{width:100%;margin:20px 0;}
                  .Panel_pdf table caption{text-align:left;border-right: 1px solid #fff;border-left: 1px solid #fff;font-size:10px;}
                  .Panel_pdf table caption span{padding:5px}
                  .Panel_pdf table tr th{text-align:center;font-weight:normal;background:#DDE8F0;padding:3px 2px;font-size:9px}
                  .Panel_pdf table tr td{text-align:center;padding:3px 2px;direction: ltr;border: 1px solid #CBDDEA;background:#F4F8FB;font-size:9px;}
                  .Panel_pdf table tr td p{text-align:center;}
                  .Panel_pdf table.tourDetails tr td{text-align:left;padding:3px 5px;font-family:IRANSansWeb;}
                  .Panel_pdf table.tourDetails tr td:nth-child(1){background:#DDE8F0;font-family:IRANSansWeb;padding:3px 5px}
                  .passengers::after {content: "+";display: inline-block;margin: 0 3px;}
                  .passengers:last-child:after{display:none;}
                  .invoice_caption{font-size: 10px;}
                  th span{display: block;}
                  .hidden{display: none;}
              </style>
          </body>
      </html>
  </basis>
</basis>
</basis>
<basis core="group" name="check-version" if="'[##cms.cms.server_main_version##]' <> '4'">
    <basis core="call" lid="2" file="Panel-HeaderPdf.inc" /> 
    <basis core="call" lid="2" file="Client_CheckRkey.inc"></basis> <!-- updated login -->


<basis core="group" if="[##db.checkrkey.userid##]=0  ">
  <!DOCTYPE html>
  <html>
      <head>
          <meta charset="UTF-8"/>
          <title>Invoice</title>
      </head>
      
      <body>
          <p style="text-align:center">You are not allowed to access this page</p>
          <style type="text/css">
              @font-face{
                  font-family:'IRANSansWeb';
                  src:url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.eot');src:local('?'),
                  url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.woff2') format("woff"),
                  url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.ttf') format("truetype"),
                  url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.otf') format("otf");
                  font-weight:400;font-style:normal
              }
              body{font-family:IRANSansWeb;font-size:20px;color:#3b3838;}
          </style>
      </body>
  </html>
</basis>

<basis core="group" if="[##db.checkrkey.userid##]<>0">
  <basis core="external.fly.ws" source="cmsDbService2" name="db" procedurename="dbsource" > 
      <member method="cms"
      name="InvoiceView" 
      query='
      { 
          "name": "db", 
          "mid": "20", 
          "member":
          [
              { 
                  "name": "q", 
                  "type":"list", 
                  "request":"invoiceview", 
                  "id":"[##cms.query.id##]",
                  "lid":"2"

              }
          ] 
      }'/> 
  </basis>

  <basis core="group" name="Delay_2">
      <basis core='inlinesource' name='db'>
          <member name="InvoiceView_Tree" format="json"preview="">{"root":[##db.InvoiceView.result##]}</member>
          <member 
              name='InvoiceOwnerid'  
              format="json" 
              postsql="select value from [db.InvoiceOwnerid] where Field = 'ownerid'"
              preview=""> 
              {"root":[##db.InvoiceView.result##]}
          </member>

          <member 
              name='InvoiceOpen'  
              format="json" 
              postsql="select value from [db.InvoiceOpen] where Field = 'open'"
              preview=""> 
              {"root":[##db.InvoiceView.result##]}
          </member>       

          <member 
              name='InvoiceType'  
              format="json" 
              postsql="select value from [db.InvoiceType] where Field = 'invoicetype'"
              preview=""> 
              {"root":[##db.InvoiceView.result##]}
          </member>           
      </basis>

      <basis core="dbsource" source="basiscore" mid="5" name="db" lid="2" usedforid="[##db.InvoiceOwnerid.Value##]" > 
      <member type="view" name="AgancyName" postsql="select Answer from [db.AgancyName] where typeid=150"/></basis>

      <html>
          <head>
              <title>Invoice</title>
              <meta charset="utf-8"> 
          </head>

          <body>
              <div class="Panel_pdf">
                  <div class="pdf_title">
                      <basis:00 core="group" if="[##db.InvoiceOpen.Value|(0)##]=0">
                      <basis:02 core="group" if="[##cms.query.status|(0)##]=0">
                      
                      <div>Contract</basis:02>
                      <basis:03 core="group" if="[##cms.query.status|(0)##]=1">
                      
                      <div>Pre-contract</basis:03>
                      </basis:00>
                      <basis:01 core="group" if="[##db.InvoiceOpen.Value|(0)##]=1"><div>Pre-contract</basis:01>
                        Providing travel and tourism services </div>
                  </div>
                  <div class="pdf_description">
                      <div><span>Number : </span>[##cms.query.id##]</div>                  
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null"> 
                          <face filter="Field in ('invoiceDate','account','products','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('invoiceDetails')">@child</face>
                          <face filter="Field in ('counterName')"><div>Counter name : <span> @value</span> </div></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('travelDate','invoiceDetails','products','creditPay')"></face>
                          <face filter="Field in ('invoiceDate')">
                              <div class="invoice_Details">Date of contract registration : @child</div>
                          </face>

                          <face filter="Field in ('mstring')"><span>@value</span></face>
                   
                          <face filter="type in ('Array','object')">@Child</face>    
                      </basis>
                          
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('baggage')"></face>
                          <face filter="Field in ('title')"><div style="direction:ltr;"><span>Type of service : </span> @value</div></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                
                      </basis>
                  </div>

                  <div class="pdf_description">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null"> 
                          <face filter="Field in ('invoiceDetails','invoiceDate','products','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('account','person')">@child</face>

                          <face filter="Field in ('firstname')">This contract is between Ms. / Mr. @value </face>
                          <face filter="Field in ('lastname')">@value </face>
                          <face filter="Field in ('address')">to the address ( @value ) </face>
                          <face filter="Field in ('tel')"> Has a landline phone number <span class="pdf_direct"> ( @value ) </span></face>
                          <face filter="Field in ('mobile')">and mobile number<span class="pdf_direct">( @value ) </span></face>

                          <face filter="Field in ('agencyname')">This contract is between @value</face>
                          <face filter="Field in ('agencymanegername')"> With management @value</face>
                          <face filter="Field in ('agencytell')">To the contact number <span class="pdf_direct"> ( @value ) </span></face>

                          <face filter="type in ('Array','object')">@Child</face>                                                
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null"> 
                          <face filter="Field in ('invoiceDate','account','products','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('invoiceDetails')">@child</face>
                          <face filter="Field in ('persons')"> 
                            Individually or on behalf of the following persons by a total of @value, hereinafter referred to as "tourists", on the one hand and the office <strong>[##db.AgancyName.Answer##]</strong>Hereinafter referred to as "broker", as <strong> online shopping </strong>  Has been concluded.
                          </face>

                          <face filter="type in ('Array','object')">@Child</face>                                                
                      </basis>
                  </div>

             

                  <!-- products ############################################################################################# -->     
                  <!-- type == 1 -->
                  <basis:1 core="group" if="[##db.InvoiceType.Value##] in ('1')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>FLIGHT INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>AIRLINE</span></th>
                                          <th><span>DEPARTURE AIRPORT</span></th>
                                          <th><span>DESTINATION AIRPORT</span></th>
                                          <th><span>FLIGHT NO</span></th>
                                          <th><span>FLIGHT CLASS</span></th>                                                    
                                      </tr>
                                  </thead>

                                  <tbody>@child</tbody>
                              </table>
                          </face>
                                                                  
                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route') and type in ('scalar.String')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="Field in ('etime','atime','class','routecode') and type in ('scalar.String')"><td>@value</td></face>
                          
                          <face filter="Field in ('airline')"><td>@value</td></face>                                      
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                

                          <face filter="Field in ('startairport','endairport')"><td style="font-family:IRANSansWeb;">@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>      
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:1>

                  <!-- type == 2 -->
                  <basis:2 core="group" if="[##db.InvoiceType.Value##] in ('2','4','6')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>FLIGHT INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>AIRLINE</span></th>
                                          <th><span>DEPARTURE AIRPORT</span></th>
                                          <th><span>DESTINATION AIRPORT</span></th>
                                          <th><span>FLIGHT NO</span></th>
                                          <th><span>FLIGHT CLASS</span></th>                                                      
                                      </tr>
                                  </thead>

                                  @child
                              </table>
                          </face>

                          <face filter="Field in ('hotel','transfer','insurance')"></face>
                          <face filter="Field in ('departure') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                          Departure Information 
                                      </td>
                                  </tr>
                                  @child  
                              </tbody>                 
                          </face> 

                          <face filter="Field in ('return') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                          Return Information
                                      </td>
                                  </tr>
                                  @child
                              </tbody>
                          </face>  

                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route') and type in ('scalar.String')"><td style="font-family:IRANSansWeb">@value</td></face>
                          <face filter="Field in ('etime','atime','class','routecode') and type in ('scalar.String')"><td>@value</td></face>
                          <face filter="Field in ('airline')"><td>@value</td></face>
                                      
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                         

                          <face filter="Field in ('startairport','endairport')"><td style="font-family:IRANSansWeb">@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>      
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:2>

                  <!-- type == 3 -->
                  <basis:3 core="group" if="[##db.InvoiceType.Value##] in ('3','4','6','10')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>LIST OF ROOMS</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>HOTEL NAME</span></th>
                                          <th><span>HOTEL GRADE</span></th>
                                          <th><span>CITY</span></th>
                                          <th><span>ROOM</span></th>
                                          <th><span>ROOM TYPE</span></th>
                                          <th><span>CHECK IN</span></th>
                                          <th><span>CHECK OUT</span></th>
                                          <th><span>PASSENGERS</span></th>
                                          <th><span>SERVICES</span></th>                                                    
                                      </tr>
                                  </thead>

                                  @child
                              </table>
                          </face>
                          
                          <face filter="Field in ('departure','return','transfer','insurance','transfers','services')"></face>
                          <face filter="Field in ('hotel') and type in ('array')">
                              <tbody>
                                  <tr><td colspan="9" style="background:#FFF4E3;text-align:left;padding:15px 0"></td></tr>
                                  @child 
                              </tbody>                  
                          </face>
                          
                          <face filter="Field in ('room')"><tr>@Child</tr></face>
                          <face filter="Field in ('hotelName','cityName','roomNumber','roomType','service')"><td>@value</td></face>                
                          <face filter="Field in ('hotelStar')"><td>@value</td></face>

                          <face filter="Field in ('fromDate','toDate','passengers')"><td>@child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                      

                          <face filter="Field in ('passengersRoom')"><td>@child</td></face>
                          <face filter="Field in ('adult')"><span class="passengers">@value Adult</span></face>
                          <face filter="Field in ('child Withbed') and value <> '0'"><span class="passengers">@value Chils (WB)</span></face>
                          <face filter="Field in ('child Withoutbed') and value <> '0'"><span class="passengers">@value Child (WOB)</span></face>
                          <face filter="Field in ('infant') and value <> '0'"><span class="passengers">@value Infant</span></face>
                          <face filter="Field in ('extra Adult') and value <> '0'"><span class="passengers">@value Extra Adult</span></face>
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:3>

                    <basis:333 core="group" if="'[##db.InvoiceType.Value##]' in ('3','6')">
                        <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                            <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>             
                            <face filter="Field in ('products')">
                               @child
                            </face>

                            <face filter="Field in ('departure','return','transfer','insurance','hotel','transfers')"></face>
                            <face filter="Field in ('services') and type in ('array') and value <> '[]'">
                                 <table class="invoice_tbl product_tbl">
                                    <caption class="invoice_caption"><p>service Information</p></caption>
                                    <thead>
                                        <tr>            
                                           
                                            <td>passengerName</td>
                                             <td>serviceName</td>
                                              <td>webservice</td>
                                            <td>totalPrice</td>
                                            <td>unit</td>
                                                                                                
                                        </tr>
                                    </thead>

                                    <tbody class="invoice_tbody"> @child</tbody>
                                </table>              
                            </face>
                            
                            <face filter="Field in ('service')"><tr>@Child</tr></face>
                            <face filter="Field in ('service_passengerlist')"><td>@Child</td></face>
                            <face filter="Field in ('servicename')"><td>@value</td></face>
                            <face filter="Field in ('webservices')"><td>@child</td></face>
                            <face filter="Field in ('webservice')">@value</face>
                            <face filter="Field in ('refnumber')">/@value</face>
                            <face filter="Field in ('servicecost')"><td>@value</td></face>
                            <face filter="Field in ('serviceunit')"><td>@value</td></face>
                            <face filter="Field in ('firstname')"><div><span>@value-</span></face>
                            <face filter="Field in ('lastname')"><span>@value</span></div></face>

                                       
                            <face filter="Field in ('cancel') and value ='1'">
                               
                                    <input type="hidden" name="" class="canceli" value="1">
                            </face>
                            <face filter="Field in ('cancel') and value ='0'">
                              
                                    <input type="hidden" name="" class="canceli" value="0">
                            </face>   

                            <face filter="Field in ('error') and value ='1'">
                                  <td class="Webervice_Refnumber">
                                    <div>ناموفق</div>
                                    <div>
                                        <a href="/reservation/invoice/Get_Refnumber.bc?id=[##cms.form.id##]&type=3&clear=[##cms.form.clear##]" class="Webervice_Link" title="صدور هتل">
                                            صدور هتل
                                            <i class="fa fa-external-link-square-alt"></i>
                                        </a>
                                    </div>
                                </td>
                            </face>                
                        

                            <face filter="type in ('Array','object')">@Child</face>                                                     
                        </basis>

                        <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                            <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>             
                            <face filter="Field in ('products')">
                               @child
                            </face>

                            <face filter="Field in ('departure','return','transfer','insurance','hotel','services')"></face>
                            <face filter="Field in ('transfers')">
                                 <table class="invoice_tbl product_tbl">
                                    <caption class="invoice_caption"><p>transfer Information</p></caption>
                                    <thead>
                                        <tr>            
                                           
                                            <td>serviceName</td>
                                             <td>transferName</td>
                                            <td>typeTransfer</td>
                                            <td>airport</td>

                                            <td>departureDate</td>
                                            <td>returnDate</td>
                                            <td>departureRoutecode</td>
                                            <td>returnRoutecode</td>

                                            <td>departureHour</td>
                                            <td>returnHour</td>
                                             <td>webservice</td>
                                             <td>totalPrice</td>
                                              <td>unit</td>
                                                                                                
                                        </tr>
                                    </thead>

                                    <tbody class="invoice_tbody"> <tr>@Child</tr></tbody>
                                </table>              
                            </face>
                            
                            
                            <face filter="Field in ('t_servicename')"><td>@value</td></face>
                            <face filter="Field in ('transfername')"><td>@value</td></face>
                            <face filter="Field in ('routename')"><td>@value</td></face>
                            <face filter="Field in ('airport')"><td>@value</td></face>
                            <face filter="Field in ('departure_Date')"><td>@value</td></face>
                            <face filter="Field in ('return_Date')"><td>@value</td></face>
                            <face filter="Field in ('departure_routecode')"><td>@value</td></face>
                            <face filter="Field in ('return_routecode')"><td>@value</td></face>
                            <face filter="Field in ('departure_hour')"><td>@value</td></face>
                            <face filter="Field in ('return_hour')"><td>@value</td></face>
                            <face filter="Field in ('transfercost')"><td>@value</td></face>
                            <face filter="Field in ('transferunit')"><td>@value</td></face>
                             <face filter="Field in ('webservices')"><td>@child</td></face>
                            <face filter="Field in ('webservice')">@value</face>
                            <face filter="Field in ('refnumber')">/@value</face>


                                       
                            <face filter="Field in ('cancel') and value ='1'">
                               
                                    <input type="hidden" name="" class="canceli" value="1">
                            </face>
                            <face filter="Field in ('cancel') and value ='0'">
                              
                                    <input type="hidden" name="" class="canceli" value="0">
                            </face>   

                            <face filter="Field in ('error') and value ='1'">
                                  <td class="Webervice_Refnumber">
                                    <div>ناموفق</div>
                                    <div>
                                        <a href="/reservation/invoice/Get_Refnumber.bc?id=[##cms.form.id##]&type=3&clear=[##cms.form.clear##]" class="Webervice_Link" title="صدور هتل">
                                            صدور هتل
                                            <i class="fa fa-external-link-square-alt"></i>
                                        </a>
                                    </div>
                                </td>
                            </face> 
                            <face filter="type in ('Array','object')">@Child</face>                                                     
                        </basis>

                    </basis:333>


                  <!-- type == 4 -->
                  <basis:4 core="group" if="[##db.InvoiceType.Value##] in ('4')">
                      <!-- city Transfer in tour -->
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('transfer') and value <> '[]'">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>INTERURBAN TRANSFER INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>AIRLINE</span></th>
                                          <th><span>DEPARTURE AIRPORT</span></th>
                                          <th><span>DESTINATION AIRPORT</span></th>
                                          <th><span>FLIGHT NO</span></th>
                                          <th><span>FLIGHT CLASS</span></th>                                                       
                                      </tr>
                                  </thead>

                                  <tbody>@child</tbody>
                              </table>
                          </face>
                          
                          <face filter="Field in ('departure','return','hotels','insurance')"></face>  
                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route') and type in ('scalar.String')"><td style="font-family:IRANSansWeb">@value</td></face>
                          <face filter="Field in ('etime','atime','class','routecode') and type in ('scalar.String')"><td>@value</td></face>
                          <face filter="Field in ('airline')"><td>@value</td></face>
                          
                                      
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                        

                          <face filter="Field in ('startairport','endairport')"><td>@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>     
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>                                  

                      <!-- insurance in tour -->            
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDetails','invoiceDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face> 
                          <face filter="Field in ('products')">@Child</face>                                     
                          <face filter="Field in ('insurance') and value <> '[]'">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"> <span>INSURANCE INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>COUNTRY</span></th>
                                          <th><span>INSURANCE TYPE</span></th>
                                          <th><span>INSURANCE COMPANY</span></th>                                                  
                                      </tr>
                                  </thead>

                                  <tbody><tr>@child</tr></tbody>
                              </table>
                          </face>

                          <face filter="Field in ('insuranceCountry','insuranceName','insuranceProvider')"><td style="font-family:IRANSansWeb;">@value</td></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>

                      <!-- tourDetails in tour -->
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate')"></face> 
                          <face filter="Field in ('products')">@Child</face>                                     
                          <face filter="Field in ('tourDetails') and value <> '{}'">
                              <table class="invoice_tbl tourDetails">
                                  <colgroup>
                                      <col width="20%"></col>
                                      <col width="80%"></col>
                                  </colgroup>

                                  <caption class="invoice_caption"> <span>TOUR INFORMATION </span></caption>
                                  <tbody>@child</tbody>
                              </table>
                          </face>

                          <face filter="Field in ('type') and type in ('array')">
                              <tr>
                                  <td><span>TOUR TYPE</span></td>
                                  <td>@child</td>
                              </tr>
                          </face> 

                          <face filter="Field in ('appropriate') and type in ('array')">
                              <tr>
                                  <td><span>SUITABLE FOR</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('diff') and type in ('array')">
                              <tr>
                                  <td><span>HARDNESS LEVEL</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('tool') and type in ('array')">
                              <tr>
                                  <td><span>REQUIRED REQUIREMENTS</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('service11') and type in ('array')">
                              <tr>
                                  <td><span>FREE SERVICES</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('journey') and type in ('array')">
                              <tr>
                                  <td><span>ITINERARY</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('description') and type in ('array')">
                              <tr>
                                  <td><span>DESCRIPTION</span></td>
                                  <td>@child</td>
                              </tr>
                          </face>

                          <face filter="Field in ('servicename','decs')"><span class="serviceName">@value</span></face>
                          <face filter="Field in ('journeytitle')"><span class="serviceName">@value : </face>
                          <face filter="Field in ('journeydesc')"> @value</span></face>
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:4>

                  <!-- type == 5 -->
                  <basis:5 core="group" if="[##db.InvoiceType.Value##] in ('5','6')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">@Child</face>                                     
                          <face filter="Field in ('insurance')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>INSURANCE INFORMATION</span></caption>
                                  <thead>
                                      <tr> 
                                          <th><span>COUNTRY</span></th>
                                          <th><span>INSURANCE NAME</span></th>
                                          <th><span>PERIOD OF TIME</span></th>
                                          <th><span>INSURANCE COMPANY</span></th>             
                                                 
                                      </tr>
                                  </thead>

                                  <tbody><tr>@child</tr></tbody>
                              </table>
                          </face>

                          <face filter="Field in ('departure','return','hotel')"></face>
                          <face filter="Field in ('country','name','Provider')"><td style="font-family:IRANSansWeb">@value</td></face>    
                          <face filter="Field in ('duration') and type in ('object')"><td style="direction:ltr;font-family:IRANSansWeb">@child</td></face>    
                          <face filter="Field in ('duration') and type in ('Scalar.String')"><span style="margin:0 2px"> @value</span></face>    
                          <face filter="Field in ('durationtype') and type in ('Scalar.String')"><span> @value</span></face>    
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:5>

                  <!-- products type == 8 -->
                  <basis:6 core="group" if="[##db.InvoiceType.Value##] in ('8')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>ONE-WAY TRAIN INFORMATION</span></caption>
                                  <thead>
                                      <tr> 
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>COMAPANY</span></th>
                                          <th><span>DEPARTURE STATION</span></th>
                                          <th><span>DESTINATION STATION</span></th>
                                          <th><span>TRAIN NO</span></th>
                                          <th><span>TRAIN CLASS</span></th>              
                                      </tr>
                                  </thead>

                                  <tbody>@child</tbody>
                              </table>
                          </face>
                          
                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route','etime','atime','class','routecode') and type in ('scalar.String')">
                              <td style="direction:ltr">@value</td>
                          </face>

                          <face filter="Field in ('trainid')"><td>@value</td></face>
                                      
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                   

                          <face filter="Field in ('startairport','endairport')"><td>@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>      
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:6>

                  <!-- products type == 9 -->
                  <basis:7 core="group" if="'[##db.InvoiceType.Value##]' in ('9')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"> <span>ROUND-TRIP TRAIN INFORMATION</span></caption>
                                  <thead>
                                      <tr>            
                                          <th><span>FROM - TO</span></th>
                                          <th><span>DATE</span></th>
                                          <th><span>EXit TIME</span></th>
                                          <th><span>ARRIVAL TIME</span></th>
                                          <th><span>COMAPANY</span></th>
                                          <th><span>DEPARTURE STATION</span></th>
                                          <th><span>DESTINATION STATION</span></th>
                                          <th><span>TRAIN NO</span></th>
                                          <th><span>TRAIN CLASS</span></th>                                                     
                                      </tr>
                                  </thead>

                                  @child
                              </table>
                          </face>

                          <face filter="Field in ('hotel','transfer','insurance')"></face>
                          <face filter="Field in ('departure') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                          Departure Information
                                      </td>
                                  </tr>
                                  @child  
                              </tbody>                 
                          </face> 

                          <face filter="Field in ('return') and type in ('array')">
                              <tbody>
                                  <tr>
                                      <td colspan="10" style="background:#FFF4E3;text-align:left;padding-left:22px;font-family:IRANSansWeb">
                                           Return Information 
                                      </td>
                                  </tr>
                                  @child
                              </tbody>
                          </face>   

                          <face filter="Field in ('route') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('route','etime','atime','class','routecode') and type in ('scalar.String')"><td style="direction:ltr">@value</td></face>
                          <face filter="Field in ('trainid')"><td>@value</td></face>
                                  
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                       

                          <face filter="Field in ('startairport','endairport')"><td>@Child</td></face>
                          <face filter="Field in ('airport')"><div>@value</div></face>
                          <face filter="Field in ('startotherinfo')"><div>@Child</div></face>
                          <face filter="Field in ('shortname')">@value | </face>           
                          <face filter="Field in ('city')">@value</face>       
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:7>
                       <!-- passengesr ########################################################################################### -->
                       <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">   
                        <face filter="Field in ('invoiceDetails','invoiceDate','products','account','priceDetails','baggages','bill','creditPay','passengersvisa')"></face>
                        <face filter="Field in ('passengers')">
                            <table class="invoice_tbl">
                                <caption class="invoice_caption"><span>List of passengers</span> / <span>PASSENGERS INFORMATION</span></caption>
                                <thead>
                                    <tr>
                                        <th><span>NAME</span></th>
                                        <th><span>SURNAME</span></th>
                                        <th><span>DATE OF BIRTH</span></th>
                                        <th><span>NATIONAL CODE</span></th>
                                        <th><span>PASSPORT NO</span></th>
                                        <th><span>EXPIRATION DATE OF PASSPORT</span></th>
                                        <th><span>GENDER</span></th>
                                        <th><span>AGE RANG</span></th>
                                    </tr>
                                </thead>
                                <tbody class="invoice_tbody">@Child</tbody>
                            </table>
                        </face>       
  
                        <face filter="Field in ('passengerinfo')"><tr>@child</tr></face> 
                        <face filter="Field in ('firstname','lastname','nationalcode','passportcode','passportexpiration')"><td>@value</td></face>        
  
                        <face filter="Field in ('birthdate') and type in ('object')"><td>@child</td></face>
                        <face filter="Field in ('M_birthdate') and type in ('Scalar.String') and value not in ('-')"><p>@value</p></face>
                     
  
                        <face filter="Field in ('M_birthdate') and type in ('Scalar.String') and value in ('-')"><p></p></face>
                     
  
                        <face filter="Field in ('gender') and value = '0'"><td>Female</td></face>
                        <face filter="Field in ('gender') and value = '1'"><td>Male</td></face>
                        <face filter="Field in ('type') and value = '0'"><td style="direction: ltr;">Infant</td></face>
                        <face filter="Field in ('type') and value = '1'"><td style="direction: ltr;">Child</td></face>
                        <face filter="Field in ('type') and value = '2'"><td style="direction: ltr;">Adult</td></face>
                        <face filter="Field in ('type') and value = '3'"><td style="direction: ltr;">Child</td></face>
                        <face filter="Field in ('type') and value = '4'"><td style="direction: ltr;">Adult|Ext </td></face>
                        <face filter="type in ('Array','object')">@Child</face>                                                
                    </basis>

                  <!-- price Details ######################################################################################## -->
                  <!-- type == 1,2,5,8,9 -->
                  <basis:8 core="group" if="[##db.InvoiceType.Value##] in ('1','2','5','8','9')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>     
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p><span>COST TABLE BY PASSENGERS</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                          <face filter="Field in ('adult')  and type in ('Object')">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child')  and type in ('Object')">
                              <tr>
                                  <td>Child</td>
                                  @Child
                              </tr>
                          </face>             

                          <face filter="Field in ('infant') and type in ('Object')">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('perperson','total')"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>
                  </basis:8>

                  <!-- type == 3 -->
                  <basis:9 core="group" if="[##db.InvoiceType.Value##] in ('3')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>        
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl hidden">
                                  <caption class="invoice_caption"><p><span>COST TABLE BY PASSENGERS - ROOM</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>ROOM</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST(FOR EACH PASSENGER)</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  @Child
                              </table>
                          </face>           
                          
                          <face filter="Field in ('room')"><tbody class="invoice_tbody Room_priceDetails">@Child</tbody></face>

                          <face filter="Field in ('adult')">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child Withbed')">
                              <tr>
                                  <td>Child (WB)</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('child Withoutbed')">
                              <tr>
                                  <td>Child (WOB)</td>
                                  @Child
                              </tr>
                          </face>                

                          <face filter="Field in ('infant')">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('extra Adult')">
                              <tr>
                                  <td>Extra Adult</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('rooms')">
                              <tr>
                                  <td>-</td>
                                  @Child
                              </tr>
                          </face>
                  
                          <face filter="Field in ('roomIndex','perperson','total') and value = ''"><td>-</td></face>
                          <face filter="Field in ('roomIndex','perperson','total') and value <> ''"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>           
                      </basis>
                  </basis:9>

                  <!-- type == 4 -->
                  <basis:10 core="group" if="[##db.InvoiceType.Value##] in ('4','10')">
                      <br><br>
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>        
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p> <span>COST TABLE BY PASSENGERS - ROOM</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>ROOM</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  @Child
                              </table>
                          </face>           
                          
                          <face filter="Field in ('room')"><tbody class="invoice_tbody Room_priceDetails">@Child</tbody></face>

                          <face filter="Field in ('adult') and type = 'object'">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child Withbed') and type = 'object'">
                              <tr>
                                  <td>Child (WB)</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('child Withoutbed') and type = 'object'">
                              <tr>
                                  <td>Child (WOB)</td>
                                  @Child
                              </tr>
                          </face>                

                          <face filter="Field in ('infant') and type = 'object'">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('extra Adult') and type = 'object'">
                              <tr>
                                  <td>Extra Adult</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('rooms')">
                              <tr>
                                  <td>-</td>
                                  @Child
                              </tr>
                          </face>
                  
                          <face filter="Field in ('roomIndex','perperson','total') and value = ''"><td>-</td></face>
                          <face filter="Field in ('roomIndex','perperson','total') and value <> ''"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>           
                      </basis>
                  </basis:10>

                  <!-- type == 6 -->
                  <basis:11 core="group" if="[##db.InvoiceType.Value##] in ('6')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDetails','invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay')"></face>        

                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"> <span>COST TABLE BY PRODUCT</span></caption>
                                  <thead>
                                      <tr>
                                          <th><span>FLIGHT</span></th>
                                          <th><span>HOTEL</span></th>
                                          <th><span>INSURANCE</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody "><tr>@Child</tr></tbody>
                              </table>
                          </face>           
                               
                          <face filter="Field in ('flight','hotel','insurance','total')"><td>@value</td></face> 
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>
                  </basis:11>

                   <basis:12 core="group" if="[##db.InvoiceType.Value##] in ('11')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','priceDetails','baggages','bill','creditPay')"></face>
                          <face filter="Field in ('products')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><span>Lounge INFORMATION</span></caption>
                                  <thead>
                                      <tr>
                                          <th><span>ProductName</span></th>            
                                          <th><span>AirportName</span></th>
                                          <th><span>City</span></th>
                                          <th><span>Airline</span></th>
                                          <th><span>RouteCode</span></th>
                                          <th><span>Date</span></th>
                                          <th><span>Time</span></th>
                                          <th><span>Travel Type</span></th>
                                          <th><span>Flight Type</span></th>
                                                                                            
                                      </tr>
                                  </thead>

                                  <tbody>@child</tbody>
                              </table>
                          </face>
                                                                  
                          <face filter="Field in ('cip') and type in ('object')"><tr>@child</tr></face>
                          <face filter="Field in ('loungename','airportname','route','time','airline','routecode') and type in ('scalar.String')"><td>@value</td></face>
                          <face filter="Field in ('travelType') and value in ('1')"><td>Internal</td></face> 
                          <face filter="Field in ('travelType') and value in ('2')"><td>External</td></face>  
                           <face filter="Field in ('flightType') and value in ('1')"><td>Entrance</face> 
                          <face filter="Field in ('flightType') and value in ('2')"><td>Output</face> 
                         <face filter="Field in ('city_flight')">-@value</td></face> 
                          <face filter="Field in ('routeDate')"><td>@Child</td></face>
                          <face filter="Field in ('mstring')"><div>@value</div></face>
                         
                          <face filter="type in ('Array','object')">@Child</face>                                                     
                      </basis>
                  </basis:12>

                  <basis:13 core="group" if="[##db.InvoiceType.Value##] in ('11')">
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','passengersvisa','products','baggages','bill','creditPay','transfers','services','wheelchair','escortinfo')"></face>     
                          <face filter="Field in ('priceDetails')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p> <span>COST TABLE BY PASSENGERS</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>AGE RANG</span></th>
                                          <th><span>COUNT</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                          <face filter="Field in ('adult') and type in ('object')">
                              <tr>
                                  <td>Adult</td>
                                  @Child
                              </tr>
                          </face> 

                          <face filter="Field in ('child') and type in ('object')">
                              <tr>
                                  <td>Child</td>
                                  @Child
                              </tr>
                          </face>             

                          <face filter="Field in ('infant') and type in ('object')">
                              <tr>
                                  <td>Infant</td>
                                  @Child
                              </tr>
                          </face>

                          <face filter="Field in ('perperson','total')"><td>@value</td></face>
                          <face filter="Field in ('count')"><td>@value</td></face>
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','services','wheelchair','escortinfo')"></face>     
                          <face filter="Field in ('transfers') and value not in ('[]')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p> <span>COST TABLE BY transfers</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>TransferName</span></th>
                                          <th><span>Address</span></th>
                                          <th><span>Time</span></th>
                                          <th><span>Phone</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                           <th><span>Description</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                   

                          <face filter="Field in ('car_name','address','time','phone','perperson','total','des_transfer')"><td>@value</td></face>
                         
                          <face filter="Field in ('unit')"><td style="font-family:IRANSansWeb;">@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>            
                      </basis>
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','transfers','wheelchair','escortinfo')"></face>     
                          <face filter="Field in ('services') and type in ('Array') and value not in ('[]')">
                              <table class="invoice_tbl">
                                  <caption class="invoice_caption"><p><span>COST TABLE BY services</span></p></caption>
                                  <thead>
                                      <tr>
                                          <th><span>ServiceName</span></th>
                                          <th><span>Count</span></th>
                                          <th><span>UNIT COST</span></th>
                                          <th><span>TOTAL COST</span></th>
                                          <th><span>UNIT</span></th>
                                           <th><span>Description</span></th>
                                      </tr>
                                  </thead>
                                  
                                  <tbody class="invoice_tbody ">@Child</tbody>
                              </table>
                          </face>           
                               
                   

                          <face filter="Field in ('service') and type in ('Object')"><tr>@child</tr></face>
                          <face filter="Field in ('perperson','total')"><td class="Seprator">@value</td></face>
                          <face filter="Field in ('count','unit','name','des_service')"><td>@value</td></face>
                          <face filter="type in ('Array','object')">@Child</face>                       
                      </basis>
                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','transfers','services','escortinfo')"></face>     
                              <face filter="Field in ('wheelchair') and type in ('Object')">
                                  <table class="invoice_tbl">
                                      <caption class="invoice_caption"><p>Wheelchair price table</p></caption>
                                      <thead>
                                          <tr>
                                             
                                              <td>Wheelchairs count</td>
                                              <td>Unit price</td>
                                              <td>Total price</td>
                                              <td>Unit</td>
                                          </tr>
                                      </thead>
                                      
                                      <tbody class="invoice_tbody "><tr>@Child</tr></tbody>
                                  </table>
                              </face> 
                              <face filter="Field in ('perperson','total')"><td class="Seprator">@value</td></face>
                              <face filter="Field in ('count','unit')"><td>@value</td></face>
                              <face filter="type in ('Array','object')">@Child</face>                       
                      </basis>

                      <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                          <face filter="Field in ('invoiceDate','travelDate','account','passengers','products','baggages','bill','creditPay','adult','child','infant','transfers','services','wheelchair')"></face>     
                               <face filter="Field in ('escortinfo') and type in ('Array') and value not in ('[]')">
                  <table class="invoice_tbl">
                      <caption class="invoice_caption"><p>Accompanying price table</p></caption>
                      <thead>
                          <tr>
                              <td>Name</td>
                              <td>Last name</td>
                              <td>Gender</td>
                              <td>Unit price</td>
                              <td>Total price</td>
                              <td>Unit</td>
                          </tr>
                      </thead>
                      
                      <tbody class="invoice_tbody ">@Child</tbody>
                  </table>
              </face>
              <face filter="Field in ('escort') and type in ('Object')"><tr>@child</tr></face>
              <face filter="Field in ('perperson','total')"><td class="Seprator">@value</td></face>
              <face filter="Field in ('unit','firsname','lastname')"><td>@value</td></face>
              <face filter="Field in ('gender') and value in ('0')"><td>Female</td></face>
               <face filter="Field in ('gender') and value in ('1')"><td>Male</td></face>
              <face filter="type in ('Array','object')">@Child</face>                           
                      </basis>

                  </basis:13>


                  <!-- bill ################################################################################################# -->
                  <basis:14 core="group" if="[##db.InvoiceType.Value##] in ('10','4')">
                    <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                        <face
                            filter="Field in ('invoiceDetails','invoiceDate','account','passengers','passengersvisa','products','priceDetails','baggages','creditPay')">
                        </face>
                        <face filter="Field in ('bill')">
                            <table class="invoice_tbl">
                                <caption class="invoice_caption"><span>TOTAL COST TABLE</span></caption>
                                <thead>
                                    <tr>
                                        <th><span>TOTAL COST</span></th>
                                        <th><span>COMMISSION</span></th>
                                        <th><span>DISCOUNT</span></th>
                                        <th><span>DISCOUNT CODE</span></th>
                                        <th><span>COST BY COMMISSION</span></th>
                                        <th><span>UNIT</span></th>
                                    </tr>
                                </thead>
                
                                <tbody class="invoice_tbody">
                                    <tr>@Child</tr>
                                </tbody>
                            </table>
                        </face>
                
                        <face filter="Field in ('totalprice','commission','couponcost','totalwithcommisions')">
                            <td style="direction:ltr">@value</td>
                        </face>
                        <face filter="Field in ('unit','couponcode')">
                            <td style="font-family:IRANSansWeb;">@value</td>
                        </face>
                        <face filter="Field in ('pdf_description') and value in ('[]')">
                            <div class="pdf_description">
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 1 : </span> <br>
                                    <span style="color:#CE0E0E">Contract Subject: </span>
                                    The subject of this contract is to determine the limits of duties and responsibilities of the
                                    parties to the contract, as well as the cost of tourism services to provide as described in the
                                    contract.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 2 : </span> <br>
                                    <span style="color:#CE0E0E">Terms of the contract : </span>
                                    If the tour is not feasible by the broker due to not reaching the quorum, the broker is obliged to
                                    inform the tourist before the date of the tour by providing appropriate reasons and to return all
                                    the funds received from the tourist.
                                </p>
                
                                <p style="margin:15px 0;color:#CE0E0E">
                                    <span style="color:#CE0E0E">Attention </span>
                                    In case of non-confirmation, another hotel will be replaced, and in case of price difference
                                    according to the package, our rate will be received according to the difference.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 3 : </span> <br>
                                    The evacuation time of the hotel rooms is in accordance with the rules and regulations governing the
                                    destination, and the tourist is obliged to comply with it. If the room is delivered earlier than
                                    scheduled by the tourist, no amount will be refunded to the tourist.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 4 : </span> <br>
                                    Individual (single) tourists are subject to the rules and rates of using a single room when
                                    registering.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 5 : </span> <br>
                                    For scheduled tours with non-charter flights, the cancellation conditions will be applied in
                                    accordance with the regulations of the relevant airline and hotel of residence.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 6: </span> <br>
                                    If in some cases, at the arrival of the tourist at the airport of the destination country, his
                                    passport is obtained and maintained by the relevant authorities to be returned to the tourist upon
                                    return to the airport, in such circumstances, the broker will not be responsible.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 7 : </span> <br>
                                    If, according to the conditions announced by the embassy regarding the return of the tourist, a
                                    guarantee is obtained from the broker, the tourist is obliged to submit the same amount of bank
                                    guarantee to the broker.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Note 1 :</span> <br>
                                    After returning from the trip, tourists need to refer to the broker with the original passport and
                                    the page image related to the entry and exit stamp of the destination country in order to receive
                                    the deposited bank guarantee, and the broker is obliged to confirm the authenticity and accuracy of
                                    the documents provided. , Immediately take action against the warranty jaw.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 8 : </span> <br>
                                    If the issued visa provides for a specific period of time for the stay, if any of the tourists
                                    refuses to return to the country on the predetermined date and this will cause damages to the broker
                                    according to the tourist's commitment, the broker is authorized. By submitting a reasoned document,
                                    he / she will receive the equivalent of the cost (damage) incurred through the confiscation of the
                                    guarantee in his favor.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 9 : </span> <br>
                                    If the visa is not issued by the destination country, the broker is not responsible in this regard,
                                    but if the broker has incurred a fee in this regard, in order to obtain the costs incurred is
                                    obliged to provide valid documents to the tourist.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 10 : </span> <br>
                                    If the tourist disturbs other tourists or the group leader, local guides and all those involved in
                                    the patrol or commits acts contrary to customary customs and ethics in the country, the group leader
                                    is obliged according to the minutes and other members of the group Depending on the case, make the
                                    necessary decision about that tourist and report the steps to the executive agent.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 11 : </span> <br>
                                    The organization of cultural heritage, handicrafts and tourism is responsible for resolving any
                                    disputes between us between the parties to the contract by providing reasons, and the votes issued
                                    by the organization are binding on the parties.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 12 : </span> <br>
                                    Regarding group registration in normal conditions (non-force), only a person who has registered and
                                    signed a contract on behalf of tourists is allowed to refer to the broker to follow up, cancel or
                                    receive payment, and other tourists are allowed in this regard. Do not go to the broker.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 13 : </span> <br>
                                    Observance of manners and ethics during the trip by the tourist is mandatory and also the tourist is
                                    obliged to comply with all regulations of the destination country. Therefore, the consequences of
                                    committing any violation and having the consequences of having drugs that may be illegal in the
                                    destination country, are the responsibility of the tourist, and if the broker pays a fine in this
                                    regard, he can receive the cost from the tourist by providing documents.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 14: </span> <br>
                                    If the trip is for groups and families, if the visa application of any tourist is rejected or
                                    received late, the rest of the tourists are required to use the requested services and if not used,
                                    they must pay all the costs related to the cancellation.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Note 2 : </span> <br>
                                    For first-degree relatives (father, mother, spouse, unmarried children), a visa fee and one night
                                    stay at the hotel and a ticket cancellation fee will be charged.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 15 : </span> <br>
                                    The protection of personal property and documents is the responsibility of the tourist and in case
                                    of its loss, the manager or broker will not be responsible.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 16 : </span> <br>
                                    If visas and passports are issued by some embassies in the last hours before the start of the trip,
                                    the tourist must have prepared her travel arrangements in advance.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Note 3 : </span> <br>
                                    The principle is that the visa is normal, but if the tourist insists on obtaining a visa
                                    immediately, the resulting responsibilities will be borne by the tourist.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 17 : </span> <br>
                                    At the request of the relevant embassy for an interview with a tourist or fingerprinting for the
                                    issuance of a visa, the tourist must attend the interview at the consulate of the relevant embassy
                                    and participate in the interview in due time, and if due to failure to do so, the visa issued by the
                                    embassy If not, penalties will be charged.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 18 : </span> <br>
                                    The tourist is obliged to participate in the airport tour and transfer programs during the announced
                                    hours, and if he is not present on time during the tour, he must personally pay the relevant fees to
                                    join the group and continue the tour program, otherwise the relevant agent He will not have any
                                    responsibility in this regard.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 19 : </span> <br>
                                    In case of cancellation of the tour by the tourist, the broker will be allowed to cancel the visa
                                    issued to the tourist by the officials of the embassy issuing the visa.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 20 : </span> <br>
                                    In case of any involuntary increase in the price of the tour, whether it is an increase in the
                                    ticket price or other services, the tourist is obliged to pay the difference announced by the broker
                                    by presenting documentary evidence by the broker with the approval of the organization.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Note4 : </span> <br>
                                    Payment of all exit taxes is the responsibility of the tourist.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 21 : </span> <br>
                                    If the tourist is not allowed to leave or the local authorities prevent him from entering the
                                    country upon arrival, the tourist will be required to pay the fees incurred by the broker by
                                    submitting the relevant documents. The patrol supervisor is also obliged to cooperate for the return
                                    of the tourist to the country and the broker will not be responsible for this.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 22 : </span> <br>
                                    If the tourist abroad independently and outside the proposed tour program to purchase optional
                                    services and participate in it, the cost and responsibility for the consequences of accidents will
                                    be borne by the tourist.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 23 : </span> <br>
                                    The broker is obliged to take the necessary measures regarding the obligatory and optional insurance
                                    coverage in accordance with the insurance instructions notified by the organization, and in case of
                                    any accident during the trip, in addition to acting in accordance with the covered insurance
                                    conditions, to cooperate and Take the necessary assistance in this regard.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 24:</span> <br>
                                    The control of tourist documents, including the validity date of the tourist passport and the age
                                    conditions of the companions, is the responsibility of the broker. Therefore, in case of negligence
                                    in this regard by the broker, all costs and damages will be borne by the broker.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 25:</span> <br>
                                    The broker undertakes to carry out the agreed travel and patrol schedule completely and accurately,
                                    but in the event of unexpected events such as war, riots, strikes and problems beyond the broker's
                                    control and cause the plan to be canceled or changed. The broker will not be responsible, but the
                                    broker is obliged to return the received funds to the tourist.
                                </p>
                
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 26:</span> <br>
                                    If the tour plan provided by the broker is not implemented during the trip or is not presented at a
                                    higher level than agreed in the contract, the tourist is allowed to announce the items to the broker
                                    with good reasons, the broker is obliged to satisfy the tourist. In case of any dispute, the
                                    decision of the organization will be accepted as a ruling by the parties. This contract is regulated
                                    in 2 copies consisting of 25 articles and 4 notes, each of which has a single sentence and is based
                                    on Articles 230 of the Civil Code, which are binding on the parties or their legal representatives.
                                </p>
                                <p style="margin:15px 0">
                                    <span style="font-weight:bold;">Article 27: </span> <br>
                                    In case of written cancellation of the passenger from accompanying the tour, up to one month before
                                    the flight equal to 20% of the total tour price and from one month to three weeks before the flight
                                    equal to 30% of the total tour price and from three weeks to 72 hours before the flight equal to 50%
                                    of the total price Tour and in less than 72 hours before the flight, 70% of the total tour price
                                    will be deducted from the total tour amount as a penalty and the rest of the funds will be paid to
                                    the passenger.
                                </p>
                            </div>
                        </face>
                        <face filter="Field in ('pdf_description') and value not in ('[]')">
                            <div class="pdf_description">
                                @child
                            </div>
                        </face>
                        <face filter="Field in ('note')">
                            <p style="margin:15px 0">
                                @child
                
                            </p>
                        </face>
                        <face filter="Field in ('title')">
                
                            <span style="font-weight:bold;">@value : </span> <br>
                
                
                        </face>
                        <face filter="Field in ('text')">
                            @value
                        </face>
                        <face filter="type in ('Array','object')">@Child</face>
                    </basis>
                </basis:14>
                <basis:15 core="group" if="[##db.InvoiceType.Value##] in ('3')">
                    <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                        <face
                            filter="Field in ('invoiceDetails','invoiceDate','account','passengers','passengersvisa','products','priceDetails','baggages','creditPay')">
                        </face>
                        <face filter="Field in ('bill')">
                            <table class="invoice_tbl">
                                <caption class="invoice_caption"><span>TOTAL COST TABLE</span></caption>
                                <thead>
                                    <tr>
                                        <th><span>TOTAL COST</span></th>
                                        <th><span>COMMISSION</span></th>
                                        <th><span>DISCOUNT</span></th>
                                        <th><span>DISCOUNT CODE</span></th>
                                        <th><span>COST BY COMMISSION</span></th>
                                        <th><span>UNIT</span></th>
                                    </tr>
                                </thead>
                
                                <tbody class="invoice_tbody">
                                    <tr>@Child</tr>
                                </tbody>
                            </table>
                        </face>
                
                        <face filter="Field in ('totalprice','commission','couponcost','totalwithcommisions')">
                            <td style="direction:ltr">@value</td>
                        </face>
                        <face filter="Field in ('unit','couponcode')">
                            <td style="font-family:IRANSansWeb;">@value</td>
                        </face>
                        <face filter="Field in ('pdf_description') and value in ('[]')">
                            <div class="pdf_description">
                                <p style="margin:15px 0;color:#CE0E0E">
                                    <span style="color:#CE0E0E">Attention </span>
                                    In case of non-confirmation, another hotel will be replaced, and in case of price difference
                                    according to the package, our rate will be received according to the difference.
                                </p>
                
                            </div>
                        </face>
                        <face filter="Field in ('pdf_description') and value not in ('[]')">
                            <div class="pdf_description">
                                @child
                            </div>
                        </face>
                        <face filter="Field in ('note')">
                            <p style="margin:15px 0">
                                @child
                
                            </p>
                        </face>
                        <face filter="Field in ('title')">
                
                            <span style="font-weight:bold;">@value : </span> <br>
                
                
                        </face>
                        <face filter="Field in ('text')">
                            @value
                        </face>
                        <face filter="type in ('Array','object')">@Child</face>
                    </basis>
                </basis:15>
                <basis:16 core="group" if="[##db.InvoiceType.Value##] not in ('4','10','3')">
                    <basis core="tree" datamembername="db.InvoiceView_Tree" idcol="id" parentidcol="parentid" nullvalue="null">
                        <face
                            filter="Field in ('invoiceDetails','invoiceDate','account','passengers','passengersvisa','products','priceDetails','baggages','creditPay')">
                        </face>
                        <face filter="Field in ('bill')">
                            <table class="invoice_tbl">
                                <caption class="invoice_caption"><span>TOTAL COST TABLE</span></caption>
                                <thead>
                                    <tr>
                                        <th><span>TOTAL COST</span></th>
                                        <th><span>COMMISSION</span></th>
                                        <th><span>DISCOUNT</span></th>
                                        <th><span>DISCOUNT CODE</span></th>
                                        <th><span>COST BY COMMISSION</span></th>
                                        <th><span>UNIT</span></th>
                                    </tr>
                                </thead>
                
                                <tbody class="invoice_tbody">
                                    <tr>@Child</tr>
                                </tbody>
                            </table>
                        </face>
                
                        <face filter="Field in ('totalprice','commission','couponcost','totalwithcommisions')">
                            <td style="direction:ltr">@value</td>
                        </face>
                        <face filter="Field in ('unit','couponcode')">
                            <td style="font-family:IRANSansWeb;">@value</td>
                        </face>
                        <face filter="Field in ('pdf_description') and value not in ('[]')">
                            <div class="pdf_description">
                                @child
                            </div>
                        </face>
                        <face filter="Field in ('note')">
                            <p style="margin:15px 0">
                                @child
                
                            </p>
                        </face>
                        <face filter="Field in ('title')">
                            <span style="font-weight:bold;">@value : </span> <br>
                        </face>
                        <face filter="Field in ('text')">
                            @value
                        </face>
                        <face filter="type in ('Array','object')">@Child</face>
                    </basis>
                </basis:16>

                 
              </div>

              <style type="text/css">
                  @font-face{
                      font-family:'IRANSansWeb';
                      src:url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.eot');src:local('?'),
                      url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.woff2') format("woff"),
                      url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.ttf') format("truetype"),
                      url('[##cms.cms.domainname##]/_fonts/IRANSansWeb.otf') format("otf");
                      font-weight:400;font-style:normal
                  }
                  @font-face{
                      font-family:'FontAwesome';
                      src:local('FontAwesome'),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.eot?#iefix');src:local('?'),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.woff') format("woff"),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.ttf') format("truetype"),
                      url('[##cms.cms.domainname##]/_fonts/fontawesome-webfont.otf') format("otf");
                      font-weight:400;font-style:normal
                  }
                  *{margin:0; padding:0;}
                  body{font-family:IRANSansWeb;font-size:20px;color:#3b3838;}
                  span,i{display:inline-block;}
                  p{text-align:justify;}
                  strong{color:#CE0E0E}
                  .clr{clear: both;}
                  .Panel_pdf{width:1400px;margin:0 auto;direction:ltr}
                  .pdf_title{text-align: center;margin-bottom: 15px;font-weight: bold;}
                  .pdf_description {margin:30px 0;text-align:justify;}
                  .pdf_direct{direction:ltr;}
                  .Panel_pdf table{width:100%;margin:40px 0;}
                  .Panel_pdf table caption{text-align:left;border-right: 1px solid #fff;border-left: 1px solid #fff;font-size:20px;}
                  .Panel_pdf table caption span{padding:5px}
                  .Panel_pdf table tr th{text-align:center;font-weight:normal;background:#DDE8F0;padding:6px 2px;font-size:18px}
                  .Panel_pdf table tr td{text-align:center;padding:6px 2px;direction: ltr;border: 1px solid #CBDDEA;background:#F4F8FB;font-size:18px;}
                  .Panel_pdf table tr td p{text-align:center;}
                  .Panel_pdf table.tourDetails tr td{text-align:left;padding:6px 5px;font-family:IRANSansWeb;}
                  .Panel_pdf table.tourDetails tr td:nth-child(1){background:#DDE8F0;font-family:IRANSansWeb;padding:6px 5px}
                  .passengers::after {content: "+";display: inline-block;margin: 0 3px;}
                  .passengers:last-child:after{display:none;}
                  th span{display: block;}
                  .hidden{display: none;}
              </style>
          </body>
      </html>
  </basis>
</basis>
</basis>